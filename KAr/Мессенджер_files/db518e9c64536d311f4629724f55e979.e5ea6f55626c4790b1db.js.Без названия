(self.webpackChunkvk=self.webpackChunkvk||[]).push([[93424],{22326:(_,e,t)=>{"use strict";function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="playlist_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_24__playlist_24"><path id="playlist_24__Shape" d="M0 0h24v24H0z"/><path d="M13 6.88c0-.48-.4-.88-.88-.88H2.88C2.4 6 2 6.4 2 6.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24Zm0 4c0-.48-.4-.88-.88-.88H2.88c-.49 0-.88.4-.88.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24ZM2 15.12v-.24c0-.48.4-.88.88-.88h4.23c.5 0 .89.4.89.88v.24c0 .48-.4.88-.89.88H2.88c-.49 0-.88-.4-.88-.88Zm15 .7c0 3.74-.99 4.64-3.77 5.13-1.48.26-3.23-.48-3.23-2.8 0-1.15.72-2.23 2.2-2.51 1.12-.22-.43.05 2.12-.42.62-.12.69-.34.69-.81L15 12.56V5.98c0-1.1.83-1.5 2.6-1.85 0 0 2.34-.34 3.82-.61.33-.06.58.06.58.44V7.4c0 .37-.15.54-.53.6-1.5.27-3.99.65-3.99.65-.33.08-.48.32-.48.65v6.51Z" id="playlist_24__Mask" fill="currentColor"/></g></g></svg>',name:"playlist_24"}}t.d(e,{getIcon24Playlist:()=>i})},96465:(_,e,t)=>{"use strict";function i(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><g id="playlist_outline_56__Icons-56/playlist_outline_56" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_outline_56__playlist_outline_28"><path id="playlist_outline_56__playlist_outline_56" d="M0 0h56v56H0z"/><path d="M39 38.93c0 4.55-1.94 7.97-5.07 9.62-2.84 1.5-6.24 1.22-8.22-.76-2.04-2.04-2.3-5.5-.58-8.3C27 36.44 30.77 34.61 36 34.5V16.76a6.88 6.88 0 0 1 5.03-6.68c1.08-.36 3.24-.92 6.5-1.67l1.64-.37A1.5 1.5 0 0 1 51 9.5v4.2a6.7 6.7 0 0 1-4.97 6.48L39 22.05Zm-3-1.42h-.4c-4 .18-6.67 1.53-7.91 3.54-1.02 1.66-.88 3.6.14 4.62.98.98 2.96 1.14 4.7.22 2.12-1.11 3.47-3.5 3.47-6.96V37.5ZM27.5 22a1.5 1.5 0 0 1 0 3h-19a1.5 1.5 0 0 1 0-3h19ZM48 11.38a83.8 83.8 0 0 0-6.03 1.54l-.21.08c-1.93.71-2.8 2.05-2.76 4.33v1.62l6.25-1.67A3.7 3.7 0 0 0 48 13.71ZM30.5 10a1.5 1.5 0 0 1 0 3h-22a1.5 1.5 0 0 1 0-3h22Z" id="playlist_outline_56__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"playlist_outline_56"}}t.d(e,{getIcon56PlaylistOutline:()=>i})},25383:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{currentAudioPage:()=>currentAudioPage,AudioPage:()=>AudioPage});var core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(75115),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83946),core_js_modules_es6_array_slice__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(50110),core_js_modules_es6_array_map__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19371),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(91181),core_js_modules_es6_array_iterator__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(56997),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(96253),core_js_modules_es6_array_sort__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(20075),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(51876),core_js_modules_es6_array_filter__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(98837),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(59357),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(76142),_lib_stats__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(60615),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(26271),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(93560),_web_lib_fx__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(35676),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(79957),_web_lib_date__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(89988),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(35429),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(86125),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(3834),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(49535),_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(134),_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(85850),_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(99429),_web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(97213),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(67766),_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(40906),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(32230),_web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(17700),_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(35093),_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(15544),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(54612),_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(18149),_web_lib_utils__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(82452),_web_grid_sorted__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(87142),_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(86409),_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(86067),_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(98312),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(76852),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(82284),_shared_audio_enums__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(22904),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(95724),_web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(75807),_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(51207),_icons_desktop_getIcon24ChevronLeft__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(87567),_icons_desktop_getIcon24Playlist__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(22326),_icons_desktop_getIcon24ChevronRight__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(76299),_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(47612),_icons_desktop_getIcon24CheckCircleOff__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(6439),_icons_desktop_getIcon24CheckCircleOn__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(19202),_icons_desktop_getIcon56PlaylistOutline__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(96465),_shared_lib_storage__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(22683),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(59397);function _extends(){return _extends=Object.assign||function(_){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(_[i]=t[i])}return _},_extends.apply(this,arguments)}var SLIDER_TIMEOUT=1e4,sectionsToUpdate=[];function currentAudioPage(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_page_layout",_);return!!e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(e,"audioPage")}function AudioPage(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(_,"audioPage",this),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)(cur.lang||{},e.langs),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().langs=e.langs,this._data=e,this._ownerId=e.ownerId,this.isLayer()||(cur.audioPage=this),this.isLayer()&&uiSearch.init("audio_search_layer"),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.toggleAudioHQBodyClass(),this._els={pageContainer:_,sections:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_sections",_),playerWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player_wrap",_),player:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player",_),contentBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_content_block",_),scrollWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_content_block_wrap",_),searchSectionAudios:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_search__local_audios_list",_),searchSectionAudiosHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_section_search__local_audios_header",_),searchSectionPlaylists:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_search__local_playlists_list",_),searchSectionPlaylistsHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_search__local_playlists_header",_),searchNoLocalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_local_no_results",_),searchGlobalBlocks:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_global_search__blocks",_),searchGlobalCommunitiesPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_global_search__communities_place",_),searchGlobalPlaylistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_global_search__playlists_place",_),searchGlobalArtistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_global_search__artists_place",_),searchGlobalAudiosBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_global_search__audios_block",_),searchGlobalAudiosBlockHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_global_search__audios_header",_),searchGlobalAudiosList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_global_search__audios_list",_),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ui_search_field",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_search",_)),footer:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page__footer",_),footerNowPlayingInfo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page__footer_now_playing",_),footerClearNowPlayingButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page__footer_clear_playlist",_)},this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_28__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),this._readyAudio=this._data.readyAudio;var t=this._data.readyPlaylist;t&&(this._pagePlaylist=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylist(t.type,t.ownerId,t.id),this._pagePlaylist.mergeWith(t)),!this._readyAudio&&this._pagePlaylist&&(this._readyAudio=this._pagePlaylist.getAudioAt(0)),this._data.playlistCoverUploadOptions&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[this._ownerId]=this._data.playlistCoverUploadOptions),this.isLayer()||(cur.module=e.module||"audio",cur.oid=this._ownerId,+this._ownerId==+vk.id?cur.submodule="my":this._ownerId<0?cur.submodule="group_list":cur.submodule="user_list"),vk.id&&this._initPlayer(),this.initNavigation(),_shared_lib_storage__WEBPACK_IMPORTED_MODULE_46__.vkLocalStorage.getItem(_shared_audio_enums__WEBPACK_IMPORTED_MODULE_41__.AUDIO_PLAYER_ENUMS.ONBOARDING_ARTISTS_LS_KEY)&&AudioPage.showRecomsOnboarding(!0),this.catalogController=new _web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_43__.CatalogController(_),this.showSection(e.initSection,null,this._data.onlySkeleton),e.initSection||this.catalogController.initBlocksManually();var i=new URLSearchParams(location.search);this.defaultSection=!i.get("section")&&e.initSection||"general",this._initSearchParams(),this.promoAlbumSlideInit(),this._els.searchInput&&this._els.searchInput.focus(),this.isLayer()||this.isPodcastPage()||!nav.objLoc.q||"search_playlists"===nav.objLoc.section||this._els.searchInput&&(this._els.searchInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.winToUtf)(nav.objLoc.q),this._showSearchSection(nav.objLoc)),this.updateCurrentPlayingInfo(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().setStatusExportInfo(this._data.export),this.updateStatusExportControls(),this._initKeyEvents(),window.onAudioPageLoaded&&(window.onAudioPageLoaded.call(this),delete window.onAudioPageLoaded),this.updateShuffleButton()}AudioPage.address="audio",AudioPage.updateSearchHighlight=function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_playlist",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_layout",this));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(e,"audio_search_focused","focus"===_.type)},AudioPage.onSearchFocused=function(_){AudioPage.updateSearchHighlight(_)},AudioPage.prototype.updatePlaylistsCounter=function(_){var e;if(cur.audioPage&&_===cur.audioPage.getOwnerId()&&(e=cur.audioPage._els.pageContainer.querySelector(".CatalogBlock__own_only_playlists_header .CatalogBlock__title"))){var t=cur.audioPage._data.playlists.length;e.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(t,cur.lang.audio_playlists_count_title),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_page_section_layout",e),"audio_section_empty",!t)}},AudioPage.getCoverImage=function(_,e){var t="";_?t=`<img alt="${(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_47__.escape)(e)}" width='143px' height='143px' src="${_}" loading='lazy' />`:t=`<div class="audio_pl_cover_placeholder">${(0,_icons_desktop_getIcon56PlaylistOutline__WEBPACK_IMPORTED_MODULE_48__.getIcon56PlaylistOutline)().icon}</div>`;return t},AudioPage.setCoverImageElem=function(_,e,t){if(e){var i=_.querySelector(".audio_pl_cover_placeholder"),o=_.querySelector("img");o&&_.removeChild(o),i&&_.removeChild(i);var s=new Image;s.src=e,s.setAttribute("alt",(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_47__.escape)(t)),s.setAttribute("width","143px"),s.setAttribute("height","143px"),s.setAttribute("loading","lazy"),_.appendChild(s)}else{var a=_.querySelector("img");if(a){_.removeChild(a);var l=(0,_icons_desktop_getIcon56PlaylistOutline__WEBPACK_IMPORTED_MODULE_48__.getIcon56PlaylistOutline)().icon,n=document.createElement("div");n.classList.add("audio_pl_cover_placeholder"),n.innerHTML=l,_.appendChild(n)}}},AudioPage.deletePlaylist=function(_,e,t){var i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,_,e),o=AudioPlayer.getLang("audio_sure_delete_playlist_box_text");o='<div style="overflow: hidden; text-overflow: ellipsis;">'+(o=o.replace("{name}",i.getTitle()))+"</div>",(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showFastBox)({title:AudioPlayer.getLang("audio_sure_delete_playlist_box_title"),dark:1},o,AudioPlayer.getLang("audio_sure_delete_playlist_box_yes"),function(){ajax.post("al_audio.php?act=delete_playlist",{hash:t,playlist_owner_id:_,playlist_id:e,page_owner_id:cur.audioPage?cur.audioPage.getOwnerId():0},{onDone:function(_){if(cur.audioPage){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section__all",cur.audioPage.getPageContainer()),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_block__playlists_items",e);if(e&&t){var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(t,"max-items"));if(_&&t.children.length<i){var o=_.thumb,s=_.title;_.cover_image=AudioPage.getCoverImage(o,s),t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.getTemplate)("audio_pl_item",_)))}t.children.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_page_section_layout",t),"no_playlists"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_page_titled_block",t)))}}},onFail:()=>!0});var i=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.getBoxQueue)();if(i&&i.hideAll(!0),layers&&layers.fullhide&&layers.fullhide(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass)("_audio_pl_"+_+"_"+e),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.re)(this)})),window.location.pathname.includes(`/music/playlist/${window.vk.id}`))return window.history.length>2?void window.history.back():void document.location.replace(`https://${window.vk.apiConfigDomains.domain}/music?section=${cur.audioPage.defaultSection}`);if(cur.audioPage){if(cur.audioPage._data.playlists=cur.audioPage._data.playlists.filter((function(t){return!(t.id==e&&t.owner_id==_)})),!cur.audioPage._data.playlists.length)return void nav.reload();cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(_)}}.bind(this),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_cancel"))},AudioPage.prototype.getCurrentSection=function(){return this._currentSection},AudioPage.prototype.getOwnerPlaylists=function(){return this._data.playlists},AudioPage.loadPlaylists=function(ownerId,totalCount,skipFirstChunk,forAttachBox,onDone){var chunkSize=50,chunks=[];(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isFunction)(totalCount)&&(onDone=totalCount,totalCount=void 0,skipFirstChunk=!1),cur.playlistsCache=cur.playlistsCache||{};var cacheKey=ownerId+"_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(skipFirstChunk);if(cur.playlistsCache[cacheKey])return onDone(cur.playlistsCache[cacheKey]);function onAllLoaded(){var _=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(chunks,(function(e,t){t&&(_=_.concat(t))})),cur.playlistsCache=cur.playlistsCache||{},cur.playlistsCache[cacheKey]=_,onDone&&onDone(_)}function _loadChunk(chunkIndex,_cb){var groupId=cur.group_id||(cur.oid<0?-cur.oid:0);ajax.post("al_audio.php?act=owner_playlists",{owner_id:ownerId,group_id:groupId,offset:chunkIndex*chunkSize,is_attach:forAttachBox?1:0},{onDone:function onDone(playlists,totalCount,additionalData){additionalData.templates_script&&eval(additionalData.templates_script),additionalData.langs&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)(cur.lang,additionalData.langs),additionalData.audio_playlist_cover_upload_options&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[ownerId]=additionalData.audio_playlist_cover_upload_options),chunks[chunkIndex]=playlists,_cb(totalCount)},onFail:function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(boxLoader),_)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_error")},_),!0}})}function _loadAllChunks(_,e,t){var i=Math.ceil(_/chunkSize);i&&i-e!=0?function(){for(var _=new callHub(t,i-e),o=e;o<i;o++)_loadChunk(o,(function(){_.done()}))}():t()}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.isUndefined)(totalCount)?_loadChunk(0,(function(_){_loadAllChunks(_,1,onAllLoaded)})):_loadAllChunks(totalCount,skipFirstChunk?1:0,onAllLoaded)},AudioPage.prototype.getOwnerId=function(){return+this._ownerId},AudioPage.prototype.getPageContainer=function(){return this._els.pageContainer},AudioPage.prototype.getCurrentSectionEl=function(){return this.catalogController.currentSection&&this.catalogController.currentSection.getSectionElement()},AudioPage.prototype.canAddToGroup=function(){return this._data.canAudioAddToGroup},AudioPage.prototype.canEditGroup=function(){return this._data.canEdit},AudioPage.prototype.updateCurrentPlayingInfo=function(){if(this.isLayer()){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),e=_.getCurrentPlaylist(),t=e?e.getTitle():"";if(e&&null!==e.getTitleLang()&&window.langConfig&&window.langConfig.id!==e.getTitleLang()&&ajax.post("al_audio.php?act=get_playlist_info",{owner_id:e.getOwnerId(),playlist_id:e.getAlbumId(),access_hash:e.getAccessHash()},{onDone:t=>{e.updatePlaylist(t)&&(_.saveStateCurrentPlaylist(),this.updateCurrentPlayingInfo())},onFail:()=>{}}),t){var i=e.getOriginalPlaylistRawId();if(e.getBlockId())t=`<a href="${`/audio?section=recoms_block&type=${e.getBlockId()}`}"\n                  class="audio_page__footer_now_playing_link">\n                  ${t}\n                </a>`;else if(i||e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST&&0!==e.getAlbumId()){var o,s,a;i?(o=(i=i.split("_"))[0],s=i[1],a=i[2]||""):(o=e.getOwnerId(),s=e.getAlbumId(),a=e.getAccessHash()||""),t=`<a href="${nav.toStr((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)({},nav.objLoc,{z:"audio_playlist"+o+"_"+s+(a?"/"+a:"")}))}"\n                  class="audio_page__footer_now_playing_link"\n                  onclick="if (checkEvent(event)) { return true } else { AudioUtils.showAudioPlaylist(${o}, ${s}, '${a}'); return cancelEvent(event) }">\n                  ${t}\n                </a>`}this._els.footerNowPlayingInfo.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_current_playing_from").replace("{playlist}",t)}else{var l=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio();_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast(l)?this._els.footerNowPlayingInfo.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_current_playing_from").replace("{playlist}",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_podcast_playing").replace("{name}",l[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER])):this._els.footerNowPlayingInfo.innerHTML=""}this._els.footerClearNowPlayingButton.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_clear_current_playlist"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggle)(this._els.footer,!!e)}},AudioPage.prototype.onSearchFiltersChanged=function(_){var e=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(this.isLayer())],t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(this._searchSortFilter.selectedItems()[0][0]),i={performer:e.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")?1:null,sort:t?1:null};this.syncParametersUI(i);var o=_&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isObject)(_)?_:i;this.isLayer()&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)({},this._prevLoc,o)),nav.change(o,!1,{fromSearch:!0,filtersChanged:!0})},AudioPage.prototype._initSearchParams=function(){window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(this.isLayer())]={els:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass)("_audio_search_type",this._els.pageContainer),keep:this.isLayer()};var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_fltr_sort",this._els.pageContainer);_&&(this._searchSortFilter=new Dropdown(_,this._data.sortFilters,{big:1,zeroPlaceholder:!0,onChange:this.onSearchFiltersChanged.bind(this)})),this.isLayer()||this.syncParametersUI(nav.objLoc)},AudioPage.prototype.syncParametersUI=function(_){var e="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(this.isLayer()),t=window.radioBtns[e];t&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.radiobtn)(t.els[_.performer?1:0],!!_.performer,e);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(i,"on",!!_.lyrics);var o={performer:AudioPlayer.getLang("audio_performers_only"),lyrics:AudioPlayer.getLang("audio_search_with_text"),sort:AudioPlayer.getLang("audio_search_by_length")},s=this._els.searchInput;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(["performer","lyrics","sort"],(function(e,t){uiSearch.toggleFilter(s,t,o[t],!!_[t])}))},AudioPage.onFilterRemoved=function(_,e,t){var i=currentAudioPage(e);(function(){switch(_){case"performer":var e="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(this.isLayer()),i=window.radioBtns[e];(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.radiobtn)(i.els[0],0,e);break;case"sort":var o=this._searchSortFilter.options.defaultItems[0][0];this._searchSortFilter.selectItem(o,!1);break;case"lyrics":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")}t||this.onSearchFiltersChanged()}).apply(i)},AudioPage.prototype._showSearchSection=function(_){this._toggleSearchProgress(!0);var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player2")){var t=_.globalQuery||_.q;this._sectionData={q:t,performer:_.performer};var i=void 0!==_.fromSuggestsAcceptId;i||(this._cur_qid=(0,_lib_stats__WEBPACK_IMPORTED_MODULE_12__.generateQID)()),this.showSection("search",function(){if(t){var e=this._data.sectionData.search?this._data.sectionData.search.qid:0;(0,_lib_stats__WEBPACK_IMPORTED_MODULE_12__.saveSearchAttemptStats)(_lib_stats__WEBPACK_IMPORTED_MODULE_12__.serviceAudio,0,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.isVisible)(this._els.searchNoLocalResults),t,e,void 0,void 0,void 0,void 0,i&&_.fetchedQuery,void 0,void 0,_.fromSuggestsAcceptId)}this._toggleSearchProgress(!1)}.bind(this))}else e.loadAll(function(){this._toggleSearchProgress(!1),this._doShowSearchSection(_)}.bind(this))},AudioPage.prototype._toggleSearchProgress=function(_){this._els.searchInput&&!this._muteSearch&&(_?uiSearch.showProgress(this._els.searchInput):uiSearch.hideProgress(this._els.searchInput))},AudioPage.prototype._doShowSearchSection=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)();if(_&&(this._prevSearchParams=_),_=_||this._prevSearchParams){var t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.replaceEntities)(_.q)+(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.replaceEntities)(_.globalQuery||"");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(["performer","lyrics","sort"],(function(e,i){t+=_[i]||0})),t+=this._ownerId,this._toggleSearchProgress(!0);var i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,this._ownerId,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID);i.loadAll(function(){clearTimeout(this._onSilendLoadedTO),this._onSilendLoadedTO=setTimeout(function(){o.call(this)}.bind(this))}.bind(this))}function o(){i.search(_,function(i){var o="",s=this._data.playlistsIndex?this._data.playlistsIndex.search(_.q):[];if(this.showSection("search"),s.length){var a="";(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(s,(function(_,e){e.cover_image=AudioPage.getCoverImage(e.thumb,e.title),a+=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.getTemplate)("audio_pl_item",e)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(this._els.searchSectionPlaylists),o=+this._ownerId===vk.id?e.langs.audio_found_your_local_playlists:this._ownerId>0?e.langs.audio_found_user_local_playlists:e.langs.audio_found_group_local_playlists,this._els.searchSectionPlaylistsHeader.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(s.length,o),this._els.searchSectionPlaylists.innerHTML=a}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchSectionPlaylists);var l=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_34__.hashCode)(t));l.mergeWith({list:i,searchParams:{globalQuery:_.globalQuery||_.q,performer:_.performer,lyrics:_.lyrics,sort:_.sort}}),l.setLocalFoundCount(i.length),i.length||s.length?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchNoLocalResults):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(this._els.searchNoLocalResults),o=vk.id===+this._ownerId?e.langs.audio_no_local_results:this._ownerId>0?e.langs.audio_no_user_local_results:e.langs.audio_no_group_local_results,this._els.searchNoLocalResults.innerHTML=o.replace("{query}","<strong>"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clean)(_.q)+"</strong>")),i.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchSectionAudiosHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchSectionAudios)),this._pagePlaylist=l,this._toggleSearchProgress(!1)}.bind(this))}},AudioPage.prototype.showFriendMusic=function(_,e){return(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("audio_friends_block","click_friend"),this.isLayer()?nav.go({0:"/audios"+e},!1,{friendId:e}):nav.go("/audios"+e,_),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.cancelEvent)(_)},AudioPage.prototype._deinitNavigation=function(){cur.nav.pop(),this._navigationInited=!1},AudioPage.PageSections=["recoms_audio","recoms_block","search_block","recoms_personal","my"];var layerSectionsToMainFrame=["search_block","search_playlists","recoms_block"];AudioPage.prototype.initNavigation=function(){this._navigationInited||this.isPodcastPage()||(this._navigationInited=!0,this._prevLoc={},!this.isLayer()&&nav.objLoc.popup&&"recoms_onboarding"===nav.objLoc.popup&&AudioPage.showRecomsOnboarding(),cur.nav.push(function(_,e,t,i){var o=this._ignoreResetedSearch;if(delete this._ignoreResetedSearch,o&&i.fromSearch)return!1;if(i.isLayer&&!this.isLayer())return!1;if(t.popup&&"recoms_onboarding"===t.popup)return AudioPage.showRecomsOnboarding(),nav.setLoc(t),!1;if(this.isLayer()&&!1!==this._prevLoc)for(var s in e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clone)(this._prevLoc),_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clone)(t),e)e.hasOwnProperty(s)&&(e[s]&&void 0===t[s]?_[s]=!1:e[s]==t[s]&&delete _[s]);if(_&&Object.keys(_).length){var a;if(this._deleteDeletedAudios(),this.isLayer())a=!t.q&&!!e.q&&t.section===e.section?this.prevSection||this.defaultSection:t.section;else a=t.section||this.defaultSection;var l=!1;return 0===t[0].indexOf("podcasts")&&(a="podcast"),i.tab||i.fromSearch||!1===_.q&&1===Object.keys(_).length||i.searchPerformer?l=!1:i.friendId&&this.isLayer()?(a="friend",this.resetSection(a),this._sectionData={friend_id:i.friendId},l=!1):(2!==Object.keys(_).length||!1!==_.q||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.isUndefined)(_[0]))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.isUndefined)(_[0])?"signal"===t.section||"signal"===e.section?l=!0:((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.inArray)(_.section,AudioPage.PageSections)||_.hasOwnProperty("block")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.inArray)(e.section,AudioPage.PageSections)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.inArray)(_.section,AudioPage.PageSections))&&(!this.isLayer()||layerSectionsToMainFrame.includes(t.section)||_.hasOwnProperty("block")?l=!0:(l=!1,this._sectionData={audio_id:_.audio_id},a="recoms",delete this._currentSection)):l=!0,l?(this.catalogController&&this.catalogController.destroy(),!0):(t.q?(this._els.searchInput&&!i.fromSearch&&(this._els.searchInput.value=t.q,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.triggerEvent)(this._els.searchInput,"keyup",{},!0),this.lastQuery=t.q),this._showSearchSection((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)({},t,i))):(this._ignoreResetedSearch=!1===_.q,this._els.searchInput&&uiSearch.reset(this._els.searchInput,!0),this.showSection(a),this._switchTab(a)),this.isLayer()?this._prevLoc=t:nav.setLoc(t),(i.back||i.hist||i.nav)&&this.syncParametersUI(t),!1)}}.bind(this)))},AudioPage.prototype._deleteDeletedAudios=function(){var _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAddRestoreInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(_,(function(_,e){"deleted"!==e.state&&"recom_hidden"!==e.state||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().deleteAudioFromAllPlaylists(_)}))},AudioPage.prototype._switchTab=function(_){if(!this.isPodcastPage()){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_tab__"+_,this._els.pageContainer);e?uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domFC)(e)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ui_tab_sel",this._els.pageContainer),"ui_tab_sel")}},AudioPage.prototype.onLayerHide=function(){this._deinitNavigation(),this._deinitKeyEvents(),this._onSectionOut(),delete this._currentSection,this._muteSearch=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player2")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchNoLocalResults),setTimeout((()=>uiSearch.reset(this._els.searchInput)),1e3)},AudioPage.prototype.updateLayerHeight=function(){var _=700;_=Math.min(_,window.innerHeight-150),_=Math.max(_,400),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.isVisible)(this._els.footer)&&(_-=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getSize)(this._els.footer)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(this._els.scrollWrap,{height:_}),this._els&&this._els.scrollWrap&&"function"==typeof this._els.scrollWrap.updateScroll&&this._els.scrollWrap.updateScroll()},AudioPage.prototype.scrollToCurrentTrack=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio(),e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylistQueue();if(this._audioRowsAutoList&&_&&e.indexOfAudio(_)>=0)for(var t=10;t--;){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_CURRENT_CLS,this._audioRowsAutoList.getListEl());if(i){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getXY)(i)[1];this._scroll.scroller.scrollTop=o-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)()-300,this._scroll.update(),this._layerStartInit=!1;break}this._audioRowsAutoList.drawMore(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().updateCurrentPlaying()}},AudioPage.prototype.onLayerShow=function(_){this._layerStartInit=!0;var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentPlaylist(),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio());t?this.showSection("podcast"):e?this.showSection("current"):_?this.showSection(_):this.showSection("all"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",!e||t),this.initNavigation(),this.updateCurrentPlayingInfo(),this._initKeyEvents(),this.updateLayerHeight(),this.updateShuffleButton(),this.scrollToCurrentTrack(),delete this._muteSearch},AudioPage.prototype.resetSection=function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section__"+_,this._els.sections);this.catalogController.deleteSection(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.re)(e)},AudioPage.prototype.isUpdateRequested=function(_){return Array.isArray(sectionsToUpdate)&&sectionsToUpdate.includes(_+this.getOwnerId())},AudioPage.disableAdsClick=function(_){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("audio_web_ad_link","click"),nav.go(_)},AudioPage.prototype.requestUpdate=function(_,e){void 0===e&&(e=""),sectionsToUpdate=_.map((_=>_+e))},AudioPage.prototype.showSection=function(_,e,t){this._currentSection&&this._currentSection!==this.prevSection&&(this.prevSection=this._currentSection),this.isPodcastPage()&&(_="podcast"),"search"!==this._currentSection||"all"!==_&&"current"!==_||uiSearch.reset(this._els.searchInput,!0),this._data.onlySkeleton||layers.fullhide&&layers.fullhide(),this._switchTab(_);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player2")&&"search"===_||this.isUpdateRequested(_);if(this._currentSection!==_||"search"===this._currentSection){this._currentSection=_;var o=this.findSectionElement(_),s=this._data.sectionData&&this._data.sectionData[_]||{};if(s.name=_,t||(this._data.onlySkeleton=!1),o&&(!i||!1===t)&&!this._data.onlySkeleton){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass)("_audio_section",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchGlobalBlocks),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchGlobalCommunitiesPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchGlobalPlaylistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchGlobalArtistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchGlobalAudiosBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player2")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.searchNoLocalResults),"search"===_&&!o.innerHTML)){var a,l;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(this._els.searchNoLocalResults);var n=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),r=vk.id===+this._ownerId?n.langs.audio_no_local_results:this._ownerId>0?n.langs.audio_no_user_local_results:n.langs.audio_no_group_local_results,d=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.winToUtf)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clean)(null!=(a=null==(l=s.searchParams)?void 0:l.globalQuery)?a:""));this._els.searchNoLocalResults.innerHTML=r.replace("{query}","<strong>"+d+"</strong>")}if(this._onSectionOut(),delete cur._back,"podcast"!==_&&(this.catalogController.setSection(_,o,s||{}),this.isLayer()||_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_44__.FullscreenBanner.initiate(s.sectionId)),this._onSectionOut((()=>{this.catalogController.disableSection(_)})),this.isLayer()||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentPlaylist()||!s.title||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setDocumentTitle)(s.title),!["podcast","current"].includes(_))return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isFunction)(e)&&e(),void(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().updateCurrentPlaying();switch(_){case"current":this._initSection_current(o,s,!0);break;case"podcast":this._initSection_podcast(o,s)}return(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().updateCurrentPlaying(),void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isFunction)(e)&&e())}var u=this._ownerId,c=!1;if("podcast"===_&&!this.isPodcastPage()){u=((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio()||this._readyAudio)[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID];var h={};try{h=JSON.parse((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio()[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_EXTRA])}catch(_){}!0===h.externalAudio&&(c=!0)}if(this.isUpdateRequested(_)&&(sectionsToUpdate=null),c)setTimeout((()=>{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.se)(`<div class="audio_section _audio_section _audio_section__${_} audio_section__${_} clear_fix audio_w_covers">\n        <div class="page_block audio_block">\n          <div class="audio_page__audio_rows _audio_page__audio_rows">\n            <div class="audio_page__audio_rows_list _audio_page__audio_rows_list audio_w_covers"></div>\n          </div>\n        </div>\n      </div>`);this._els.sections.appendChild(t),delete this._currentSection,this.showSection(_,e,!1)}));else{var E={act:"section",section:_,owner_id:u,is_layer:this.isLayer()?1:0,claim:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(nav.objLoc.claim)};"search"===_&&(E.query_id=this._cur_qid),ajax.post("al_audio.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)(E,this._sectionData||{}),{onDone:(t,i)=>{this._data.sectionData=this._data.sectionData||{},this.findSectionElement(_)&&t&&this.resetSection(_),this._data.sectionData[_]=i;var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.se)('<div class="audio_section _audio_section _audio_section__'+_+" audio_section__"+_+' clear_fix audio_w_covers">'+t+"</div>");this._els.sections.appendChild(o),delete this._currentSection,this.showSection(_,e,!1)},onFail:()=>!0}),delete this._sectionData}}else(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isFunction)(e)&&e()},AudioPage.prototype._onSectionOut=function(_){_?(this._onSectionOutCbs=this._onSectionOutCbs?this._onSectionOutCbs:[],this._onSectionOutCbs.push(_)):((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(this._onSectionOutCbs||[],(function(_,e){e()})),this._onSectionOutCbs=[])},AudioPage.prototype.findSectionElement=function(_){return this._els.sections.getElementsByClassName("_audio_section__"+_)[0]},AudioPage.prototype.onPlaylistsReorder=function(_,e,t){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(_,"raw-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(t,"raw-id");ajax.post("al_audio.php",{act:"reorder_playlist",owner_id:this.getOwnerId(),playlist_id:i.split("_")[1],prev_playlist_id:o?o.split("_")[1]:0,hash:this._data.reorderHash},{onFail:()=>!0})},AudioPage.prototype._initSection_current=function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page__audio_rows_list",_),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_more_rows",_),friendsBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_friends_list_wrap",_),friendsBlockContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_friends_list_content",_)});var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentPlaylist();if(!t&&!this.retriedCurrent)return this.retriedCurrent=!0,setTimeout((()=>this._initSection_current(_,e)));this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_28__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(this._els.audioRows,"playlist-id",t.getId()));var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_friends_search",_);i&&uiSearch.init(i),this._initAudioRowsAutoList(!0),setTimeout((()=>this._initFixedFriendsBlock(_)))},AudioPage.prototype.drawMore=function(){this._audioRowsAutoList&&this._audioRowsAutoList.drawMore()},AudioPage.prototype.scrollIntoView=function(_,e){this._scroll.scrollIntoView(_,e)},AudioPage.prototype._initSection_podcast=function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page__audio_rows_list",_),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("podcast_episodes_more",_)});var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentPlaylist();if(!t){var i=e.playlistData;i&&((t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylist(i.type,i.ownerId,i.id)).getAudiosCount()||(t.mergeWith(i),t.load()))}t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(this._els.audioRows,"playlist-id",t.getId())),this._initAudioRowsAutoList(),this._data.reverse||this._enableAudioRowsSorter()},AudioPage.prototype.setPagePlaylist=function(_){this._pagePlaylist=_},AudioPage.prototype._initFixedFriendsBlock=function(){if(this._els.friendsBlock){this._isFixed=!1,this._isDraggable=!1,this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getXY)(this._els.friendsBlock);var _=this.isLayer(),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getSize)("page_header")[1],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getSize)(this._els.playerWrap)[1],i=_?13:15;this._fixedThreshold=_?e+t+i:this._initialPos[1]-e-t-i;var o=_?this._scroll.scroller:window;if(!(this._fixedThreshold<0)){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(window,"resize",this._resizeHandler=()=>{this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getXY)(this._els.friendsBlock)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(o,"scroll",this._scrollHandler=()=>{this._moveFriendsBlock()});var s=this;AudioPage.onUpdateDraggablePosition=()=>{s._isDraggable=!0,s._moveFriendsBlock(),requestAnimationFrame((()=>s._isDraggable=!1))},AudioPage.forceFix=()=>{var _=s._els.friendsBlockContent.getBoundingClientRect();if(_.width>0&&_.height>0){var e=s.isLayer()?s._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)();s._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,e-s._fixedThreshold-9)}px)`,s._unfixedFriendsBlock()}},this._onSectionOut((()=>{this._scrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(o,"scroll",this._scrollHandler),this._resizeHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window,"resize",this._resizeHandler),this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(this._els.friendsBlockContent,"audio_friends_fixed")}))}}},AudioPage.prototype._moveFriendsBlock=function(){var _=this.isLayer()?this._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)(),e=this._els.friendsBlockContent.getBoundingClientRect(),t=e.width>0&&e.height>0;this._isDraggable&&t?(this._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,_-this._fixedThreshold-9)}px)`,this._unfixedFriendsBlock()):(this._els.friendsBlockContent.style.transform="",_>this._fixedThreshold?this._fixedFriendsBlock():this._unfixedFriendsBlock())},AudioPage.prototype._fixedFriendsBlock=function(){this._isFixed||(this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getXY)(this._els.friendsBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!0,this.isLayer()&&(this._fixedBlockScrollHandler=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(this._els.friendsBlockContent,"mousewheel",(_=>(this._scroll.scroller.scrollTop=this._scroll.scroller.scrollTop+_.deltaY,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.cancelEvent)(_))))))},AudioPage.prototype._unfixedFriendsBlock=function(){this._isFixed&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!1,this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler))},AudioPage.prototype.playPlaylist=function(_,e,t,i){var o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),s=o.getCurrentPlaylist(),a=o.getPlaylist(_,e,t);s&&s.equals(a)&&o.isPlaying()?o.pause():a.load(0,(function(){o.play(a.getAudiosList()[0],a,i)}))},AudioPage.prototype.playShuffledBlockPlaylist=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),t=e.getPlaylistByBlockId(_)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist({hasMore:!0,blockId:_});t.clean(),t.loadByBlockId("",(function(_){e.play(_.getAudiosList()[0],_,_.getContext())}))},AudioPage.prototype.playBlockPlaylist=function(_,e){void 0===e&&(e=null);var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),i=t.getCurrentPlaylist(),o=t.getPlaylistByBlockId(_)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist({hasMore:!0,blockId:_});if(i&&i.equals(o)&&t.isPlaying())t.pause();else{var s=o.getContext()||e&&e.dataset.context||"";o.loadByBlockId("",(_=>t.play(_.getAudiosList()[0],_,s)))}},AudioPage.prototype.onAudioRowsReorder=function(_,e,t,i){var o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(e,"full-id"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(i,"full-id"),l=o.getPlaylistQueue(),n=this.getPageCurrentPlaylist(),r=(_?l:n).indexOfAudio(s),d=(_?l:n).indexOfAudio(a);a?d++:d=0,l.moveAudio(r,d),_&&o.saveStateCurrentPlaylist(),this.isPodcastPage()?ajax.post("al_podcasts.php",{act:"a_reorder_episodes",hash:this._data.audiosReorderHash,oid:this.getOwnerId(),episode_id:s?s.split("_")[1]:0,next_episode_id:a?a.split("_")[1]:0},{onFail:()=>!0}):_||ajax.post("al_audio.php",{act:"reorder_audios",hash:this._data.audiosReorderHash,owner_id:this.getOwnerId(),audio_id:s?s.split("_")[1]:0,next_audio_id:a?a.split("_")[1]:0},{onFail:()=>!0})},AudioPage.prototype._enableAudioRowsSorter=function(_){(this._data.audiosReorderHash||_)&&(this._audioRowsSorter&&this._audioRowsSorter.destroy(),this._audioRowsSorter=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_35__.default(this._els.audioRows,"",{wrapNode:this.isLayer()?this._scroll.scroller:void 0,onReorder:(e,t,i)=>this.onAudioRowsReorder(_,e,t,i)}),this._onSectionOut(function(){this._audioRowsSorter&&this._audioRowsSorter.destroy()}.bind(this)))},AudioPage.prototype._disableAudioRowsSorter=function(){this._audioRowsSorter&&this._audioRowsSorter.disable()},AudioPage.prototype._initAudioRowsAutoList=function(_){if(void 0===_&&(_=!1),this._els.audioRows){var e=this.isPodcastPage()||"podcast"===this._currentSection,t=this._pagePlaylist;this._els.audioRows.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(this._els.audioRows,"audio_owner_list_canedit",!e&&!!this._data.canEdit),this._audioRowsAutoList&&this._audioRowsAutoList.destroy(),this._audioRowsAutoList=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_25__.default(this._els.audioRows,{scrollNode:!!this._scroll&&this._scroll.scroller,onRendered:function(){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().updateCurrentPlaying()},onNoMore:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(this._els.audioRowsMore)}.bind(this),onNeedRows:function(i,o,s,a,l){var n=[];e?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.lockButton)(this._els.audioRowsMore),this._loadPodcastEpisodes(o,function(_){(_||[]).slice(o).forEach((function(_){n.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.drawAudio(_))})),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.unlockButton)(this._els.audioRowsMore),i(n)}.bind(this))):t&&t.load(o,(()=>{var e,s=()=>{for(var _=o;_<o+30&&e[_];_++)n.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.drawAudio(e[_]));i(n),0===o&&this._audioRowsSorter&&this._audioRowsSorter.update(),0===o&&1===n.length&&l.drawMore()};if(_){var a=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylistQueue();a.addAudio(t.getAudiosList()),a.findAndFetchEmptyAudiosFrom(o).then((()=>{e=((e=a.getQueue())||[]).map((_=>{if(_[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_41__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]){var e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clone)(_);return e[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_41__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,e}return _})),s(),this._layerStartInit&&o===t.getTotalCount()&&(this._layerStartInit=!1),this._layerStartInit&&this.scrollToCurrentTrack()}))}else e=t.getAudiosList(),s()}))}.bind(this)}),this._onSectionOut(function(){this._audioRowsAutoList.destroy(),this._els.audioRows.innerHTML=""}.bind(this))}},AudioPage.prototype._loadPodcastEpisodes=function(_,e){var t,i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio()||this._readyAudio,o={};try{o=JSON.parse(i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_EXTRA])}catch(_){}if(o.externalAudio){var s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentPlaylist();e(s._ref._list)}else{t=this.isPodcastPage()?this._ownerId:i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],cur._podcastsEpisodes=cur._podcastsEpisodes||{},cur._podcastsEpisodes[t]=cur._podcastsEpisodes[t]||[];var a=cur._podcastsEpisodes[t];a.length&&_<a.length?e(a):ajax.post("al_podcasts.php",{act:"a_episodes",oid:t,episode_full_id:i?i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_ID]:"",offset:_,rev:this._data.reverse,claim:window.nav.objLoc.claim},{onDone:function(_){cur._podcastsEpisodes[t]=a.concat(_||[]),e(cur._podcastsEpisodes[t])},onFail:function(){return e(cur._podcastsEpisodes[t]),!0}})}},AudioPage.showAttachBox=function(_,e){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)().bodyNode),"offset")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)().bodyNode),"offset",0),1===vk.widget?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showBox)("al_audio.php",{act:"choose_box",owner_id:_,options:JSON.stringify(e)}):AudioPage.editPlaylist(_,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",e)},AudioPage.editPlaylist=function(_,e,t,i){if(vk.widget)for(var o in i)i.hasOwnProperty(o)&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isString)(i[o])?i[o]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clean)(i[o]):(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isFunction)(i[o])?delete i[o]:i[o]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(i[o]));var s,a;if("edit"===t&&i&&(i.audioAttachSwitchOwnerId=!1),i&&i.audioAttachSwitchOwnerId&&(cur.audioAttachSwitchOwnerId=i.audioAttachSwitchOwnerId),t=t||"edit",e)s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,_,e);else if(cur.audioPage){var l=cur.audioPage._data.maxPlaylistsCount;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isArray)(cur.audioPage._data.playlists)&&cur.audioPage._data.playlists.length>=l){var n=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(l,cur.lang.audio_playlists_limit_error).replace("{limit}",l);return void new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.MessageBox({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_error")}).content(n).setButtons("Ok",(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)().hide()})).show()}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(boxLayerWrap),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.boxRefreshCoords)(boxLoader),(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_34__.parallel)((_=>{window.stManager.add(["audio.css",window.jsc("web/indexer.js"),window.jsc("web/auto_list.js"),window.jsc("web/grid_sorter.js"),"edit"===t&&window.jsc("web/upload.js")],_)}),(_=>{s?(s.setForceReload(!0),s.loadAll(_,t)):_()}),(e=>{if(cur.audioPage&&cur.audioPage.getOwnerId()===+_&&!(null==i?void 0:i.promotedAudios)&&(a=cur.audioPage.getOwnerPlaylists()),null==i?void 0:i.promotedAudios){var o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)();a=[],i.addAudio=[],i.promotedAudios.forEach(((_,t,s)=>{var a=o.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,_[0],_[1]);0===a.getAudiosCount()&&void 0===a.getTotalCount()?a.load((()=>{i.addAudio.push(...a.getAudiosList()),t===s.length-1&&e()})):(i.addAudio.push(...a.getAudiosList()),t===s.length-1&&e())}))}else a?e():AudioPage.loadPlaylists(_,void 0,!1,"attach"===t,(_=>{a=_,e()}))}),(()=>{AudioPage._openEditPlaylist(t,_,e,a,i)}))},AudioPage.initBoxEls=function(_){return{boxContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_pl_edit_box",_.bodyNode),playlistNameInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_pl_title",_.bodyNode)),playlistDescriptionInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_pl_description",_.bodyNode)),playlistDiscoverToggle:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_discover_checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_pl_discover",_.bodyNode)),playlistUpdateIdInput:_.bodyNode.querySelector("#ape_pl_to_update_id"),playlistUpdateTimeInput:_.bodyNode.querySelector("#ape_pl_to_update_time"),playlistUpdateCutInput:_.bodyNode.querySelector("#ape_pl_to_update_cut"),playlistUpdateFilterInput:_.bodyNode.querySelector("#ape_pl_to_update_filter"),stat:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_pl_stat",_.bodyNode),uploadCoverButtonWrapper:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover",_.bodyNode),uploadCoverInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_upload",_.bodyNode),errorMsg:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_error_msg",_.bodyNode),header:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_header",_.bodyNode),search:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_search",_.bodyNode),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_field",_.bodyNode),addAudiosButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_add_audios_btn",_.bodyNode),addAudiosFromPlaylistsButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_add_pl_audios_btn",_.bodyNode),listWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_list_wrap",_.bodyNode),list:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_item_list",_.bodyNode),globalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_item_global_results",_.bodyNode),globalResultsList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_item_global_list",_.bodyNode),emptyPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_audios_empty_list",_.bodyNode),emptyPlaylistsPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_audios_empty_playlists_list",_.bodyNode),emptyGlobalPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_audios_empty_global_list",_.bodyNode)}},AudioPage.showRecomsOnboarding=function(_){void 0===_&&(_=!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(boxLayerWrap),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.boxRefreshCoords)(boxLoader),ajax.post("al_audio.php?act=get_recoms_onboarding",{load_script:+_},{onDone:_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(boxLoader);var e=!1;if(window.AudioRecomsOnboarding)if(window.AudioRecomsOnboarding.checkFinalScreen())window.AudioRecomsOnboarding.showFinalScreenFromLS(),e=!0;else if(_){new window.AudioRecomsOnboarding(_).show(),e=!0}e||(window.nav.change({popup:!1}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(boxLayerWrap))}})},AudioPage._openEditPlaylist=function(_,e,t,i,o){var s,a,l,n,r,d,u,c,h=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),E=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_TEMP,e,(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.irand)(0,999999));if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)()){d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)().bodyNode),"offset"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)("ape_edit_playlist_search");var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)().bodyNode);p&&(c=p.scrollTop)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(boxLoader),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(boxLayerWrap),cur.apLayer&&(r=cur.apLayerPlaylistId,layers.fullhide()),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)({audioPickerButtonText:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_add_media"),playlistPickerButtonText:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_attach_playlist_button"),canPlaylistAttach:!1,onAudioChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.onAudioChoose,onPlaylistChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.onPlaylistChoose},o),cur.onChooseAudio=o.onAudioChoose,cur.onChoosePlaylist=o.onPlaylistChoose;var P,b=!t||t===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID,g="attach"===_,O=!!(null==(s=o)?void 0:s.promotedAudios),D=!1,M=!1,m=!1,C=!1,w=0,A=null,y=!0,v=!1,f=0,I=0;i=i.filter((_=>_.id!==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID&&_.size>0));var T=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_33__.vkIndexer(i,(_=>_.title)),B=i.length>0,L=!1;b&&!g||O?o.addAudio&&E.pushAudio(o.addAudio):(L=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,e,t),E.pushAudio(L.getAudiosList()),E.mergeWith({title:L.getTitle(),description:L.getDescription(),rawDescription:L.getRawDescription(),coverUrl:L.getCoverUrl(),editHash:L.getEditHash(),noDiscover:L.getNoDiscover()}));var R=g?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_choose_audio_title"):t?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_edit_playlist_title"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_new_playlist_title");function U(_){if(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(_)){var e=" "+(_+"|")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.parseLatin)(_)||"")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.parseCyr)(_)||"");e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(e.replace(/\)/g,"").replace(/&/,"&amp;")),C=new RegExp("(\\s|^)("+e.replace(_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_33__.vkIndexer.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi")}else C=!1;z(M,"playlists"!==D,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.emptyGlobalPlaceholder)}function W(){o.onClose&&o.onClose(),y||(E.clean(),h.deletePlaylist(E),r&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.showAudioPlaylist(r[0],r[1]))}function K(e){return!(v&&!e&&"attach"!==_)||(t?(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_edit_playlist_cancel_confirm_text"),o=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_edit_playlist_cancel_confirm_yes")):(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_new_playlist_remove_confirm_text"),o=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_new_playlist_remove_confirm_continue")),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showFastBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_warning"),i,o,(()=>{y=!1,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)().hide(),a.hide(!0)}),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_cancel")),!1);var i,o}function S(){return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(l.searchInput.value)}function k(e){var t=E.indexOfAudio(e)>=0?"ape_selected":"",i=e;C&&((e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clone)(i))[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_TITLE].replace(C,"$1<em>$2</em>"),e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER].replace(C,"$1<em>$2</em>"));var s="";if("edit"===_){s=`<div class="ape_check">\n        <div class="ape_check--unchecked">${(0,_icons_desktop_getIcon24CheckCircleOff__WEBPACK_IMPORTED_MODULE_49__.getIcon24CheckCircleOff)().icon}</div>\n        <div class="ape_check--checked">${(0,_icons_desktop_getIcon24CheckCircleOn__WEBPACK_IMPORTED_MODULE_50__.getIcon24CheckCircleOn)().icon}</div>\n      </div>`}else{var a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(i);if(o&&o.wiki)s='<div role="button" class="ape_attach" onclick="'+`editorChooseAudio(\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clean)(a.performer)}',\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clean)(a.title)}',\n        ${a.duration},\n        '${a.fullId}',\n        '${a.url}',\n        ${a.duration},\n        this)`+'">'+o.audioPickerButtonText+"</div>";else s=`<div role="button" class="ape_attach" onclick="cur.onChooseAudio(event, this, ${a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clean)(JSON.stringify(a))}, ${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.clean)(JSON.stringify(i))})">${o.audioPickerButtonText}</div>`}return'<div class="ape_audio_item_wrap _ape_audio_item '+t+'">'+s+_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.drawAudio(e)+"</div>"}function x(){clearTimeout(f);var _=S();_&&(f=setTimeout((function(){f=!1,(m=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_34__.hashCode)(_+"no conflict"))).mergeWith({searchParams:{globalQuery:_},hasMore:!0});var e=0;n&&(e=n.getOffset(),n.destroy()),(n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_25__.default(l.list,{scrollNode:l.list,onNeedRows:function(_,t){t-=e,m.load(t,(function(){var e=[],i=m.getAudiosList();if(0==+t&&i.length&&e.push('<div class="ape_list_header">'+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_edit_playlist_global_results")+"<div>"),i.length)for(var o=Math.min(i.length,t+20),s=t;s<o;s++)i[s]&&e.push(k(i[s]));m.getAudiosCount()||n&&n._offset?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.list)),_(e)}))}})).drawMore()}),300),A=null)}function H(){a.setOptions({title:'<div class="back _back"><span class="back__icon">'+(0,_icons_desktop_getIcon24ChevronLeft__WEBPACK_IMPORTED_MODULE_51__.getIcon24ChevronLeft)().icon+"</span>"+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_back")+"</div>",bodyStyle:"padding: 0"})}function F(){var _="";cur.audioAttachSwitchOwnerId&&cur.audioAttachOriginalOwnerId&&(_='<span class="dvd"></span><a class="tab_link" onclick="cur.audioAttachSwitch()">',_+=E.getOwnerId()<0?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_choose_wall_to_my_audios"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_choose_wall_to_group_audios"),E.getOwnerId()===cur.audioAttachOriginalOwnerId?cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachSwitchOwnerId,o)}:cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachOriginalOwnerId,o)},_+="</a>"),a.setOptions({title:R+_,bodyStyle:"padding: 0"})}function N(){var _=l.boxContent.getBoundingClientRect();if(_.height&&_.width){var e=l.list.getBoundingClientRect();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(l.list,{height:_.height-(e.y-_.y)})}}function z(_,e,t){M=_,e&&M?t?M.search({q:t},(function(_){q(!0,_)})):q(!0,M.getAudiosList(),_):q(!1,t?T.search(t):i),G("initial"===D&&!t)}function q(_,e,t){l.list.innerHTML="",n&&n.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.emptyPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.emptyPlaylistsPlaceholder),N();var i=0;n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_25__.default(l.list,{scrollNode:l.list,onNoMore:function(){0===i&&(S()?_||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.emptyPlaylistsPlaceholder)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.emptyPlaceholder))),O?function(){clearTimeout(I);var _=S();_&&(I=setTimeout((function(){I=!1;var e=0;n&&(e=n.getOffset(),n.destroy()),n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_25__.default(l.list,{scrollNode:l.list,onNeedRows:function(t,i){i>e?t([]):(i-=e,ajax.post("/audio?act=load_catalog_section",{section_id:o.audioSectionId,search_query:_},{onDone:function(){var _,e,o=(null==(_=arguments[1])||null==(e=_.playlist)?void 0:e.list)||[],s=[];0==+i&&o.length&&s.push('<div class="ape_list_header">'+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_edit_playlist_global_results")+"<div>"),o.length&&o.forEach((_=>{s.push(k(_))})),o&&o.length?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.emptyGlobalPlaceholder)),t(s)},onFail:function(_){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_error"),width:350},_),!0}}))}}),n.drawMore()}),100),A=null)}():_&&x()},onNeedRows:function(o,s){var a=d||20,l=t&&t.hasMore()?s+a:Math.min(e.length,s+a);if(l>e.length&&t&&t.hasMore())t.load(s+a,(a=>{var n=Y((e=t.getAudiosList()).slice(s,l),_);i+=n.length,o(n)}));else{var n=Y(e.slice(s,l),_);i+=n.length,o(n)}},onRendered:_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(l.list,"offset",_),c&&d&&(l.list.scrollTop=c,d=0,c=0)}})}function Y(_,e){var t=(0,_icons_desktop_getIcon24Playlist__WEBPACK_IMPORTED_MODULE_52__.getIcon24Playlist)().icon,i=(0,_icons_desktop_getIcon24ChevronRight__WEBPACK_IMPORTED_MODULE_53__.getIcon24ChevronRight)().icon;return _.map((_=>{if(e)return k(_);var o='<div class="ape_pl_item_inner"><span class="ape_pl_title">'+(C?_.title.replace(C,"$1<em>$2</em>"):_.title)+'</span> <span class="ape_pl_size">'+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(_.size,cur.lang.audio_playlist_audios_count,!0).replace("{count}",_.size)+"</span></div>";return`<div class="ape_pl_item"\n                        data-playlist-access-hash="${_.access_hash}"\n                        data-playlist-owner-id="${_.owner_id}"\n                        data-playlist-id="${_.id}">\n                          <div class="ape_pl_item__icon_playlist">${t}</div>\n                          ${o}\n                          <div class="ape_pl_item__icon_chevron">${i}</div>\n                        </div>`}))}function G(_){P||(P=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_35__.default(l.list,"ape_audio_item_wrap",{wrapNode:l.list,onReorder:function(_,e){var t,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_row",_),"full-id"),o=E.indexOfAudio(i);e?(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_row",e),"full-id"),t=E.indexOfAudio(i)):t=E.getAudiosCount(),E.moveAudio(o,t)}})),_?P.enable():P.disable()}function j(t,s){if("default"===t&&cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_error")},cur.audioPage._data.addBannedText);else{switch(D=t,a.removeButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(l.list,"view",t),t){case"initial":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.globalResults),z(E,!0),$(),F();break;case"default":var n=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,e,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.disableEl)(l.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.showProgress)(l.addAudiosButton),n.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.enableEl)(l.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.hideProgress)(l.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggle)(l.addAudiosFromPlaylistsButton,B),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.addAudiosButton),"edit"===_?H():F(),z(n,!0,u),N(),"edit"===_&&$()}));break;case"playlists":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.globalResults),H(),z(i);break;case"playlist":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.addAudiosButton),H(),z(s,!0),g&&function(_){if(!o.canPlaylistAttach)return;function e(e){cur.onChoosePlaylist(e,_)}a.addButton(o.playlistPickerButtonText,e,"ok",!0)}(s),"edit"===_&&$()}N(),l.searchInput.value="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.elfocus)(l.searchInput),C=!1,A=null,clearTimeout(f),h&&h.updateCurrentPlaying&&h.updateCurrentPlaying()}}function $(){a.addButton((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_save_playlist_button"),Q,"ok",!0)}function V(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domClosest)("ape_pl_item",_.target);if(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(e,"playlist-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(e,"playlist-owner-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(e,"playlist-access-hash"),s=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,i,t,o);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.showProgress)(e),s.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.hideProgress)(e),j("playlist",s)}))}if(_.target.closest(".ape_check")){function b(_,e){if(cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_error")},cur.audioPage._data.addBannedText);else{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(_,"ape_selected",e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_row",_),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAudioFromEl(i);t?E.pushAudio(o,0):E.removeAudio(o)}}var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domClosest)("_ape_audio_item",_.target);if(_.shiftKey&&A){var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domChildIndex)(A),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domChildIndex)(a),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domPN)(a);if(n>r){var u=r;r=n,n=u}for(var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)(A,"ape_selected"),p=n;p<=r;p++)b(d.children[p],c)}else b(a),A=a;X(),__()}if(g&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)(_.target,"artist_link")){if(_.metaKey&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_13__.browser.mac||_.ctrlKey)return;var P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(_.target,"performer")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(_.target.innerText);P&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)(l.searchInput,P),uiSearch.onChanged(l.searchInput),U(P))}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.cancelEvent)(_)}function X(){var _,e=E.getAudiosCount(),t=E.getTotalDuration();if(e){var i;_=(_=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(e,cur.lang.audio_edit_playlist_audios_info)).replace("{count}",e);var o=t%60,s=Math.floor(t/60)%60,a=Math.floor(t/3600);t<60?i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(t,cur.lang.audio_total_dur_seconds):t<3600?(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(s,cur.lang.audio_total_dur_minutes),o&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(o,cur.lang.audio_total_dur_seconds))):(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(a,cur.lang.audio_total_dur_hours),s&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.langNumeric)(s,cur.lang.audio_total_dur_minutes))),_+='<span class="dvd">'+i+"</span>"}else _=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_edit_playlist_no_audios");l.stat.innerHTML=_}function Q(_){var t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)(l.playlistNameInput));t=t.replace(/[\u200B-\u200D\uFEFF]/g,"");var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)(l.playlistDescriptionInput)),s=+(l.playlistDiscoverToggle&&l.playlistDiscoverToggle.classList.contains("on"));if(l.playlistUpdateIdInput&&(t=`${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(l.playlistUpdateIdInput.value)}_${l.playlistUpdateTimeInput.valueAsNumber}_${l.playlistUpdateCutInput.valueAsNumber}`),!t)return j("initial"),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.ge)("ape_pl_name"));var n=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(E.getAudiosList(),(function(_,e){n.push(e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_ID]+"_"+e[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_41__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY])}));var r=o.newPlaylistHash||cur.audioPage&&cur.audioPage._data.newPlaylistHash||"",d={hash:b?r:L.getEditHash(),owner_id:e,playlist_id:b?0:L.getPlaylistId(),title:t,description:i,Audios:n.join(","),cover:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isObject)(w)?JSON.stringify(w):w};l.playlistUpdateIdInput&&(d.update_id=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(l.playlistUpdateIdInput.value),d.update_time=(l.playlistUpdateTimeInput.valueAsNumber+6e4*(new Date).getTimezoneOffset())/1e3,d.update_cut=l.playlistUpdateCutInput.valueAsNumber,d.update_filter=l.playlistUpdateFilterInput.classList.contains("on")?1:0),null!==s&&(d.no_discover=s),ajax.post("al_audio.php?act=save_playlist",d,{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.lockButton)(_),onDone:(_,t)=>{b&&!document.querySelector(".CatalogSection ._audio_page__playlists")?nav.reload():((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass)("_audio_pl_"+_.ownerId+"_"+_.id),(function(){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_pl__cover",this);if(e){AudioPage.setCoverImageElem(e,_.coverUrl,_.title);var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_pl_grid_covers_wrap",this);t&&(t.innerHTML=_.coverUrl?"":_.gridCovers)}var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_pl__title",this);if(i){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_item__title",i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)(o||i,_.title)}var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_pl__stats_count",this);s&&(s.innerHTML=_.totalCount)})),b&&cur.audioPage&&e==cur.audioPage.getOwnerId()&&["all","my_playlists"].includes(cur.audioPage._currentSection)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(cur.audioPage._els.pageContainer.querySelectorAll(".CatalogBlock__my_playlists ._audio_page_block__playlists_items"),(function(){var _=t.thumb,e=t.title,i=_extends({},t,{cover_image:AudioPage.getCoverImage(_,e)}),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.getTemplate)("audio_pl_item",i)),s=this;if(s.classList.contains("ui_gallery")){var a=(0,_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_45__.uiGetGallery)(s),l=document.createElement("div");l.classList.add("ui_gallery_item"),l.appendChild(o),a.addItems([l],0)}else{s.insertBefore(o,s.firstChild);var n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(s,"max-items"));n&&s.children.length>n&&s.removeChild(s.lastChild)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_page__playlists",s))})),cur.audioPage._data.playlists=cur.audioPage._data.playlists||[],cur.audioPage._data.playlists.unshift(t)),b&&cur.audioPage&&cur.audioPage.catalogController.updateSectionReorder(),cur.audioPage&&cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(e),L&&(L.clean(),L.mergeWith(_)),a.hide(!0),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isFunction)(o.onPlaylistSave)&&o.onPlaylistSave(L))},onFail:()=>(a.hide(!0),!0)})}function J(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.coverThumb),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(l.coverThumb,"background-image","url("+_+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(l.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.uploadCoverButton)}function Z(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(l.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_thumb")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.uploadCoverButton),w=-1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.cancelEvent)(_)}function __(){v=!0}(2===vk.widget||3===vk.widget)&&window.box&&(!boxQueue.count()&&!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)()||cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)())?(a=window.box).setOptions({title:R,bodyStyle:"padding: 0",width:560,onBeforeHide:W,onHideAttempt:K,hideButtons:!0}):(cur.audioChooseBox&&cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)().hide(),a=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.MessageBox({title:R,bodyStyle:"padding: 0",width:560,onBeforeHide:W,onHideAttempt:K})),cur.audioChooseBox=a,a.content((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.getTemplate)("audio_edit_playlist")),a.show(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(a,"ownerId",e),l=AudioPage.initBoxEls(a),function(){var t=window.innerHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(l.boxContent,"height",Math.min(800,Math.max(t-200,500))),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(l.addAudiosFromPlaylistsButton,"click",j.bind(this,"playlists")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(l.addAudiosButton,"click",j.bind(this,"default")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(l.list,"click",V),g&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(l.list,"audio-context","attach");(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(a.titleWrap,"click",(function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)(_.target,"_back")&&function(){switch(D){case"initial":break;case"default":j("initial");break;case"playlists":j("default");break;case"playlist":j("playlists")}}()})),uiSearch.init("ape_edit_playlist_search",{onChange:U}),"edit"===_&&(j("initial"),X(),function(){if(!cur.audioCoverUploadOptions||!cur.audioCoverUploadOptions[e])return;var _=cur.audioCoverUploadOptions[e],t={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",onUploadStart:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_progress"))},onUploadComplete:function(_,e){(e=JSON.parse(e)).error?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.show)(l.errorMsg),N()):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)(l.errorMsg),J((w=e).url),__(),N()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_progress"))},onUploadProgress:function(_,e,t){},onUploadError:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_progress"))},clear:1,type:"photo",max_attempts:3,server:_.server,noCheck:!0,chooseBox:!0,uploadButton:!0,accept:".jpg,.jpeg,.png",filesize_hide_last:!0,label:_.button};function i(){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.isObject)(w)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_progress"))||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByTag1)("input",l.uploadCoverButtonWrapper).click()}Upload.init(l.uploadCoverButtonWrapper,_.url,_.vars,t),l.uploadCoverButton=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ape_cover_accessibility_upload_btn",a.bodyNode),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_delete"),"click",Z),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(l.uploadCoverButton,"click",(()=>i())),l.coverThumb=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_ape_cover_thumb")}(),E.getCoverUrl()&&J(E.getCoverUrl()),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_18__.autosizeSetup)(l.playlistDescriptionInput,{minHeight:30,maxHeight:150,onResize:N}),l.playlistNameInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.replaceEntities)(E.getTitle()),l.playlistDescriptionInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.replaceEntities)(E.getRawDescription().replace(/<br>/g,"\n")),l.playlistDiscoverToggle&&l.playlistDiscoverToggle.classList.toggle("on",E.getNoDiscover()),l.playlistNameInput.addEventListener("input",__),l.playlistDescriptionInput.addEventListener("input",__),l.playlistDiscoverToggle&&l.playlistDiscoverToggle.addEventListener("click",__),l.playlistUpdateIdInput&&cur.editorialPlaylistsParams&&(l.playlistUpdateIdInput.value=cur.editorialPlaylistsParams.target_playlist,l.playlistUpdateTimeInput.valueAsNumber=1e3*cur.editorialPlaylistsParams.update_time-6e4*(new Date).getTimezoneOffset(),l.playlistUpdateCutInput.valueAsNumber=cur.editorialPlaylistsParams.update_cut,l.playlistUpdateFilterInput.classList.toggle("on",1===cur.editorialPlaylistsParams.update_filter),l.playlistUpdateFilterInput.setAttribute("aria-checked",1===cur.editorialPlaylistsParams.update_filter),l.playlistUpdateIdInput.addEventListener("input",__),l.playlistUpdateTimeInput.addEventListener("input",__),l.playlistUpdateCutInput.addEventListener("input",__),l.playlistUpdateFilterInput.addEventListener("click",__)));O?j("playlist",E):g&&j("default");F(),L&&"attach"!==_&&a.setControlsText(`<a onclick="AudioPage.deletePlaylist(${L.getOwnerId()}, ${L.getPlaylistId()}, '${L.getEditHash()}')">\n                              ${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_delete_playlist")}\n                            </a>`)}(a.bodyNode),u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)(l.searchInput,u),x()},AudioPage.prototype._deinitKeyEvents=function(){this._audioHQKeyEventHandler1&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window.document,"keydown",this._audioHQKeyEventHandler1),this._audioHQKeyEventHandler2&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window.document,"keyup",this._audioHQKeyEventHandler2),this._audioHQKeyEventHandler3&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window.document,"visibilitychange",this._audioHQKeyEventHandler3),this._audioHQKeyEventHandler4&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4),this._audioSeekKeyEventHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window.document,"keydown",this._audioSeekKeyEventHandler)},AudioPage.prototype._initKeyEvents=function(){this._deinitKeyEvents();var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),e=()=>!this.isLayer()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getLayer().isShown();(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4=function(_){_.ctrlKey&&(cur.ctrlMouseDown=!0,cur.ctrlPressed=!1)},!0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(window.document,"keydown",this._audioHQKeyEventHandler1=function(_){e()||(cur.ctrlPressed=_.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.KEY.CTRL)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(window.document,"keyup",this._audioHQKeyEventHandler2=function(_){e()||(_.keyCode!==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.KEY.CTRL||cur.ctrlMouseDown)&&(delete cur.ctrlMouseDown,delete cur.ctrlPressed)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(window.document,"keydown",this._audioSeekKeyEventHandler=function(t){var i=t.target,o=i&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.inArray)(i.tagName.toLowerCase(),["input","textarea"])&&""!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)(i),s=i&&i.isContentEditable,a=cur&&cur.pvShown;o||s||a||e()||!_.isPlaying()||!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.inArray)(t.keyCode,[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.KEY.RIGHT,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.KEY.LEFT])||cur.wallLayer||t.ctrlKey||_.seekCurrentAudio(t.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.KEY.RIGHT)}),cur.destroy.push((()=>this._deinitKeyEvents()))},AudioPage.prototype.editFeed=function(){var _=this;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"audio",height:lastWindowHeight},{stat:[window.jsc("web/privacy.js"),"privacy.css","ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")],dark:1}),cur.onOListSave=function(e,t,i,o){var s=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_19__.curBox)(),a={act:"a_ignore_olist",hash:o.hash};return e.length<t.length?a.White=e.join(","):a.Black=t.join(","),ajax.post("al_audio.php",a,{onDone:function(){s.hide(),_.getCurrentPlaylist().clean(),_.refreshCurrentPage()},onFail:()=>!0,showProgress:s.showProgress,hiderogress:s.hideProgress}),!1}},AudioPage.prototype.updateStatusExportControls=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),t=e.getStatusExportInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass)("_audio_export_status",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(this,"on",t&&!!t[(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(this,"oid")])}));var i=e.hasStatusExport(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player_status",this._els.pageContainer);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(o,"audio_page_player_btn_enabled",i),!_)if(this.isLayer())cur.audioPage&&cur.audioPage.updateStatusExportControls(!0);else{var s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getLayer().getPageInstance();s&&s.updateStatusExportControls(!0)}return!1},AudioPage.prototype.updateStatusExport=function(_,e){_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.checkbox)(_),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(e);var t,i,o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),s=o.getStatusExportInfo()||{};if(e)s[e]?(delete s[e],t=!1):(s[e]=1,t=!0);else if(o.hasStatusExport()){for(var a in s)s.hasOwnProperty(a)&&delete s[a];t=!1}else s[e=vk.id]=1,t=!0;o.setStatusExportInfo(s),e!=vk.id&&e||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.checkbox)("currinfo_audio",o.hasStatusExport()),this.updateStatusExportControls();var l=o.getCurrentAudio();l&&(i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(l).fullId);var n=null;o.stats.sendCurrentAudioEvent({type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_23__.TYPE_BROADCASTING,subtype:t?_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_23__.SUBTYPE_ON:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_23__.SUBTYPE_OFF,targetOwnerId:e}),ajax.post("al_audio.php?act=toggle_status",{exp:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(t),oid:e,hash:vk.statusExportHash,id:i,top:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(n)},{onFail:()=>!0})},AudioPage.prototype.playStatusAudio=function(_,e,t){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_friend",t);(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().playLive(_,{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.showProgress.pbind(i),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_36__.hideProgress.pbind(i)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.cancelEvent)(e)},AudioPage.showActionTooltip=function(_,e){var t=[3,-8,0],i=currentAudioPage(_),o=i&&i.isLayer();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)(_,"_audio_page_player_add")?(0,_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_38__.audioShowActionTooltip)(_,t,o):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)(_,"_audio_page_player_play_rate")&&(t[0]=-17),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_39__.showTooltip)(_,{text:e,black:1,shift:t,appendParentCls:"_audio_page_player",forcetodown:o,needLeft:o}))},AudioPage.prototype.onHide=function(){var _=this;cur.nav=cur.nav.filter((function(e){return _._nav_func!=e})),this._deinitKeyEvents()},AudioPage.prototype.showRecoms=function(_,e){if(!e){var t=this._readyAudio?this._readyAudio:(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio();if(!t)return;e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(t).fullId}(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("audio_recoms_by_track_button_click",!0),nav.go({0:"audio",section:"recoms_audio",audio_id:e},null,{nocur:!0})},AudioPage.prototype.onAudioUploaded=function(_,e){if(e){var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),i=t.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID);i.pushAudio(e);var o=t.getCurrentPlaylist();o&&o.getSelf()==i&&o.pushAudio(e),"all"!==this._currentSection&&this.resetSection("all");var s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(e);(0,_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_24__.onAdditionalEvent)(null,s,{type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_23__.TYPE_ADDED,subtype:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_23__.SUBTYPE_UPLOAD,context:"on_audio_uploaded",playlistId:i.getOwnerId()+"_"+i.getPlaylistId()});var a=5,l=this;!function _(t){--a<0||setTimeout((function(){ajax.post("al_audio.php?act=check_audio_data",{audio_owner_id:s.ownerId,audio_id:s.id},{onDone:function(i){if(i){var o=i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_TITLE];(o=(o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER])||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS])&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().updateAudio(s.fullId,i),"all"===l._currentSection&&"audio"===cur.module&&l._initAudioRowsAutoList(),s=i),_(1.5*t)}},onFail:()=>!0})}),t)}(1e3)}},AudioPage.prototype.onAudioAllUploaded=function(){"all"===this._currentSection&&nav.reload()},AudioPage.prototype.uploadAudio=function(_){this._data.uploadBanned?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_error")},this._data.uploadBannedText):(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showBox)("al_audio.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)(_||{},{act:"new_audio",gid:this.getOwnerId()<0?-this.getOwnerId():0}),{params:{width:"450px",bodyStyle:"padding: 0px; position: relative;"},dark:1})},AudioPage.prototype.editAudio=function(_,e,t){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_32__.showBox)("al_audio.php",{act:"edit_audio_box",aid:e},{params:{width:"456px",bodyStyle:"padding: 20px; background-color: #F7F7F7;",hideButtons:1},dark:1}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.cancelEvent)(t),!1},AudioPage.prototype.restoreRecommendation=function(_){var e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAudioFromEl(_,!0),t={act:"restore_recommendation",hash:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAudioExtra(e).recom.hash,audio_id:e.fullId};nav.objLoc.audio_id&&(t.recommendation_type="query"),nav.objLoc.album_id&&(t.recommendation_type="album"),ajax.post("al_audio.php",t,{onFail:()=>!0}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(_,"audio_row__deleted");var i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAddRestoreInfo(),o=i[e.fullId].removedCurrentPos,s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentPlaylist(),a=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylistQueue();o>=0&&s&&s.getType()==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_RECOM&&a.addAudio(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAudioFromEl(_),o),delete i[e.fullId],_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.onRowOver(_,!1,!0)},AudioPage.isInRecentPlayed=function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("_audio_playlist",_);return!(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)(e,"audio_recent_rows"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(e,"playlist")},AudioPage.prototype.chooseFromMyAudios=function(_){var e=!1;AudioPage.editPlaylist(vk.id,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",{audioPickerButtonText:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_add"),playlistPickerButtonText:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_add"),onClose:()=>{e&&nav.reload()},onAudioChoose:(t,i,o)=>{var s=t.ctrlKey||t.metaKey;if(ajax.post("al_audio.php?act=add",{group_id:_,audio_owner_id:o.ownerId,audio_id:o.id,hash:o.addHash},{onDone:_=>{_&&(e=!0)},onFail:()=>!0}),s)i.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_choose_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(i,"ape_added");else{e=!0;var a=window.__bq;if(a)for(;a.count();)a.hideLast()}}})},AudioPage.prototype.updateShuffleButton=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylistQueue(),e=_.isShuffled()&&!_.isInitedSortedList();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player_shuffle",this._els.pageContainer),"audio_page_player_btn_enabled",e),this.isLayer()&&cur.audioPage&&cur.audioPage.updateShuffleButton()},AudioPage.prototype.togglePodcast=function(_,e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(this._els.player,"audio_player_podcast",_),this._updatePlaybackRate(),!this.isPodcastPage()){this.isLayer()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",_||!(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentPlaylist());var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_tab__podcast",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggle)(t,_),t&&_&&(e=e||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.attr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("ui_tab",t),"href","podcasts"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]))}},AudioPage.prototype.toggleArticleTts=function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(this._els.player,"audio_player_article_tts",_),this._updatePlaybackRate()},AudioPage.prototype.updateFaveButton=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentFaveStatus(),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_fave",this._els.player);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(e,"activated",_)},AudioPage.prototype.toggleRepeat=function(){if(!this.isPodcastPage()){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)();_.isRepeatAll()||_.isRepeatCurrentAudio()?_.toggleRepeatCurrentAudio():_.toggleRepeatAll(),this.updateRepeatButton()}},AudioPage.prototype.updateRepeatButton=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass)("_audio_page_player_repeat");if(_&&_.length){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),t=e.isRepeatAll(),i=e.isRepeatCurrentAudio();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.each)(_,((_,e)=>{e.ariaLabel=e.ariaLabel&&AudioPage.getRepeatButtonText(),e.onmouseover=e.onmouseover&&AudioPage.showActionTooltip.bind(void 0,e,AudioPage.getRepeatButtonText),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(e,"audio_page_player_btn_enabled",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(e,"audio_page_player_btn_repeat_one",i)}))}},AudioPage.getRepeatButtonText=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),e=_.isRepeatAll(),t=_.isRepeatCurrentAudio(),i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_repeat_tooltip");return e?i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_repeat_track_tooltip"):t&&(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("audio_dont_repeat_tooltip")),i},AudioPage.prototype.toggleShuffle=function(_){if(!this.isPodcastPage()){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(_,"audio_page_player_btn_enabled")&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("audio_sort_stat","audio_sort","shuffle_player",this.isLayer()?"layer":"page");var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylistQueue();if(!e.isEmpty()){var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio(),i=()=>{e.isShuffled()?e.resetShuffle():e.shuffle(!0),"current"===this._currentSection&&this._initAudioRowsAutoList(!0),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().play(t),this.updateShuffleButton()};t?i():e.getAudioAt(0).then((_=>{t=_,i()}))}}},AudioPage.prototype.toggleFave=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast(e)&&AudioPlayer.podcastToggleFave(_,e)},AudioPage.prototype.changePlaybackRate=function(_,e){var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast(t)||_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isArticleTts(t))&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().podcastChangePlaybackRate(!!e.shiftKey),this._updatePlaybackRate())},AudioPage.prototype._updatePlaybackRate=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_play_rate",this._els.player);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_icon",_),AudioPlayer.podcastGetPlaybackRate()+"x")},AudioPage.prototype._getCurrentSearchParams=function(){var _=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(this.isLayer())],e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(this._searchSortFilter.selectedItems()[0][0]);return{performer:_&&_.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_fltr_with_lyrics",this._container),"on")?1:null,sort:e?1:null}},AudioPage.searchAudios=function(_,e,t,i,o){currentAudioPage(this).searchAudios(_,e,t,i,o)},AudioPage.prototype.searchAudios=function(_,e,t,i,o){this.lastQuery!==_&&(this.lastQuery=_,this._muteSearch?delete this._muteSearch:(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(_),nav.change((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.extend)(this._getCurrentSearchParams(),{q:_||null}),!1,{fromSearch:!0,globalQuery:_,fromHistory:t,isLayer:this.isLayer(),fetchedQuery:i,fromSuggestsAcceptId:o})))},AudioPage.prototype.onUserAction=function(_,e){var t=e.indexOfAudio(_);if(-1!=+t&&e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_SEARCH&&(!(e.getOwnerId()===vk.id&&t>=0&&t<e.getLocalFoundCount())&&e.getSearchParams())){var i=e.getSearchParams();i.globalQuery&&uiSearch.saveHistorySearch(this.searchInputEl,i.globalQuery,_.ownerId,_.id,e.getTotalCount(),e.getTotalCountHash())}},AudioPage.prototype._updateFriendsList=function(_,e,t){if(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.trim)(_),this._friendSearchInProgress=!1,_){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_friends_list",this._els.pageContainer),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.se)('<div class="audio_friends_list _audio_friends_list" style="">'+_+"</div>");t&&(this._shownFriends=[]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domPN)(i).appendChild(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.re)(i)}},AudioPage.prototype.shareAudio=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.shareAudio(!1,_)},AudioPage.prototype.showStatusTooltip=function(_){this.statusTT||(this.statusTT=!0,ajax.post("al_audio.php?act=status_tt",{},{onDone:(e,t)=>{this.statusTT=new ElementTooltip(_,{content:t,width:250,offset:[1,14],elClassWhenShown:"audio_status_tt_shown",id:"audio_status_tt",onFirstTimeShow:function(_){this.sb=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_28__.default((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_status_wrap",_),{global:!0})},onShow:function(){setTimeout(function(){this.statusTT.sb.update()}.bind(this),0)}.bind(this)}),cur._onStatusExportBtn&&(this.statusTT.show(),this.statusTT.sb.update())},onFail:()=>!0}))},AudioPage.prototype.isLayer=function(){return this._data.isLayer},AudioPage.prototype.isPodcastPage=function(){return!this.isLayer()&&!!this._data.podcastPage},AudioPage.prototype.destroy=function(){this._trackSlider&&this._trackSlider.destroy(),this._volumeSlider&&this._volumeSlider.destroy(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window,"scroll",this._ev_onScroll)},AudioPage.prototype.getPageCurrentPlaylist=function(){return this._pagePlaylist},AudioPage.prototype.clearCurrentPlaylist=function(){if(this.isLayer()){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)();_.deleteCurrentPlaylist(),this.updateCurrentPlayingInfo(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)().getPlaylistQueue().clean();var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_tab__current",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(e,"unshown"),"current"===this.getCurrentSection()&&(uiTabs.goTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_section_tab__all",this._els.pageContainer)),null,!0),this.updateShuffleButton(),this.updateCurrentPlayingInfo(),this.togglePodcast(!1),this.toggleArticleTts(!1)),this._initPlayer(!0);var t=_.getPlaylistsByType(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_MY).find((_=>_.getAudiosList().length)),i=t&&t.getAudiosList()[0];if(i&&(this._readyAudio=i,this._initPlayer(!0)),cur.audioPage){cur.audioPage._readyAudio=i,cur.audioPage._initPlayer(!0);try{var o=cur.audioPage._data.sectionData[cur.audioPage._currentSection].title;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setDocumentTitle)(o)}catch(_){}}this.updateStatusExport(),this.updateLayerHeight()}},AudioPage.prototype.setTooltipTitle=function(_){if(!_.titleSet){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_title_performer",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_title_song",_);(e.scrollWidth>e.clientWidth||t.scrollWidth>t.clientWidth)&&_.setAttribute("title",_.innerText),_.titleSet=!0}},AudioPage.prototype._initPlayer=function(_){var e=this,t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)(),i=this._els.pageContainer,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player",i),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_title",o),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_title_performer",o),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_title_song",o),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_title_song_title",o),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_title_song_subtitle",o),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_duration",o),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player__cover",o),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player_play",o),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_play_blind_label",c),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("_audio_page_player_add",o),p=void 0;function P(_){if(a)if(t.ads.isPlaying())a.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_audio_ad"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(l,"display","none"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(o,"audio_song_is_explicit",!1);else{var i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAudioPerformers(_);_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(l,"display","block"),a.innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player2")?i:_.performer,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast(_)?n.innerHTML=`<a href="/podcast${_.fullId}" onclick="return showPodcast(this, '${_.fullId}', event, 'player');" class="audio_player_podcast_title">${_.title}</a>`:n.innerHTML=_.hasTrackPage?`<a class="audio_page_player_title_link" href="/audio${_.trackPageId}">${_.title}</a>`:_.title,r.innerHTML=_.subTitle?_.subTitle:"",_.coverUrl_p?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(u,"background-image","url("+_.coverUrl_p+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(u,"background-size","cover")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(u,"background-image",null),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(u,"background-size","")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(o,"audio_title_long_performer",_.isLongPerformer),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(o,"audio_song_is_explicit",_.isExplicit),!e.isLayer()&&t.getCurrentAudio()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(t.getCurrentAudio()).fullId==_.fullId&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setDocumentTitle)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_27__.stripHTML)(_.performer+" — "+_.title))),clearTimeout(window.pageSetTitleTimer)),l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(l,"display","none"),a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(a,"display","none"),requestAnimationFrame((()=>{var _=t.ads.isPlaying()?"none":"block";l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(l,"display",_),a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(a,"display","block")}))}}function b(_,e){return e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.intval)(e),AudioPlayer.getDurationType()&&1!=_?"-"+(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_17__.formatTime)(Math.round(e-_*e)):(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_17__.formatTime)(Math.round(_*e))}function g(){if(e._trackSlider){var _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(t.getCurrentAudio()||e._readyAudio);if(_){var i;i=e.getOwnerId()<0&&e.canAddToGroup()?_.ownerId!=e.getOwnerId():_.ownerId!=vk.id,p!==i&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggle)(E,i),p=i);var o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAddRestoreInfo();_&&o[_.fullId]&&"added"===o[_.fullId].state||_.ownerId===vk.id?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(E,"audio_player_btn_added"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(E,"audio_player_btn_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(E,"no_transition"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClassDelayed)(E,"no_transition"),e.updateRepeatButton()}}}if(!this._trackSlider){var O,D,M=(null==(O=t.ads)?void 0:O.isPlaying())?t.ads.getCurrentProgress():t.getCurrentProgress(),m=(null==(D=t.ads)?void 0:D.isPlaying())?0:t.getCurrentBuffered(),C=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_track_slider",o),w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_page_player_volume_slider",o);C&&(this._trackSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_29__.default(C,{value:M,backValue:m,size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:_=>{var e=t.getCurrentAudio()||this._readyAudio;return e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(e),(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_17__.formatTime)(Math.round(_*(e?e.duration:0)))},onEndDragging:_=>{var e=t.getCurrentAudio()||this._readyAudio;(e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(e))&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast(e)&&t.podcastSetActionRef(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.PodcastsLogs.ACTION_SEEK,"",o),t.seek(_)}}),t.ads.isPlaying()&&(this._trackSlider.toggleAdState(!0),this.toggleRemoveAdsLink(!0))),w&&(this._volumeSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_29__.default(w,{value:t.getVolume(),size:1,hintClass:"audio_player_hint",log:!0,formatHint:_=>Math.round(100*_)+"%",onChange:_=>{t.setVolume(_)}})),[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.MUSIC_PLAYLISTS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.MUSIC_OWNERS_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.MUSIC_OWNERS_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.CURATOR_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.CURATOR_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.PLACEHOLDER_REMOVE].forEach((_=>t.on(this,_,((e,t)=>{this.catalogController&&this.catalogController.emitEvent(_,t)})))),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.MUSIC_PLAYLISTS_ADD,((_,e)=>{var t=this._data,i=t.playlists,o=t.playlistsIndex;Array.isArray(i)&&i.find((_=>_.id===e.id&&_.owner_id===e.owner_id))||(i&&(i.unshift(e),o&&o.add(e)),this.updatePlaylistsCounter(vk.id))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.AD_STARTED,(()=>{this.toggleRemoveAdsLink(!0),this._trackSlider&&(this._trackSlider.toggleAdState(!0),this._trackSlider.setBackValue(0))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.AD_COMPLETED,(()=>{this.toggleRemoveAdsLink(!1),this._trackSlider&&this._trackSlider.toggleAdState(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.START_LOADING,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!0)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.CAN_PLAY,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.ADDED,((_,e)=>{(_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(_))&&_.fullId==e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(E,"audio_player_btn_added")})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.REMOVED,((_,e)=>{(_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(_))&&_.fullId==e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(E,"audio_player_btn_added")})),t.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.PLAY_REQUESTED],((_,e,i)=>{delete this._readyAudio,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(o,"audio",_),g(),_&&P(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(c,"audio_playing"),e&&!cur.audioStartReadyAudio&&(this._trackSlider&&this._trackSlider.setBackValue(0),!t.ads.isPlaying()&&d&&(d.innerHTML=b(0,_?_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(_).duration:0)),s&&(s.setAttribute("title",""),s.titleSet=!1)),h&&(h.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_audio_play")),this.updateCurrentPlayingInfo(),this.updateShuffleButton(),this.updateFaveButton()})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.PAUSE,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(c,"audio_playing"),h&&(h.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_audio_play"))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.STOP,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(c,"audio_playing"),h&&(h.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_37__.getLang)("global_audio_play"))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.BUFFERED,((_,e)=>{this._trackSlider&&this._trackSlider.setBackValue(e)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.VOLUME,((_,e)=>{this._volumeSlider&&this._volumeSlider.setValue(e,!0)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.ENDED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.UPDATE,((_,e)=>{_&&P(_),t.ads.isPlaying()||_&&e&&d&&(d.innerHTML=b(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(_).duration))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.PROGRESS,((_,e,t)=>{this._trackSlider&&(this._trackSlider.toggleLoading(!1),this._trackSlider.setValue(e)),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_42__.isUndefined)(t)||isNaN(t)||!d||(d.innerHTML=b(e,t))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.FAILED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_22__.events.CURRENT_CHANGED,(()=>{var _=t.getCurrentAudio()||this._readyAudio;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(this._els.player,"audio",JSON.stringify(_)),P(_),this.togglePodcast(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast(_),_),this.toggleArticleTts(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isArticleTts(_)),this._trackSlider&&this._trackSlider.setValue(0)}))}var A=t.getCurrentAudio()||this._readyAudio;A&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.domData)(o,"audio",JSON.stringify(A)),P(A),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(c,"audio_playing",t.isPlaying()),d&&(d.innerHTML=b(1,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(A).duration)),_&&this._trackSlider&&(this._trackSlider.setValue(0),this._trackSlider.setBackValue(0),this._trackSlider.toggleLoading(!1))),g();var y=t.getCurrentAudio()||this._readyAudio;this.togglePodcast(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isPodcast(y),y),this.toggleArticleTts(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isArticleTts(y)),this.isLayer()||this._initFixedPlayer()},AudioPage.prototype._initFixedPlayer=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getSize)(this._els.playerWrap);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(this._els.playerWrap,{width:_[0],height:_[1]});var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getSize)(this._els.player);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.setStyle)(this._els.player,{width:e[0],height:e[1]});var t,i,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getSize)("page_header_wrap")[1],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getXY)(this._els.contentBlock)[1],a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getXY)(this._els.playerWrap)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.getSize)(this._els.playerWrap)[1]-o,l=!1,n=()=>{var _=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_20__.scrollGetY)(),e=_>s;if(_<a&&(t||l))return clearTimeout(t),clearTimeout(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(this._els.player,"audio_page_player_fixed"),void(l=t=!1);e&&!l&&(clearTimeout(t),t=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(this._els.player,"audio_page_player_fixed"),i=setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.addClass)(this._els.player,"audio_page_player_fixed_shown"))),l=!0),!e&&l&&(clearTimeout(t),t=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),t=setTimeout((()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.removeClass)(this._els.player,"audio_page_player_fixed"),t=!1}),250),l=!1)};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(window,"scroll",n),cur.destroy.push((()=>{n&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(window,"scroll",n)}))},AudioPage.prototype.togglePlayerPlay=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.getAudioPlayer)();if(e.isPlaying()){var t=e.getCurrentAudio();t&&e.podcastSetActionRef(t,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.PodcastsLogs.ACTION_PAUSE,"",_),e.pause()}else{var i=this.getPageCurrentPlaylist(),o=e.getCurrentPlaylist(),s=e.getCurrentAudio(),a=e.getPlaylistQueue(),l=s||this._readyAudio,n=()=>{if(l)if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.isClaimedAudio(l)){l=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.audioTupleToAudioObject(l);var t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.getAudioExtra(l).claim;(0,_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_30__.showAudioClaimWarning)(l,t)}else{var s;s=o&&-1!==a.indexOfAudio(l)?o:i&&-1!==i.indexOfAudio(l)?i:new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_26__.AudioPlaylist.TYPE_TEMP,vk.id),delete this._readyAudio,cur.audioStartReadyAudio=!0,e.podcastSetActionRef(l,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_40__.AudioUtils.PodcastsLogs.ACTION_PLAY,"",_),e.play(l,s)}};!l&&i?a.getAudioAt(0).then((_=>{l=_,n()})):n()}},AudioPage.prototype.promoAlbumSlideInit=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_promo");if(!this.isLayer()&&_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_promo__items",_);if(e&&!(e.children.length<=1)){this.promoAlbumSlideAutoStart(e);var t=()=>this.promoAlbumSlideAutoStop(),i=()=>this.promoAlbumSlideAutoStart(e);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(_,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.addEvent)(_,"mouseleave",i),window.cur&&cur.destroy.push((()=>{this.promoAlbumSlideAutoStop(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(_,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_21__.removeEvent)(_,"mouseleave",i)}))}}},AudioPage.prototype.promoAlbumSlideAutoStart=function(_){window.cur&&(cur._promoAlbumSlideTO=setTimeout((()=>this.promoAlbumSlide(_,1)),SLIDER_TIMEOUT))},AudioPage.prototype.promoAlbumSlideAutoStop=function(){window.cur&&clearTimeout(cur._promoAlbumSlideTO)},AudioPage.prototype.promoAlbumSlide=function(_,e){var t=vk.rtl?e>0?-1:1:e<0?-1:1,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.gpeByClass)("audio_promo",_);if(i){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.geByClass1)("audio_promo__items",i);if(o&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(o,"sliding")){this.promoAlbumSlideAutoStop();var s=o.scrollLeft,a=o.offsetWidth,l=o.children,n=l.length,r=_=>vk.rtl?o.scrollWidth-_*a-a:_*a;if(l.length>1){this.promoAlbumSlideAutoStart(_);var d=!1,u=null,c=!1,h=Math.round(s/a);(h+=t)>=n||h<0?(d=l[0].cloneNode(!0),o.appendChild(d),h>=n?(c=!0,u=r(h)):h<0&&(o.scrollLeft=r(n),u=r(h=n-1))):u=r(h),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(o,"sliding",!0),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_15__.animate)(o,{scrollLeft:u},{duration:500,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_15__.Fx.Transitions.swiftOut,onComplete:()=>{c&&(o.scrollLeft=r(0)),d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.re)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.data)(o,"sliding",!1)}})}}}},AudioPage.prototype.toggleRemoveAdsLink=function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_31__.toggleClass)(this._els.player,"audio_page_player_show_remove_ads",!!_)}},87142:(_,e,t)=>{"use strict";t.d(e,{default:()=>r});var i=t(3834),o=t(82452),s=t(15544),a=t(95724),l=t(49535);function n(_,e,t){if((0,a.isObject)(e)?t=e:this._dragElClass=e,this.options=(0,a.extend)({dragThreshold:n.DRAG_THRESHOLD_DIST},t),this._contEl=(0,s.ge)(_),this._contEl){this._excludedCount=0;for(var i=0;i<this._contEl.children.length;i++)this._contEl.children[i].getAttribute("nodrag")&&this._excludedCount++;(0,l.addEvent)(this._contEl,"mousedown",this._ev_mousedown_handler=this._onMouseDown.bind(this)),(0,s.setStyle)(this._contEl,"position","relative"),this._inited=!0,this._updateScrollbar=this._initUpdaterScrollbar()}}n.AUTO_SCROLL_DY=10,n.DRAG_THRESHOLD_DIST=0,n.AUTO_SCROLL_DISTANCE_THRESHOLD=300,n.AUTO_SCROLL_GAP=300,n.prototype.destroy=function(){this._inited&&(this._inited=!1,this._deinitEvents(!0))},n.prototype._getParentDragItemEl=function(_){for(var e,t=_;t&&(e=(0,s.domPN)(t))!==this._contEl;)t=e;return t===this._curPlaceholderEl&&(t=null),t},n.prototype._onKey=function(_){_.keyCode===l.KEY.ESC&&this.isCurrentlyDragging()&&this._onMouseUp()},n.prototype._onMouseDown=function(_){if(!(this._disabled||0!=_.button||this._curDragEl||(0,s.attr)(_.target,"nodrag")||this._dragElClass&&!(0,s.domClosest)(this._dragElClass,_.target))){for(var e=_.target;e&&e!==window.document;){if((0,a.intval)((0,s.domData)(e,"nodrag")))return;e=(0,s.domPN)(e)}var t=this._getParentDragItemEl(_.target);if(t&&!(0,s.attr)(t,"nodrag")&&((0,s.re)((0,s.geByClass1)("ui_gridsorter_placeholder"),this._contEl),this._contInfo=this._contInfo||{prevSize:(0,s.getSize)(this._contEl)},this._ensureGridIsActual(),!(this._grid.length<=1))){var i=window.getComputedStyle(t),o=(0,s.getXY)(t);this._initial={candidateEl:t,x:_.clientX,y:_.clientY,itemMargin:{x:parseInt(i.marginLeft),y:parseInt(i.marginTop)},shift:{x:_.pageX-o[0],y:_.pageY-o[1]}},(0,l.addEvent)(document,"mousemove",this._ev_mousemove_handler=this._onMouseMove.bind(this)),(0,l.addEvent)(document,"mouseup",this._ev_mouseup_handler=this._onMouseUp.bind(this)),(0,l.addEvent)(document,"keydown",this._ev_keydown_handler=this._onKey.bind(this)),cur.cancelClick=!1,(0,l.cancelEvent)(_)}}},n.prototype._dist=function(_){return Math.abs(_.clientX-this._initial.x)+Math.abs(_.clientY-this._initial.y)},n.prototype._onMouseUp=function(_){var e=this._curDragEl,t=!_;if(this._curDragEl){this._curDragEl=null,(0,s.removeClass)(e,"ui_gridsorter_moveable_notrans"),this._curOverCell||(this._curOverCell={el:this._curPlaceholderEl,pos:(0,s.getXY)(this._curPlaceholderEl),size:(0,s.getSize)(this._curPlaceholderEl)});var i=this._curOverCell.pos,o=this._curOverCell.el,a=this._grid[this._curDragCellIndex],n=a&&a.size;(0,s.gpeByClass)("_ape_item_list",e)&&(i[0]+=20,i[1]+=20),n&&this._isShiftToLeft&&(i[1]-=n[1]-this._curOverCell.size[1]),setTimeout((()=>{if(t){for(var _=0,o=this._grid.length;_<o;_++){var s=this._grid[_];s.dirty&&this._setPos(s.el,{left:0,top:0})}this._setPos(e,this._initialCurDragPos)}else this._setPos(e,{left:i[0],top:i[1]})})),setTimeout((()=>{if((0,s.re)(this._curPlaceholderEl),(0,s.removeClass)(this._contEl,"ui_gridsorter_cont"),this.options.dragCls&&(0,s.removeClass)(e,this.options.dragCls),this._inited){var _;if(t){for(var i=this._grid.length,a=0;a<i;a++){var l=this._grid[a];l.dirty&&this._setPos(l.el,{left:null,top:null})}this._setPos(e,{left:null,top:null,width:null,height:null})}else{var n;_=this._isShiftToLeft?(0,s.domNS)(o):o,this._contEl.insertBefore(e,_);var r=-1,d=this._initial.hasInlineSize;this._setPos(e,{left:null,top:null}),d||(0,s.setStyle)(e,{width:null,height:null});for(var u=this._grid.length,c=0;c<u;c++){var h=this._grid[c];(h.dirty||h.el===e)&&(this._setPos(h.el,{left:null,top:null}),d||(0,s.setStyle)(h.el,{width:null,height:null}),h.pos=this._calcElementPos(h.el),h.dirty=!1),h.el===e?n=c:h.el===o&&(r=c)}if(r>=0){var E=this._grid.splice(n,1);this._grid.splice(r,0,E[0])}}(0,s.removeClass)(e,"ui_gridsorter_moveable"),this._curOverCell=this._curPlaceholderEl=null,t&&this.update(),this.options.onDragFinish&&this.options.onDragFinish(e),o!==e&&!t&&this.options.onReorder&&this.options.onReorder(e,_,(0,s.domPS)(e))}}),210),_&&this._dist(_)>5&&((0,l.cancelEvent)(_),cur.cancelClick=!0)}this._updateScrollbar(),this._deinitEvents(),e&&this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,e),t||e&&this._overEl&&this.options.onDragDrop&&(t=this.options.onDragDrop(this._overEl,e)),this._overEl=null},n.prototype._deinitEvents=function(_){_&&(this._onMouseUp(),(0,l.removeEvent)(this._contEl,"mousedown",this._ev_mousedown_handler)),clearTimeout(this._autoScrollTO),this._autoScrollTO=!1,this._ev_mousemove_handler&&(0,l.removeEvent)(document,"mousemove",this._ev_mousemove_handler),this._ev_mouseup_handler&&(0,l.removeEvent)(document,"mouseup",this._ev_mouseup_handler),this._ev_keydown_handler&&(0,l.removeEvent)(document,"keydown",this._ev_keydown_handler)},n.prototype._setPos=function(_,e){this.options.noPosTransform||!this._hasTranslateFeauture&&!(this._hasTranslateFeauture=window.getComputedStyle(_).getPropertyValue("transform"))?(0,s.setStyle)(_,(0,a.extend)({transform:null},e)):null===e.left||null===e.top?(0,s.setStyle)(_,{transform:null,top:null,left:null}):(0,s.setStyle)(_,{transform:"translate("+e.left+"px, "+e.top+"px)",top:null,pos:null})},n.prototype._recalc=function(){var _=this._curDragEl,e=this._curOverCell.el;if(this._initGrid(),e!==_){for(var t=0,i=!1,o=!1,s=this._grid.length,a=0;a<s;a++){var l=this._grid[a];if(l.el===_){i=!0;break}if(l.el===e){i=!1;break}}this._isShiftToLeft=i;for(var n=i?0:this._grid.length-1,r=i?this._grid.length:-1,d=i?1:-1,u=[0,0];n!==r;n+=d){var c=this._grid[n];if(2!==t)if(c.el!==_){if(c.el===e&&t++,1===t||2===t){var h=0,E=0;i?(h=o.pos[0]+u[0],E=o.pos[1]+u[1],u[0]+=c.size[0]-o.size[0],u[1]+=c.size[1]-o.size[1]):(u[0]+=o.size[0]-c.size[0],u[1]+=o.size[1]-c.size[1],h=o.pos[0]+u[0],E=o.pos[1]+u[1]),this._setPos(c.el,{left:h-c.pos[0],top:E-c.pos[1]}),c.dirty=!0}else c.dirty&&(this._setPos(c.el,{left:null,top:null}),c.dirty=!1);o=c}else t++,o=c;else c.dirty&&(this._setPos(c.el,{left:null,top:null}),c.dirty=!1),o=c}}else for(var p=this._grid.length,P=0;P<p;P++){var b=this._grid[P];b.el!==_&&b.dirty&&(b.dirty=!1,this._setPos(b.el,{left:null,top:null}))}},n.prototype.disable=function(){this._disabled=!0},n.prototype.enable=function(){this._disabled=!1,this._initGrid(!0)},n.prototype.update=function(){this._disabled||this._initGrid(!0)},n.prototype._ensureGridIsActual=function(){this._initGrid()},n.prototype._needGridUpdate=function(){if(!this._grid)return 1;this._contInfo.prevSize=this._contInfo.prevSize||(0,s.getSize)(this._contEl);var _=0,e=this._contEl.children.length-this._excludedCount-(0,a.intval)(!!this._curPlaceholderEl);if(e!==this._grid.length)_=e>this._grid.length?2:1,this._contInfo.prevSize=(0,s.getSize)(this._contEl);else{var t=(0,s.getSize)(this._contEl),i=this._contInfo.prevSize;(Math.abs(i[0]-t[0])>5||Math.abs(i[1]-t[1])>5)&&(_=1),this._contInfo.prevSize=t}return _},n.prototype._initGrid=function(_){var e=_?1:this._needGridUpdate();if(e){1===e&&(this._grid=[],this._contInfo&&(delete this._contInfo.pos,delete this._contInfo.size));var t=this._grid?this._grid[this._grid.length-1]:null;this._grid=this._grid||[];var i,o=!!t,a=this._contEl.children;if(a.length)for(var l=this._getItemMargins(),n=this._curDragEl?this._grid.length:0,r=a.length;n<r;n++){var d=a[n];t&&d===t.el?o=!1:o||d===this._curPlaceholderEl||d.getAttribute("nodrag")||((i=(0,s.getSize)(d))[0]+=l[0],i[1]+=l[1],this._grid.push({el:d,size:i,pos:this._calcElementPos(d)}))}}},n.prototype._getRelativeMousePos=function(_){var e=this._getContPos(),t=this._getContShift();return{left:_.clientX-e[0]-t[0],top:_.clientY-e[1]-t[1]}},n.prototype._updateDraggablePosition=function(_){if(this._curDragEl){var e=this._getRelativeMousePos(_),t=this._getItemShift(),i=this._getContShift(),o=this._getContSize(),a=e.top-this._initial.shift.y-t[1]+i[1];this.options.limitBottomMove&&(a=Math.min(a,o[1]+30)),(0,s.hasClass)(this._contEl,"_ape_item_list")&&(a+=this._contEl.scrollTop),this._setPos(this._curDragEl,{left:e.left-this._initial.shift.x-t[0]+i[0],top:a}),window.AudioPage&&window.AudioPage.onUpdateDraggablePosition&&window.AudioPage.onUpdateDraggablePosition()}},n.prototype._getContShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.shift){var _=window.getComputedStyle(this._contEl);this._contInfo.shift=[parseFloat(_.paddingLeft),parseFloat(_.paddingTop)]}return this._contInfo.shift},n.prototype._getContSize=function(){return this._contInfo=this._contInfo||{},this._contInfo.size=(0,s.getSize)(this._contEl),this._contInfo.size},n.prototype._getContPos=function(){return this._contInfo=this._contInfo||{},this._contInfo.pos=(0,s.getXY)(this._contEl),this._contInfo.pos[1]-=(0,i.scrollGetY)(),this._contInfo.pos},n.prototype._getItemShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemShift){var _=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemShift=[parseFloat(_.marginLeft),parseFloat(_.marginTop)]}return this._contInfo.itemShift},n.prototype._getItemMargins=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemMargins){var _=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemMargins=[parseFloat(_.marginLeft)+parseFloat(_.marginRight),parseFloat(_.marginTop)+parseFloat(_.marginBottom)]}return this._contInfo.itemMargins},n.prototype._calcElementPos=function(_){var e=this._getContShift(),t=this._getItemShift();return[_.offsetLeft-e[0]-t[0],_.offsetTop-e[1]-t[1]]},n.prototype.isCurrentlyDragging=function(){return!!this._curDragEl},n.prototype._initUpdaterScrollbar=function(){return(0,o.throttle)((_=>{var e=this.options.wrapNode||_,t=(0,s.data)(e,"sb");t&&t.update(!1,!0)}),500)},n.prototype._onMouseMove=function(_){var e=()=>this.options.wrapNode?this.options.wrapNode.scrollTop:(0,i.scrollGetY)(),t=_=>{this.options.wrapNode?this.options.wrapNode.scrollTop=_:(0,i.scrollToY)(_,0,!1,!0)};if(this._curDragEl){this._ensureGridIsActual(),!_&&(_={clientX:this._lastMousePos.x,clientY:this._lastMousePos.y}),this._lastMousePos={x:_.clientX,y:_.clientY},this._updateDraggablePosition(_);var o=this._getContSize(),a=this._getRelativeMousePos(_),n=!1;if((0,s.hasClass)(this._contEl,"_ape_item_list")&&(a.top+=this._contEl.scrollTop),a.left>0&&a.left<o[0]&&a.top>0&&a.top<o[1])for(var r=0,d=this._grid.length-1,u=50;u;){var c=r+Math.floor((d-r)/2),h=this._grid[c];if(a.left>h.pos[0]&&a.top>h.pos[1]&&a.left<h.pos[0]+h.size[0]&&a.top<h.pos[1]+h.size[1]){n=h;break}if(r===d)break;a.top<h.pos[1]||a.left<h.pos[0]&&a.top<h.pos[1]+h.size[1]?d=d===c?d-1:c:r=r===c?r+1:c,u--}else{for(var E,p,P,b=this._grid.length,g=999999,O=0;O<b;O++){var D=this._grid[O],M=(p=a.left-(D.pos[0]+D.size[0]/2))*p+(P=a.top-(D.pos[1]+D.size[1]/2))*P;g>M&&(g=M,E=D)}n=E}!n||this._curOverCell&&this._curOverCell.el===n.el||(this._curOverCell=n,this._recalc());var m,C,w,A,y=0;if(this.options.wrapNode)m=A=this.options.wrapNode,C=(0,s.getSize)(m),(w=(0,s.getXY)(m))[1]-=(0,i.scrollGetY)(),y=_.clientY;else{var v=window,f=document.documentElement,I=document.getElementsByTagName("body")[0],T=v.innerWidth||f.clientWidth||I.clientWidth,B=v.innerHeight||f.clientHeight||I.clientHeight;A=v.bodyNode,C=[T,B],w=[0,0],y=_.clientY}var L=Math.max(20,C[1]/10),R=w[1]+L-y,U=L-(w[1]+C[1]-y);if(U>0||R>0){var W=Math.min(1,R/L),K=Math.min(1,U/L);this._autoScrollTO||(this._autoScrollTO=setTimeout((()=>{this._autoScrollTO=!1;var _=e();t(_+16*(W>0?-W:K)),_!==A.scrollTop&&(this._updateScrollbar(A),this._onMouseMove())}),20))}if(this.options.onDragOverElClass){var S=_.target;(0,s.hasClass)(S,this.options.onDragOverElClass)||(S=(0,s.gpeByClass)(this.options.onDragOverElClass,S))?this._overEl!==S&&(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this.options.onDragEnter&&this.options.onDragEnter(S,this._curDragEl),this._overEl=S):(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this._overEl=null)}}else if(this._dist(_)>this.options.dragThreshold){this._curDragEl=this._initial.candidateEl;for(var k=this._grid.length,x=0;x<k;x++)if(this._grid[x].el===this._curDragEl){this._curDragCellIndex=x;break}this.options.dragCls&&(0,s.addClass)(this._curDragEl,this.options.dragCls);var H=(0,s.getSize)(this._curDragEl),F=(0,s.getXY)(this._curDragEl),N=window.getComputedStyle(this._curDragEl),z=this._getContPos();this._initial.hasInlineSize=!(!this._curDragEl.style.width&&!this._curDragEl.style.height),(0,s.setStyle)(this._curDragEl,{width:H[0],height:H[1]}),this._initialCurDragPos={left:F[0]-z[0],top:F[1]-z[1]-bodyNode.scrollTop},this._curPlaceholderEl=(0,s.ce)("div",{className:"ui_gridsorter_placeholder"}),(0,s.setStyle)(this._curPlaceholderEl,{width:H[0]+parseFloat(N.marginLeft)+parseFloat(N.marginRight),height:H[1]+parseFloat(N.marginTop)+parseFloat(N.marginBottom)}),this._contEl.insertBefore(this._curPlaceholderEl,this._curDragEl),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable"),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable_notrans"),(0,s.addClass)(this._contEl,"ui_gridsorter_cont"),this._onMouseMove(_),this._updateDraggablePosition(_),this.options.onDragStart&&this.options.onDragStart(this._curDragEl)}(0,l.cancelEvent)(_)};const r=n},17700:(_,e,t)=>{"use strict";t.d(e,{default:()=>r});var i=t(15544),o=t(86067),s=t(95724),a=t(49535),l=t(9720);function n(_,e){if(this.constructor!=n)throw new Error("Slider was called without 'new' operator");if(!_)throw new Error("No element was provided for Slider");_=(0,i.ge)(_),this.options=e||{size:1},this.options.backValue=this.options.backValue||0;var t=100*this.options.backValue,o=`<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> ${this.options.withBackLine?'<div class="slider_back" style="width:'+t+'%"></div>':""} <div class="slider_amount"></div> <div class="slider_handler"></div> </div>`;this._el=(0,i.ce)("div",{innerHTML:o,className:"slider",id:_.getAttribute("id")||""});for(var r=_.classList||[],d=this,u=0,c=r.length;u<c;u++)(0,i.addClass)(this._el,r[u]);(0,s.each)(this._el.attributes,(function(_,e){"id"==e.name&&"class"==e.name||d._el.setAttribute(e.name,e.value)})),_.parentNode.replaceChild(this._el,_),(0,i.data)(this._el,"slider",this),this._amountEl=(0,i.geByClass1)("slider_amount",this._el),this._handlerEl=(0,i.geByClass1)("slider_handler",this._el),this._slideEl=(0,i.geByClass1)("slider_slide",this._el),this._backEl=(0,i.geByClass1)("slider_back",this._el),this._progressEl=(0,i.geByClass1)("slider_loading_bar",this._el),this.options.color&&((0,i.setStyle)(this._amountEl,{backgroundColor:this.options.color}),(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.color})),this.options.handlerColor&&(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.handlerColor}),this.options.backColor&&(0,i.setStyle)(this._slideEl,{backgroundColor:this.options.backColor}),(0,i.addClass)(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=(0,l.debounce)(this._onValueChange,this.options.debounce)),e.formatHint&&((0,a.addEvent)(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),(0,a.addEvent)(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),(0,a.addEvent)(this._el,"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}n.prototype.toggleAdState=function(_){this._adState=!!_,(0,i.toggleClass)(this._el,"slider_ad_mode",!!_)},n.prototype.toggleAdMarker=function(_){_=!!_;var e=(0,i.geByClass1)("slider_ad_marker",this._el);if(_){if(!e){var t="onmouseover=\"showTooltip(this, {text: '"+(0,o.getLang)("global_audio_ad")+"', black: 1, shift: [16, 9, 10]})\"";e=(0,i.se)('<div class="slider_ad_marker_wrap" '+t+'><div class="slider_ad_marker"></div></div>'),(0,i.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")}}else(0,i.re)(e),delete this._width,(0,i.removeClass)(this._el,"slider_ad_marker_shown")},n.prototype.showAdMarker=function(_){var e=(0,i.se)('<div class="slider_ad_marker"></div>');(0,i.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")},n.prototype.isAdMode=function(){return(0,i.hasClass)(this._el,"slider_ad_mode")},n.prototype.setBlocked=function(_){this.blocked=_,(0,i.addClass)(this._el,"slider_blocked")},n.prototype.getBlocked=function(){return this.blocked},n.prototype.isBlocked=function(){return this.isAdMode()||this.getBlocked()},n.prototype.toggleLoading=function(_){_=!!_,(0,i.toggle)(this._progressEl,_),(0,i.setStyle)(this._progressEl,"opacity",_?1:0)},n.prototype.destroy=function(_){this.options.formatHint&&((0,a.removeEvent)(this._el,"mousemove",this._ev_onMouseOver),(0,a.removeEvent)(this._el,"mouseleave",this._ev_onMouseLeave),(0,a.removeEvent)(this._el,"mousedown",this._ev_onMouseDown)),(0,i.re)(this._el),(0,i.re)(this._currHintEl)},n.prototype._updateHint=function(_,e){this._currHintEl||(this._currHintEl=(0,i.se)('<div class="slider_hint" id="slider_hint"></div>'),this.options.hintClass&&(0,i.addClass)(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl)),this._width=this._width||(0,i.getSize)(this._slideEl)[0];var t=this._getPos(),o=Math.round(_.pageX-t[0]),s=this._width;if((o=e?Math.min(Math.max(0,o),s):o)>=0&&o<=s){var a=o/s;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,a):a;var l=(0,i.getSize)(this._currHintEl);(0,i.setStyle)(this._currHintEl,{left:this._slideEl.offsetLeft+o-l[0]/2,top:this._slideEl.offsetTop-l[1]-10}),!e&&this._toggleHint(!0)}else!e&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},n.prototype._toggleHint=function(_){this.isAdMode()&&(_=!1),(0,i.toggleClass)(this._currHintEl,"visible",_)},n.prototype._onMouseOver=function(_){n._currenSliderDrag||(0,i.hasClass)(this._el,"active")||this._updateHint(_)},n.prototype._onMouseLeave=function(_){(0,i.hasClass)(this._el,"active")||this._toggleHint(!1)},n.prototype._onMouseDown=function(_){0==_.button&&(delete cur._sliderMouseUpNowEl,this._adState||this.getBlocked()||((0,a.addEvent)(window,"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),(0,a.addEvent)(window,"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._width=(0,i.getSize)(this._slideEl)[0],this._onMouseMove(_),n._currenSliderDrag=this,(0,i.addClass)(this._el,"active"),(0,a.cancelEvent)(_)))},n.prototype._onMouseUp=function(_){cur._sliderMouseUpNowEl=this._el,(0,a.removeEvent)(window,"mousemove",this._ev_onMouseMove),(0,a.removeEvent)(window,"mouseup",this._ev_onMouseUp),clearTimeout(this._debounceto),this._onValueChange(),(0,i.removeClass)(this._el,"active"),n._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue)},n.prototype._onMouseMove=function(_){var e=this._getPos(),t=Math.max(_.pageX,e[0]);t=Math.min(t,e[0]+this._width),t-=e[0],this.setValue(t/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(_,!0),(0,a.cancelEvent)(_)},n.prototype._getPos=function(){return this._slidePos=(0,i.getXY)(this._slideEl)},n.LOGFBASE=35,n.prototype._logf=function(_){if(!this.options.log)return _;var e=n.LOGFBASE;return(Math.pow(e,_)-1)/(e-1)},n.prototype._unlogf=function(_){if(!this.options.log)return _;var e,t,i=n.LOGFBASE;return e=i,t=1+_*(i-1),Math.log(t)/Math.log(e)},n.prototype.setValue=function(_,e,t){if(!(0,i.hasClass)(this._el,"active")||t){var o=t?this._logf(_):_;if(this._currValue!=o){this._currValue=o;var s=t?_:this._unlogf(_);s=100*s+"%",(0,i.setStyle)(this._amountEl,{width:s}),(0,i.setStyle)(this._handlerEl,{left:s}),!e&&this._onValueChange()}}},n.prototype.setBackValue=function(_){(0,i.toggleClass)(this._backEl,"slider_back_transition",_>this._backValue),this._backValue=_;var e=100*_+"%";(0,i.setStyle)(this._backEl,{width:e})},n.prototype._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))};const r=n},32230:(_,e,t)=>{"use strict";t.r(e),t.d(e,{UiScroll:()=>d,default:()=>u});t(59357),t(51876);var i=t(26271),o=t(40906),s=t(95724),a=t(15544),l=t(49535),n=t(35676),r=t(79787);class d{constructor(_,e){if(!(_=(0,r.getScrollElement)(_)))throw new Error("uiScroll container is undefined");_.__uiScroll__&&_.__uiScroll__.destroy(),this.options=(0,s.extend)({global:!1,native:!1,theme:"default",reversed:!1,autoresize:!0,preserveEdgeBelow:!1,barMinHeight:30,preserveEdgeBelowThreshold:20,stopScrollPropagation:!0,stopScrollPropagationAlways:!1,minContentHeight:0,onmoreThreshold:null,hidden:!1,shadows:!1,scrollElements:[],onresize:null,onscroll:null,onscrollstart:null,onscrollstop:null,ondrag:null,ondragstart:null,ondragstop:null,onupdate:null,onmore:null,noForceReFlow:!1},e),this.options.native&&(this.options.shadows=!1),i.browser.mobile&&(this.options.stopScrollPropagation=!1),(0,o.isArray)(this.options.scrollElements)||(this.options.scrollElements=[]),this.removeEvents=[],this.removeElements=[],this.dragging=!1,this.dragged=!1,this.released=!0,this.noMore=!1,this.dragY=null,this.dragScroll=null,this.shadowTop=!1,this.shadowBottom=!1,this.unnecessary=!1,this.disabled=!1,this.stopped=!0,this.stoppedTimeout=null,this.fixSizeDefault=null,this.animation=null,this.barOuterHeight=null,this.barInnerHeight=null,this.currentFrame=null,this.blockerScrollTop=500,this.emitter=new EventEmitter,(0,s.isFunction)(this.options.onresize)&&this.emitter.addListener("resize",this.options.onresize),(0,s.isFunction)(this.options.onscroll)&&this.emitter.addListener("scroll",this.options.onscroll),(0,s.isFunction)(this.options.onscrollstart)&&this.emitter.addListener("scrollstart",this.options.onscrollstart),(0,s.isFunction)(this.options.onscrollstop)&&this.emitter.addListener("scrollstop",this.options.onscrollstop),(0,s.isFunction)(this.options.ondrag)&&this.emitter.addListener("drag",this.options.ondrag),(0,s.isFunction)(this.options.ondragstart)&&this.emitter.addListener("dragstart",this.options.ondragstart),(0,s.isFunction)(this.options.ondragstop)&&this.emitter.addListener("dragstop",this.options.ondragstop),(0,s.isFunction)(this.options.onupdate)&&this.emitter.addListener("update",this.options.onupdate),(0,s.isFunction)(this.options.onmore)&&this.emitter.addListener("more",this.options.onmore),this.el={container:_,overflow:(0,a.ce)("div",{className:"ui_scroll_overflow"}),outer:(0,a.ce)("div",{className:"ui_scroll_outer"},{margin:this.options.stopScrollPropagation?this.blockerScrollTop+"px 0":void 0}),inner:(0,a.ce)("div",{className:"ui_scroll_inner tt_noappend"}),shadowTop:(0,a.ce)("div",{className:"ui_scroll_shadow_top"}),shadowBottom:(0,a.ce)("div",{className:"ui_scroll_shadow_bottom"}),content:(0,a.ce)("div",{className:"ui_scroll_content clear_fix"}),barContainer:(0,a.ce)("div",{className:"ui_scroll_bar_container"}),barOuter:(0,a.ce)("div",{className:"ui_scroll_bar_outer"}),barInner:(0,a.ce)("div",{className:"ui_scroll_bar_inner"})},(0,a.data)(this.el.container,"ui-scroll",this);var t=(0,a.cf)(),n=["ui_scroll_container"];for((0,s.each)((0,o.isArray)(this.options.theme)?this.options.theme:(0,s.trim)(this.options.theme+"").split(/\s+/),(function(_,e){e&&n.push("ui_scroll_"+e+"_theme")})),(0,a.addClass)(this.el.container,n.join(" ")),this.options.hidden&&(0,a.addClass)(this.el.container,"ui_scroll_hidden");this.el.container.firstChild;)this.el.content.appendChild(this.el.container.firstChild);if(this.el.outer.appendChild(this.el.inner),this.el.inner.appendChild(this.el.content),this.options.stopScrollPropagation?(this.el.blocker=(0,a.ce)("div",{className:"ui_scroll_blocker"}),this.addEvent(this.el.blocker,"scroll",this.fixBlocker.bind(this),!0),this.el.blocker.appendChild(this.el.outer),this.el.overflow.appendChild(this.el.blocker)):this.el.overflow.appendChild(this.el.outer),t.appendChild(this.el.overflow),this.options.native?(0,a.addClass)(this.el.container,"ui_scroll_native"):(this.el.barOuter.appendChild(this.el.barInner),this.el.barContainer.appendChild(this.el.barOuter),t.appendChild(this.el.barContainer),this.options.shadows&&(this.el.overflow.appendChild(this.el.shadowTop),this.el.overflow.appendChild(this.el.shadowBottom)),i.browser.mobile||this.options.scrollElements.push(this.el.barContainer)),this.options.autoresize){var u=(0,r.addResizeSensor)(this.el.inner,this.resize.bind(this,!0)),c=(0,r.addResizeSensor)(this.el.overflow,this.resize.bind(this,!1));this.removeElements.push(u[0]),this.removeElements.push(c[0]),this.startResizeListening=function(){u[1](),c[1]()}}this.removeElements.push(this.el.overflow,this.el.barContainer),this.el.container.appendChild(t),this.options.reversed&&(this.el.outer.scrollTop=this.el.outer.scrollHeight),this.el.container.__uiScroll__=this.api={container:this.el.container,scroller:this.el.outer,content:this.el.content,emitter:this.emitter,ondragstart:this.dragstart.bind(this),ondragstop:this.dragstop.bind(this),ondrag:this.drag.bind(this),destroy:this.destroy.bind(this),disable:this.disable.bind(this,!0),enable:this.disable.bind(this,!1),scrollTop:this.scrollTop.bind(this,!0),scrollBottom:this.scrollBottom.bind(this,!0),scrollBy:this.scrollBy.bind(this),scrollIntoView:this.scrollIntoView.bind(this,!0),update:this.init.bind(this),updateAbove:this.updateAbove.bind(this),updateBelow:this.updateBelow.bind(this),data:{scrollTop:null,scrollBottom:null,scrollHeight:null,viewportHeight:null}},this.init();var h="onwheel"in this.el.outer?"wheel":void 0!==document.onmousewheel?"mousewheel":i.browser.mozilla?"MozMousePixelScroll":"DOMMouseScroll";return this.addEvent(this.el.container,h,function(_){this.animation&&this.animation.stop(),!this.disabled&&this.options.stopScrollPropagation&&(this.unnecessary?this.options.stopScrollPropagationAlways&&(0,l.cancelEvent)(_):this.isScrollEventUnused(_)?(0,l.cancelEvent)(_):(0,l.stopEvent)(_))}.bind(this),!this.options.stopScrollPropagation),this.options.native||this.addEvent(this.el.barContainer,"mousedown",this.dragstart.bind(this)),(0,s.each)(this.options.scrollElements,function(_,e){this.addEvent(e,h,function(_){this.disabled||this.unnecessary||(this.scrollBy(d.scrollEventDelta(_)),!this.options.stopScrollPropagation&&this.isScrollEventUnused(_)||(0,l.cancelEvent)(_))}.bind(this))}.bind(this)),this.options.reversed&&this.addEvent(this.el.container,"mousedown touchstart pointerdown",function(_){this.released=!1,this.noMore=!0;var e=this.addEvent(document,"mouseup contextmenu touchend pointerup",function(_){(0,l.removeEvent)(document,"mouseup contextmenu touchend pointerup",e),this.released=!0,this.noMore&&this.stopped&&!this.dragging&&(this.noMore=!1,this.more())}.bind(this))}.bind(this)),this.addEvent(this.el.outer,"scroll",function(){this.update()&&(this.stopped?(this.stopped=!1,this.emitEvent("scrollstart")):this.options.native||!1!==this.stopped||(this.stopped=0,(0,a.addClass)(this.el.container,"ui_scroll_scrolled")),this.emitEvent("scroll"),this.stoppedTimeout&&clearTimeout(this.stoppedTimeout),this.stoppedTimeout=setTimeout(function(){this.stopped||(this.stopped=!0,this.options.native||(0,a.removeClass)(this.el.container,"ui_scroll_scrolled"),this.emitEvent("scrollstop"),this.noMore&&this.released&&!this.dragging&&(this.noMore=!1,this.more()))}.bind(this),200))}.bind(this)),this.api}init(){if(this.options.stopScrollPropagation&&this.fixBlocker(),!this.inited){if(!this.el.container.scrollWidth||this.disabled)return;this.fixSize(!0),this.options.autoresize&&this.startResizeListening(),this.options.global||cur.destroy.push(this.destroy.bind(this)),this.inited=!0}return this.update(!0),this.api}addEvent(_,e,t,i){return this.removeEvents.push([_,e,t]),(0,l.addEvent)(_,e,t,void 0,void 0,i?{passive:!0}:void 0),t}destroy(){if(this.disabled=!0,this.fixSize(),this.animation&&this.animation.stop(),this.moreTimeout&&clearTimeout(this.moreTimeout),this.dragstopHandler&&(0,l.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,l.removeEvent)(document,"mousemove",this.dragHandler),(0,s.each)(this.removeEvents,(function(_,e){l.removeEvent.apply(null,e)})),this.el.overflow.parentNode==this.el.container){for(var _=(0,a.cf)();this.el.content.firstChild;)_.appendChild(this.el.content.firstChild);this.el.container.appendChild(_)}return(0,a.removeData)(this.el.container,"ui-scroll"),this.el.container.className=this.el.container.className.replace(/\bui_scroll_.+?\b/g," "),(0,s.each)(this.removeElements,(function(_,e){(0,a.re)(e)})),this.el.container.scrollTop=this.api.data.scrollTop,delete this.el.container.__uiScroll__,this.api}updateAbove(_){if((0,s.isFunction)(_)){this.animation&&this.animation.stop();var e=this.el.outer.scrollHeight-this.el.outer.scrollTop-this.el.overflow.offsetHeight;_(),this.el.outer.scrollTop=this.el.outer.scrollHeight-this.el.overflow.offsetHeight-e}return this.api}updateBelow(_){if((0,s.isFunction)(_)){this.animation&&this.animation.stop();var e=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;_(),e&&this.scrollBottom(!1)}return this.api}fixBlocker(){i.browser.chrome&&!this.options.noForceReFlow&&this.forceReFlow(),this.el.blocker.scrollTop=this.blockerScrollTop}forceReFlow(){this.el.blocker.style.display="inline-block",this.el.blocker.offsetHeight,this.el.blocker.style.display=""}fixSize(_){this.options.native||(_&&null==this.fixSizeDefault&&(this.fixSizeDefault=this.el.container.style.width),(0,a.setStyle)(this.el.container,"width",_?(0,a.getSize)(this.el.container,!0)[0]||this.fixSizeDefault||"":this.fixSizeDefault||""))}emitEvent(_){this.disabled||this.inited&&this.emitter.emitEvent(_,[this.api])}static scrollEventDelta(_){var e=0,t=void 0!==_.deltaMode?_.deltaMode:"MozMousePixelScroll"==_.type?0:1;return"wheel"==_.type?e=_.deltaY:void 0!==_.wheelDeltaX&&void 0!==_.wheelDeltaY?(e=1/40*-_.wheelDeltaY,i.browser.mac&&i.browser.opera&&(e*=.1)):void 0!==_.wheelDelta?e=1/40*-_.wheelDelta:_.detail&&2===_.axis&&(e=_.detail),e*(1==t?15:2==t?450:1)}isScrollEventUnused(_){return d.scrollEventDelta(_)>0?!this.api.data.scrollBottom:!this.api.data.scrollTop}resize(_){if(!_&&this.options.preserveEdgeBelow){var e=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;this.update(!0)&&(this.emitEvent("resize"),e&&this.scrollBottom(),this.options.stopScrollPropagation&&!_&&this.fixBlocker())}else this.update(!0)&&(this.options.stopScrollPropagation&&!_&&this.fixBlocker(),this.emitEvent("resize"))}disable(_){return this.disabled=!!_,_?(this.animation&&this.animation.stop(),this.fixSize()):(this.fixSize(!0),this.options.stopScrollPropagation&&this.fixBlocker(),this.update(!0)),(0,a.toggleClass)(this.el.container,"ui_scroll_disabled",this.disabled),this.api}dragstart(_){if(!(this.disabled||this.dragging||this.options.native))return _||(_=window.event),this.dragging=!0,this.animation&&this.animation.stop(),this.options.reversed&&(this.noMore=!0),(0,l.addEvent)(document,"mouseup contextmenu",this.dragstartHandler=this.dragstop.bind(this)),(0,l.addEvent)(document,"mousemove",this.dragHandler=this.drag.bind(this)),this.dragScroll=this.options.reversed?this.api.data.scrollBottom:this.api.data.scrollTop,this.dragY=_.screenY,(0,l.cancelEvent)(_),this.emitEvent("dragstart"),this.api}dragstop(_){if(!this.disabled&&this.dragging&&!this.options.native){if(_||(_=window.event),this.dragging=!1,this.dragstopHandler&&(0,l.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,l.removeEvent)(document,"mousemove",this.dragHandler),(0,a.setStyle)(bodyNode,"cursor",""),(0,a.removeClass)(this.el.container,"ui_scroll_dragging"),this.dragged)this.noMore&&(this.noMore=!1,this.more());else{this.options.reversed&&(this.noMore=!0);var e=(_.pageY-(0,a.getXY)(this.el.barOuter)[1]-this.barInnerHeight/2)*(Math.max(this.options.minContentHeight,this.api.data.scrollHeight)-this.api.data.viewportHeight)/(this.barOuterHeight-this.barInnerHeight);this.scrollTop(!1,e,0,function(){this.noMore&&(this.noMore=!1,this.more())}.bind(this))}return this.dragged=!1,_&&"contextmenu"!==_.type&&(0,l.cancelEvent)(_),this.emitEvent("dragstop"),this.api}}drag(_){if(!this.disabled&&this.dragging&&!this.options.native){_||(_=window.event);var e=(_.screenY-this.dragY)*(this.api.data.scrollHeight/this.el.barOuter.scrollHeight);return this.el.outer.scrollTop=this.options.reversed?this.el.outer.scrollHeight-this.el.overflow.offsetHeight-this.dragScroll+e:this.dragScroll+e,this.dragged||(this.dragged=!0,(0,a.setStyle)(bodyNode,"cursor","pointer"),(0,a.addClass)(this.el.container,"ui_scroll_dragging")),(0,l.cancelEvent)(_),this.emitEvent("drag"),this.api}}scroll(_,e,t){return this.animation&&this.animation.stop(),this.el.outer.scrollTop==_&&this.update(!0),e?(e="number"!=typeof e||!isFinite(e)||e%1?300:Math.abs(e),this.animation=new n.Fx.Base({scrollTop:this.el.outer.scrollTop},{transition:n.Fx.Transitions.easeOutCubic,onStep:function(_){this.el.outer.scrollTop=_.scrollTop}.bind(this),duration:e,onComplete:(0,s.isFunction)(t)?t.pbind(this.api):void 0}).start({scrollTop:this.el.outer.scrollTop},{scrollTop:_})):(this.el.outer.scrollTop=_,(0,s.isFunction)(t)&&t(this.api)),this.api}scrollTop(_,e,t,i){if(_&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll((0,s.intval)(e),t,i)}scrollBottom(_,e,t,i){if(_&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollHeight-this.el.overflow.offsetHeight-(0,s.intval)(e),t,i)}scrollBy(_,e,t){if(!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollTop+(0,s.intval)(_),e,t)}scrollIntoView(_,e,t,i){if(_&&this.options.stopScrollPropagation&&this.fixBlocker(),(e=(0,r.getScrollElement)(e))&&e.compareDocumentPosition&&e.compareDocumentPosition(this.el.content)&Node.DOCUMENT_POSITION_CONTAINS){var o=(0,a.getXY)(e)[1],l=(0,a.getXY)(this.el.overflow)[1],n=(0,a.getSize)(e)[1];if(o<=l&&o+n>=l+this.api.data.viewportHeight||o>=l&&o+n<=l+this.api.data.viewportHeight)(0,s.isFunction)(i)&&(t?setTimeout(i.bind(this.api),0):i(this.api));else if(n>this.api.data.viewportHeight||o<l)this.scrollTop(!1,o-l+this.api.data.scrollTop-(this.options.shadows?(0,a.getSize)(this.el.shadowTop)[1]:0),t,i);else{var d=this.options.shadows?(0,a.getSize)(this.el.shadowBottom)[1]:0;this.scrollTop(!1,o-l+this.api.data.scrollTop+n-this.api.data.viewportHeight+d,t,i)}}return this.api}update(_){var e,t;this.el.container&&!this.el.container.updateScroll&&(this.el.container.updateScroll=this.update.bind(this,!1));var i=this.el.outer.scrollTop;if(this.inited&&!this.disabled&&(_&&(e=this.el.inner.offsetHeight,this.api.data.viewportHeight!==(this.api.data.viewportHeight=this.el.overflow.offsetHeight)||this.api.data.scrollHeight!==e)||this.api.data.scrollTop!==i)){if(_&&(this.api.data.scrollHeight=e),this.api.data.scrollTop=Math.max(0,Math.min(this.api.data.scrollHeight-this.api.data.viewportHeight,Math.max(0,i))),this.api.data.scrollBottom=Math.max(0,this.api.data.scrollHeight-this.api.data.scrollTop-this.api.data.viewportHeight),!this.options.native){if(!(t=(e=Math.max(this.options.minContentHeight,this.api.data.scrollHeight))<=this.api.data.viewportHeight)){var o=this.el.barOuter.offsetHeight;(_||this.barOuterHeight!==o)&&(this.barOuterHeight=o,this.barInnerHeight=Math.max(this.options.barMinHeight,this.barOuterHeight*this.api.data.viewportHeight/e),this.el.barInner.style.height=this.barInnerHeight+"px"),(0,r.nextFrame)((()=>{var _=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(e-this.api.data.viewportHeight);this.el.barInner.style.transform=`translateY(${_}px)`}))}this.options.shadows&&(this.shadowTop!=(this.api.data.scrollTop&&!t)&&(0,a.toggleClass)(this.el.container,"ui_scroll_shadow_top_visible",this.shadowTop=this.api.data.scrollTop&&!t),this.shadowBottom!=(this.api.data.scrollBottom&&!t)&&(0,a.toggleClass)(this.el.container,"ui_scroll_shadow_bottom_visible",this.shadowBottom=this.api.data.scrollBottom&&!t)),this.unnecessary!==t&&((0,a.toggleClass)(this.el.container,"ui_scroll_unnecessary",t),this.unnecessary=t,this.options.stopScrollPropagation&&this.fixBlocker(),t&&this.barInnerHeight&&this.barOuterHeight&&(0,r.nextFrame)(function(_){this.el.barInner.style.height=100*this.barInnerHeight/this.barOuterHeight+"%";var t=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(e-this.api.data.viewportHeight)*100/this.barInnerHeight;this.el.barInner.style.transform=`translateY(${t}%)`}.bind(this)))}return this.emitEvent("update"),(!this.options.reversed||i>=0)&&this.more(),!0}return!1}more(){var _=this.options.reversed?this.api.data.scrollTop:this.api.data.scrollBottom,e=null!==this.options.onmoreThreshold?this.options.onmoreThreshold:2*this.api.data.viewportHeight;!this.noMore&&_<=e&&this.emitEvent("more")}}d.addResizeSensor=r.addResizeSensor;const u=d},79787:(_,e,t)=>{"use strict";t.d(e,{nextFrame:()=>r,getScrollElement:()=>d,addResizeSensor:()=>u});var i,o=t(95724),s=t(15544),a=t(26271),l=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(_=>setTimeout(_,1)),n=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;function r(_){i&&n(i),i=l(_)}function d(_){return(0,o.isString)(_)&&"_"===_[0]?(0,s.geByClass1)(_):(0,s.ge)(_)}function u(_,e){if((_=d(_))&&(0,o.isFunction)(e)){if(a.browser.msie9||a.browser.opera&&a.browser.version<13){var t=!1,i=!1,l=(0,s.ce)("object",{type:"text/html",className:"ui_scroll_resize_object",data:"about:blank",onload:function(){i=!0,t&&p()}});function p(){if(!l.contentDocument)return setTimeout(p,100);l.contentDocument.defaultView.removeEventListener("resize",e),l.contentDocument.defaultView.addEventListener("resize",e),e()}return _.appendChild(l),_.__resizeSensor__=[l,function(){t=!0,i&&p()}]}var n=(0,s.ce)("div",{className:"ui_scroll_resize_sensor"}),r=(0,s.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_expand"}),u=(0,s.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_shrink"}),c=(0,s.ce)("div"),h=(0,s.ce)("div"),E=null;return r.appendChild(c),u.appendChild(h),n.appendChild(r),n.appendChild(u),_.appendChild(n),_.__resizeSensor__=[n,r.onscroll=u.onscroll=function(){var t=(_.offsetWidth||1e4)+10,i=(_.offsetHeight||1e4)+10;c.style.width=t+"px",c.style.height=i+"px",r.scrollLeft=t,r.scrollTop=i,u.scrollLeft=t,u.scrollTop=i,E!==(E=t+" "+i)&&e()}]}}},64054:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(75115),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21466),_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15544),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(416),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(95724),_web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(99392),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(49535),_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(27171),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(26271),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(87481),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(3834);function _extends(){return _extends=Object.assign||function(_){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(_[i]=t[i])}return _},_extends.apply(this,arguments)}var SEARCH_FOCUSED_CLASS="search_focused",uiSearch={destroy:function(_){var e=uiSearch.getFieldEl(_);uiSearch.stopEvents(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.removeData)(e)},getWrapEl:function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domClosest)("_wrap",_)},getFieldEl:function(_){return _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ge)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)("_field",_)?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domByClass)(uiSearch.getWrapEl(_),"_field")},stopEvents:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"eventHandlers")||[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.each)(e,(function(_,e){e.stop()}))},startEvents:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"eventHandlers")||[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.each)(e,(function(_,e){e.stop(),e.start()}))},init:function init(el,options){if(el&&(el=uiSearch.getFieldEl(el),el)){var wrapEl=uiSearch.getWrapEl(el),delayedInitOptions=!options&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(wrapEl,"init-options");if(delayedInitOptions){var evalScript="(function() { return "+delayedInitOptions+" })()";try{var _initOptions$suggeste,initOptions=eval(evalScript);(null==initOptions||null==(_initOptions$suggeste=initOptions.suggester)?void 0:_initOptions$suggeste.useCatalogSuggest)?setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(wrapEl,"init-options",null)),0):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(wrapEl,"init-options",null),uiSearch.init(el,initOptions)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_9__.logEvalError)(_,evalScript)}}else if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(el,"inited")){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(el,"inited",1);var onKeyDown=uiSearch.onKeyDown.pbind(el),onBuffer=function(_){if("input"===_.type&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__.browser.msie){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(el);if(e===((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(el,"prev-value")||""))return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(el,"prev-value",e)}setTimeout(uiSearch.onChanged.pbind(el,!1,_),0)};(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_3__.placeholderInit)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(el,"opts",options);var onFocus=_=>{if(options.focusedModifierTargetSelector){var e=document.querySelector(options.focusedModifierTargetSelector);null==e||e.classList.add(SEARCH_FOCUSED_CLASS)}null==options.onFocus||options.onFocus(_)},onBlur=_=>{if(options.focusedModifierTargetSelector){var e=document.querySelector(options.focusedModifierTargetSelector);null==e||e.classList.remove(SEARCH_FOCUSED_CLASS)}null==options.onBlur||options.onBlur(_)},mainHandler;if(options.suggester){var _options$suggester;options.suggester.useCatalogSuggest=!!(null==options||null==(_options$suggester=options.suggester)?void 0:_options$suggester.useCatalogSuggest),options.suggester.useCatalogSuggest||(options.suggester.instance=new Suggester(el,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(options.suggester,{type:options.suggester.type,historyItems:!!options.suggester.history&&options.suggester.historyItems,onSearch:function(_,e,t,i,o){_||(options.allowFiltersForEmpty||uiSearch.removeAllFilters(el),uiSearch.hideProgress(el)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.toggleClass)(wrapEl,"ui_search_field_empty",!_),options.onChange&&options.onChange.call(el,_,e,t,i,o)}}))),mainHandler={start:function(){onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(el,"focus",onFocus)},stop:function(){onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent)(el,"focus",onFocus)}}}else{var searchBtn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("_ui_search_button_search",wrapEl),onBtnClick=function(_){uiSearch.onEnter(el,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.elfocus)(el)};mainHandler={start:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(el,"keydown",onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(el,"paste cut input",onBuffer),onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(el,"focus",onFocus),searchBtn&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(searchBtn,"click",onBtnClick)},stop:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent)(el,"keydown",onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent)(el,"paste cut input",onBuffer),onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent)(el,"focus",onFocus),searchBtn&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent)(searchBtn,"click",onBtnClick)}}}if(mainHandler.start(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(el,"eventHandlers",[mainHandler]),options.params){var _options$suggester2,_options$suggester3,content=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(options.params.html)),newOptions=(null==options||null==(_options$suggester2=options.suggester)?void 0:_options$suggester2.useCatalogSuggest)?{forceSide:"bottom",setPos:()=>({left:"auto",top:"52px"})}:{};options.paramsTooltip=new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_5__.ElementTooltip((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("_ui_search_params_button",wrapEl),_extends({appendTo:wrapEl,content,autoShow:!1,customShow:!0,shift:options.params.shift?options.params.shift:0,offset:[0,-2]},newOptions)),options.paramsTooltip.build(),(null==options||null==(_options$suggester3=options.suggester)?void 0:_options$suggester3.useCatalogSuggest)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(options.paramsTooltip._ttel,{right:0}),setTimeout((function(){(function initScript(){try{eval(options.params.script)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_9__.logEvalError)(_,options.params.script)}}).call(el)}))}options.fixed&&uiSearch.setFixed(el),options.noAutoDestroy||cur.destroy.push(uiSearch.stopEvents.pbind(el)),uiSearch.initFilters(el,options),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.isFunction)(options.onInit)&&options.onInit(el,options)}}},getOptions:function(_){var e;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)(_,"_field"))e=_;else{var t=uiSearch.getWrapEl(_);e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("_field",t)}return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(e,"opts")||{}},toggleParameters:function(_){var e=uiSearch.getOptions(_);e.paramsTooltip&&e.paramsTooltip.toggle()},hideParameters:function(_){var e=uiSearch.getOptions(_);e&&e.paramsTooltip&&e.paramsTooltip.hide()},saveHistorySearch:function(_,e,t,i,o,s){e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(_));var a=uiSearch.getOptions(_);a.suggester&&a.suggester.instance&&a.suggester.instance.saveHistoryItem(e,t,i,o,s)},onEnter:function(_,e){_=uiSearch.getFieldEl(_);var t=uiSearch.getOptions(_),i=_.getValue?_.getValue():_.value;return t.onEnter&&t.onEnter(_,i,e),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(e)},onKeyDown:function(_,e){if(cur.preventInputActions&&-1!=[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.KEY.RETURN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.KEY.ESC,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.KEY.DOWN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.KEY.UP].indexOf(e.keyCode))return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(e);if(e.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.KEY.RETURN)return uiSearch.onEnter(_,e);if(e.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.KEY.ESC){var t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(_);return uiSearch.reset(_,!1,e),!t||(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.cancelEvent)(e)}setTimeout.pbind(uiSearch.onChanged.pbind(_,!1,e),0)},onChanged:function(_,e,t){_=uiSearch.getFieldEl(_);var i=uiSearch.getOptions(_),o=uiSearch.getWrapEl(_),s=_.getValue?_.getValue():_.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.toggleClass)(o,"ui_search_field_empty",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(s)),s||i.allowFiltersForEmpty||uiSearch.removeAllFilters(_),e||i.onChange&&i.onChange.call(_,s,t)},focus:function(_){_=uiSearch.getFieldEl(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.elfocus)(_)},reset:function(_,e,t){_=uiSearch.getFieldEl(_);var i=uiSearch.getOptions(_),o=uiSearch.getWrapEl(_);(_.getValue?_.getValue():_.value)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(_,""),uiSearch.onChanged(_,e,t),e||i.onEnter&&i.onEnter(_,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.elfocus)(_)):i.in_tabs&&_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_7__.default.hideSearch(o),window.tooltips&&tooltips.destroyAll()},showProgress:function(_){_=uiSearch.getFieldEl(_);var e=uiSearch.getWrapEl(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.addClass)(e,"ui_search_loading");var t=_.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(_.getValue()):_.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.toggleClass)(e,"ui_search_field_empty",!t)},hideProgress:function(_){_=uiSearch.getFieldEl(_);var e=uiSearch.getWrapEl(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.removeClass)(e,"ui_search_loading");var t=_.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(_.getValue()):_.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.toggleClass)(e,"ui_search_field_empty",!t)},scrollResize:function(_){if(!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_8__.browser.mobile){_=uiSearch.getFieldEl(_);var e,t=uiSearch.getWrapEl(_),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domPN)(t),o=t&&t.classList.contains("ui_search_fixed"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ge)(cur.uiSearchPageBlock)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.gpeByClass)("page_block",_),a=vk.staticheader?Math.max(0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ge)("page_header"))[1]-scrollNode.scrollTop):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ge)("page_header"))[1],l=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.isAncestor)(t,boxLayerWrap);if(t&&i&&(l||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.gpeByClass)("scroll_fix",t))&&(!_.ignoreFixed||o)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.isVisible)(i))if(l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getXY)(i,!0)[1]<0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getXY)(i,!0)[1]<a){var n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getStyle)(t.classList.contains("ui_search_new")?t:_,"width"));!o&&n&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(i,"height",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getSize)(t)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(t,"width",n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.addClass)(t,"ui_search_fixed"));var r=Math.min(0,Math.max(-bodyNode.scrollLeft,bodyNode.clientWidth-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ge)("page_layout"))[0]));if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(t,{marginLeft:r}),s){var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getXY)(s)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getSize)(s)[1]-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_10__.scrollGetY)()-_.offsetHeight;(e=Math.min(a,Math.max(-_.offsetHeight,d)))!==cur.lastUISearchPos&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(t,"top",e),cur.lastUISearchPos=e)}}else o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(i,"height",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(t,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.removeClass)(t,"ui_search_fixed"))}},setStatic:function(_){_.ignoreFixed=!0;var e=uiSearch.getWrapEl(_),t=e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domPN)(e);e&&t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(t,"height",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.setStyle)(e,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.removeClass)(e,"ui_search_fixed"))},setFixed:function(_){if(_.ignoreFixed=!1,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"resizeEventHandler")){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.isAncestor)(_,boxLayerWrap)?boxLayerWrap:window,t=uiSearch.scrollResize.pbind(_),i={stop:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent.pbind(e,"scroll",t),start:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent.pbind(e,"scroll",t)};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"eventHandlers")||[]).concat([i])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"resizeEventHandler",!0),i.start()}uiSearch.scrollResize(_)},initFilters:function(_,e){if(_){var t=uiSearch.getWrapEl(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("ui_search_fltr_control",t),o={start:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(i,"click",(function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)(i,"shown")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)(_.target,"ui_search_fltr_control")||a(i)})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(i,"mouseover",(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)(i,"shown")){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"hidetimer");_&&(clearTimeout(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"hidetimer",0)),a(i,!0)}})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(i,"mouseout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"hidetimer")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"hidetimer",setTimeout((function(){a(i,!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"hidetimer",0)}),200))}))},stop:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.removeEvent.pbind(i,"click mouseover mouseout")};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"eventHandlers")||[]).concat([o])),o.start();var s=uiSearch._getFiltersPane(_);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_6__.addEvent)(s,"click",(function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)(e.target,"token_title")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)(e.target,"token_del")){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.gpeByClass)("token",e.target),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(t,"id");uiSearch.removeFilter(_,i)}}))}function a(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.toggleClass)(_,"shown",e)}},removeAllFilters:function(_){var e=uiSearch._getFiltersPane(_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(e,"cur_filters");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.each)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)({},t),(function(e){uiSearch.removeFilter(_,e,!0)}))},toggleFilter:function(_,e,t,i){i?uiSearch.addFilter(_,e,t):uiSearch.removeFilter(_,e)},addFilter:function(_,e,t){if(e&&t){var i=uiSearch._getFiltersPane(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"cur_filters")||{};o[e]=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"cur_filters",o);var s=uiSearch.getOptions(_);s.onFiltersChanged&&s.onFiltersChanged(o),uiSearch._renderFilters(_)}},removeFilter:function(_,e,t){var i=uiSearch._getFiltersPane(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"cur_filters")||{};if(o[e]){delete o[e],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(i,"cur_filters",o);var s=uiSearch.getOptions(_);s.onFilterRemoved&&s.onFilterRemoved(e,_,t),s.onFiltersChanged&&s.onFiltersChanged(o),uiSearch._renderFilters(_)}},_getFiltersPane:function(_){var e=uiSearch.getWrapEl(_)||_;return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("ui_search_filters_pane",e)},_renderFilters:function(_){clearTimeout((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"renderFiltersTO")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(_,"renderFiltersTO",setTimeout(uiSearch._doRenderFilters.pbind(_)))},_doRenderFilters:function(_){var e=uiSearch._getFiltersPane(_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.data)(e,"cur_filters")||{},i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("ui_search_filters",e);if(i)if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(t))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.removeClass)(e,"expanded"),setTimeout((function(){i.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hide)(e)}),200);else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.show)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.addClassDelayed)(e,"expanded");var o=[],s={},a=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.each)(t,(function(_,e){var t=!1,i=!1,l=_.match(/(.*?)_([^_]+)$/),n=l&&l[2]||!1;(l=l&&l[1]||!1)&&(void 0!==s[l]&&"from"===n?i=s[l]:void 0!==s[l]&&(t=s[l]+1),s[l]=a);var r=`<div class="token" id="token${_}" data-id="${_}">\n                         <div class="token_title">${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.replaceEntities)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_4__.clean)(e))}</div>\n                         <div class="token_del"></div>\n                       </div>`;!1!==i?o.splice(i,0,r):!1!==t?o.splice(t,0,r):o.push(r),a++})),i.innerHTML=o.join("")}}};const __WEBPACK_DEFAULT_EXPORT__=uiSearch},27171:(_,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>n});var i=t(15544),o=t(95724),s=t(26271),a=t(49535),l={initTabs:function(_,e){if(!(s.browser.msie&&(0,o.intval)(s.browser.version)<10||s.browser.opera&&(0,o.intval)(s.browser.version)<15||(0,i.hasClass)(_,"ui_tabs_sliding"))){var t=(0,i.getSize)(e)[0],a=e.offsetLeft,l=(0,i.geByClass1)("_ui_tabs_slider",_);if(!(0,i.domData)(_,"inited")){var n={width:t+"px",marginLeft:a};(0,i.setStyle)(l,n)}}},tryInit:function(_){if(!(0,i.domData)(_,"inited")){var e=(0,i.geByClass1)("ui_tab_group_sel",_)||(0,i.geByClass1)("ui_tab_sel",_);e&&l.initTabs(_,e),(0,i.domData)(_,"inited",1)}},goTab:function(_,e,t){if((0,a.checkEvent)(e))return!0;var o=(0,i.gpeByClass)("ui_tabs",_);return!(!t&&(0,i.geByClass1)("ui_tab_sel",o)==_)&&(l.switchTab(_),l.showProgress(o),nav.go(_,e,{tab:_}))},switchTab:function(_,e){var t=(0,i.gpeByClass)("ui_tabs",_),s=(0,i.geByClass1)("ui_tab_sel",t),a=null,n=null,r=(0,i.hasClass)(s,"ui_tab_group_item")?n=(0,i.gpeByClass)("ui_tab_group",s):s,d=(0,i.hasClass)(_,"ui_tab_group_item")?a=(0,i.gpeByClass)("ui_tab_group",_):_;if(_!=s){if(_!=d&&(l.toggleGroup(d,!1),l.resetLabel(d,_)),r){l.initTabs(t,r),(e=e||{}).noAnim||d===r||((0,i.addClass)(t,"ui_tabs_sliding"),clearTimeout(cur.tabSlidingTO),cur.tabSlidingTO=setTimeout(i.removeClass.pbind(t,"ui_tabs_sliding"),300));var u=(0,i.geByClass1)("_ui_tabs_slider",t),c=(0,o.intval)(u.style.marginLeft),h={width:(0,i.getSize)(d)[0]+"px"};h[cssTransformProp]="translateX("+(d.offsetLeft-c)+"px)",(0,i.setStyle)(u,h),s!=r&&d!=r&&l.resetLabel(r),r!=s&&(0,i.removeClass)(r,"ui_tab_group_sel"),(0,i.removeClass)(s,"ui_tab_sel")}if(d!=_&&(0,i.addClass)(d,"ui_tab_group_sel"),(0,i.addClass)(_,"ui_tab_sel"),n&&(0,i.removeClass)(n,"ui_tab_hide_separator"),a){t=(0,i.geByClass1)("ui_tab_group_items",a,"div").children;var E=null;(0,o.each)(t,(function(_,e){"SPAN"===e.tagName?E=e:(0,i.hasClass)((0,i.domFC)(e),"ui_tab_sel")||(0,i.hasClass)(e,"unshown")||(E=null)})),E&&(0,i.addClass)(a,"ui_tab_hide_separator")}}return!1},resetLabel:function(_,e){var t=(0,i.geByClass1)("ui_tab_group_label",_,"span");t&&(t.innerHTML=(e||t).getAttribute("data-default-label"))},toggleGroup:function(_,e){var t=(0,i.data)(_,"visibletimer");t&&clearTimeout(t),(0,i.data)(_,"visibletimer",setTimeout(i.toggleClass.pbind(_,"visible",e),e?0:100)),(0,i.toggleClass)(_,"shown",e)},showGroup:function(_){var e=(0,i.data)(_,"hidetimer");e&&(clearTimeout(e),(0,i.data)(_,"hidetimer",0)),l.toggleGroup(_,!0)},hideGroup:function(_){(0,i.data)(_,"hidetimer")||(0,i.data)(_,"hidetimer",setTimeout((function(){l.toggleGroup(_,!1),(0,i.data)(_,"hidetimer",0)}),200))},showProgress:function(_){(0,i.hasClass)(_,"ui_tabs")||(_=(0,i.gpeByClass)("ui_tabs",_)),(0,i.addClass)(_,"ui_tabs_loading")},hideProgress:function(_){(0,i.hasClass)(_,"ui_tabs")||(_=(0,i.gpeByClass)("ui_tabs",_)),(0,i.removeClass)(_,"ui_tabs_loading")},showSearch:function(_,e){if(cur.viewAsBox)return cur.viewAsBox();if((0,a.checkEvent)(e))return!0;var t=(0,i.gpeByClass)("ui_tabs",_),o=(0,i.domByClass)(t,"_field");return(0,i.addClass)(t,"ui_tabs_search_opened"),uiSearch.focus(o),!1},hideSearch:function(_,e){if((0,a.checkEvent)(e))return!0;var t=(0,i.gpeByClass)("ui_tabs",_);return(0,i.removeClass)(t,"ui_tabs_search_opened"),!1}};const n=l},85331:(_,e,t)=>{"use strict";t.d(e,{BannersController:()=>n,ConsumeReason:()=>i});var i,o=t(70655),s=t(40517),a=t(49171),l=function(){function _(_,e){var t=this;this.blockId=e;this.observed_items=[],this.observer=new IntersectionObserver((function(_){return t.onView(_)}),{root:null,rootMargin:"0px",threshold:.5}),this.productCollector=new a.ProductionStatCollector,this.viewCollector=new a.ViewStatCollector(this.productCollector),this.clickCollector=new a.ClickStatCollector(this.productCollector),this.elements=_,this.addHandlers()}return _.prototype.destroy=function(){var _=this;this.observer.disconnect(),this.observed_items.forEach((function(e,t){return _.sendViewStat(t)})),this.elements.forEach((function(e){return e.removeEventListener("mousedown",_.clickHandler)}))},_.prototype.addHandlers=function(){var _=this;this.clickHandler=this.onClick.bind(this),this.elements.forEach((function(e){return e.addEventListener("mousedown",_.clickHandler)})),this.elements.forEach((function(e){return _.observer.observe(e)}))},_.prototype.onClick=function(_){if(_.currentTarget&&_.currentTarget instanceof HTMLElement&&_.currentTarget.parentElement&&_.currentTarget.dataset.id){var e=parseInt(_.currentTarget.dataset.id),t={type:s.ClickProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,position:(0,o.__spreadArray)([],(0,o.__read)(_.currentTarget.parentElement.children),!1).indexOf(_.currentTarget)+1},i={type:s.EventItemType.CATALOG_BANNER,id:e,track_code:this.blockId};this.clickCollector.logEvent(t,i)}},_.prototype.sendViewStat=function(_){if(void 0!==this.observed_items[_]){var e=(0,o.__assign)((0,o.__assign)({},this.observed_items[_]),{end_view:this.productCollector.getCurrentTime()}),t={type:s.EventItemType.CATALOG_BANNER,id:_,track_code:this.blockId};this.viewCollector.logEvent(e,t),delete this.observed_items[_]}},_.prototype.onView=function(_){var e=this;_.forEach((function(_){var t=_.target;if(t instanceof HTMLElement&&t.parentElement&&t.dataset.id){var i=parseInt(t.dataset.id);_.isIntersecting?void 0===e.observed_items[i]&&(e.observed_items[i]={type:s.ViewProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,start_view:e.productCollector.getCurrentTime(),end_view:"0",position:(0,o.__spreadArray)([],(0,o.__read)(t.parentElement.children),!1).indexOf(t)+1}):e.sendViewStat(i)}}))},_}();!function(_){_.Click="click",_.Close="close"}(i||(i={}));var n=function(){function _(_,e){this.blockContent=_,this.blockId=e;var t=this.getBanners();this.bannerStatCollector=new l(t,e)}return _.prototype.getBanners=function(){return Array.from(this.blockContent.querySelectorAll(".BannerItem"))},_.prototype.setBannersEvents=function(){var _=this;this.getBanners().forEach((function(e){if(e.dataset.id){var t=parseInt(e.dataset.id);_.addConsumableClick(e,t),_.addConsumableCloseClick(e,t)}}))},_.prototype.checkItems=function(){this.getBanners().length||this.blockContent&&this.blockContent.remove()},_.prototype.destroy=function(){this.bannerStatCollector.destroy()},_}()},88813:(_,e,t)=>{"use strict";t.d(e,{BaseController:()=>r});var i=t(70655),o=t(32603),s=t(24676),a=t(99392),l=function(_){function e(e,t){var s=this,l=t,n="center",r="top";(t.classList.contains("CatalogBlock__layout--header")||t.classList.contains("CatalogBlock__layout--header_extended"))&&(l=t.querySelector(".CatalogBlock__title")||t,n="left"),t.classList.contains("MusicAuthor__follow_btn")&&(n="right",r="bottom"),(s=_.call(this,o.HintType.Tooltip,e)||this).initialElement=t;var d=(0,i.__assign)({force_side:r,align:n,offset_left:0,offset_top:0,width:"250px"},e);return s.tooltip=new a.ElementTooltip(l,{content:s.title||s.text||"",cls:"feature_intro_tt "+s.id+" CatalogTooltip",forceSide:d.force_side,align:d.align,width:d.width,offset:[d.offset_left,d.offset_top],autoShow:!1,onHide:function(){return s.hide()}}),s}return(0,i.__extends)(e,_),e.prototype.show=function(){this.tooltip.show()},e}(s.Hint),n=t(22498),r=function(){function _(){}return _.prototype.fetchNext=function(){return this.fetchSection(this.id,this.nextFrom)},_.prototype.fetchSection=function(_,e,t){var o=this;return void 0===t&&(t={}),this.fetchInProgress=!0,new Promise((function(s,a){var l=(0,i.__assign)({section_id:_,start_from:e},t);window.nav.objLoc.claim&&(l.claim=window.nav.objLoc.claim),window.ajax.post("al_audio.php?act=load_catalog_section",l,{onDone:function(_,e,t){o.fetchInProgress=!1,s({blocks:_,data:e,blockItems:t})},onFail:function(){return a(),o.fetchInProgress=!1,!0}})}))},_.prototype.getId=function(){return this.id},_.getHint=function(_,e){switch(e.type){case o.HintType.Tooltip:return new l(e,_);case o.HintType.Highlight:return new n.HighlightHint(e,_)}return null},_}()},87364:(_,e,t)=>{"use strict";t.d(e,{BlockController:()=>I});var i=t(70655),o=t(97213),s=t(93560),a=t(50284),l=t(88813),n=(t(51876),t(15544)),r=t(26271),d=t(27909),u=t(49535);var c=t(40906),h=t(95724);function E(_,e){if(this.constructor!==E)throw new Error("InlineDropdown was called without 'new' operator");if(_=(0,n.ge)(_)){if(!_.nodeType)throw new Error("First argument not a DOM element");if(!(0,n.hasClass)(_,"idd_wrap")){if(this._opts=e||{},this._items=e.items?(0,h.clone)(e.items):JSON.parse(_.getAttribute("data-items")),!this._items)throw new Error("No items provided");this._title=e.keepTitle?e.title||_.innerHTML:"",this._selectable=!e.keepTitle||e.keepSelected,this._disableCancelClickEvent=!!e.disableCancelClickEvent&&!!e.disableCancelClickEvent;var t={icon:'<svg fill="none" height="8" viewBox="0 0 12 8" width="12" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.16 2.3a.75.75 0 0 1 1.05-.14L6 4.3l2.8-2.15a.75.75 0 1 1 .9 1.19l-3.24 2.5c-.27.2-.65.2-.92 0L2.3 3.35a.75.75 0 0 1-.13-1.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"dropdown_12"}.icon;this._iddEl=(0,n.se)(`<div class="idd_wrap" id="${_.id}">\n    <div class="idd_selected_value" tabindex="0" role="button">\n      ${_.innerHTML}\n    </div>\n    ${e.withArrow?`<div class="idd_chevron">${t}</div>`:""}\n    <input type="hidden" id="${_.id}_input" name="${_.getAttribute("name")||_.id}" />\n  </div>`);var i=this;if((0,c.each)(_.className.split(" "),(function(_,e){(0,n.addClass)(i._iddEl,e)})),(0,c.each)(_.attributes,(function(_,e){0==e.name.indexOf("data-")&&i._iddEl.setAttribute(e.name,e.value)})),_.parentNode.replaceChild(this._iddEl,_),this._els={valueEl:(0,n.geByClass1)("idd_selected_value",this._iddEl),itemsContentEl:(0,n.geByClass1)("idd_items_content",this._iddEl),hiddenInputEl:(0,n.geByTag1)("input",this._iddEl)},this._opts.autoShow){var o=!1,s=function(){o=!0,clearTimeout(i._autoShowTimeout),i._autoShowTimeout=setTimeout((function(){o&&i._onClick()}),100)};(0,u.addEvent)(this._iddEl,"mouseenter",s),(0,u.addEvent)(this._iddEl,"mouseleave",(function(){clearTimeout(i._autoShowTimeout),o=!1})),(0,u.addEvent)(this._iddEl,"keydown",(_=>"Enter"===_.key&&_.target.getAttribute("class").includes("idd_selected_value")?s():null))}else(0,u.addEvent)(this._iddEl,"click",this._onClick.bind(this)),(0,u.addEvent)(this._iddEl,"keydown",(_=>"Enter"===_.key&&_.target.getAttribute("class").includes("idd_selected_value")?this._onClick.call(this):null));this._rebuildDropdown();var a=!1;void 0!==e.selected?a=e.selected:_.hasAttribute("data-value")&&(a=_.getAttribute("data-value")),!1!==a&&this.select(a,!0)}}}E.IDD_HEADER_CORRECTION_LEFT=-10,E.IDD_HEADER_CORRECTION_TOP=-8,E.prototype._rebuildDropdown=function(){var _=this._opts.withIcon?"idd_with_icon":"",e=this._opts.idPrefix?this._opts.idPrefix:"",t=this._opts.idItemPrefix?this._opts.idItemPrefix:"",i=this,o=this._opts.ariaLabel||"",s={icon:'<svg fill="none" height="8" viewBox="0 0 12 8" width="12" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.16 2.3a.75.75 0 0 1 1.05-.14L6 4.3l2.8-2.15a.75.75 0 1 1 .9 1.19l-3.24 2.5c-.27.2-.65.2-.92 0L2.3 3.35a.75.75 0 0 1-.13-1.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"dropdown_12"}.icon,a=`<div class="idd_header_wrap ${_}">\n    <div class="idd_header" id="${e}${this._items[0][0]}"></div>\n      ${this._opts.withArrow?`<div class="idd_chevron">${s}</div>`:""}\n    </div>`,l=`<div class="idd_items_wrap"><div class="idd_items_content" role="list" aria-label="${o}">`;(0,c.each)(this._items,(function(e,o){l+="separator"===o?'<div class="idd_separator"></div>':function(e,o){o=o||"";var s=i._opts.sublists&&i._opts.sublists[e[0]]?"idd_sublist":"";return`<div class="idd_item ${o} ${_} ${s}" id="${t}idd_item_${e[0]}" data-id="${e[0]}" tabindex="0" role="button">\n      ${i._opts.withIcon?'<div class="idd_item_icon" id="'+e[0]+'"></div>':""}\n      <div class="idd_item_name">${i._opts.html?i._opts.html(e):e[1]}</div>\n    </div>`}(o)})),l+="</div></div>",this._els.popupItems=(0,n.se)(l),this._els.popupHeader=(0,n.se)(a),(0,u.addEvent)(this._els.popupItems,"click",(function(_){var e=_.target;if("a"!=e.tagName.toLowerCase()){for(;e&&!(0,n.hasClass)(e,"idd_item");)e=e.parentNode;e&&(i.select(e.getAttribute("data-id"))?i._hide():i._hoverItem(e)),(0,u.cancelEvent)(_)}else setTimeout((function(){i._hide()}))})),(0,c.each)((0,n.geByClass)("idd_item",this._els.popupItems),(function(_,e){(0,u.addEvent)(e,"mouseenter",(function(_){E._preventMouseHover||i._hoverItem(_.currentTarget)})),(0,u.addEvent)(e,"mouseleave",(function(_){E._preventMouseHover||i._unhoverItem(_.currentTarget,_)}))})),(0,u.addEvent)(this._els.popupItems,"mouseenter",function(){(0,u.addEvent)(this._els.popupItems,r.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this)),(0,u.addEvent)(this._els.popupItems,"mouseleave",function(){(0,u.removeEvent)(this._els.popupItems,r.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this))},E.prototype._onClick=function(_){if((0,n.isVisible)(this._els.popupEl))this._hide();else{E._currIDD&&E._currIDD._hide(),E._currIDD=this,window.tooltips&&tooltips.hideAll();var e=this,t=this._els.popupEl=(0,n.se)('<div class="idd_popup"></div>');this._opts.alignLeft&&(0,n.addClass)(t,"idd_align_left"),this._opts.popupClass&&(0,n.addClass)(t,this._opts.popupClass),this.openToUp=1==this._opts.forceDir||"up"==this._opts.forceDir||-1!=this._opts.forceDir&&"down"!=this._opts.forceDir&&(0,n.getXY)(e._iddEl)[1]-((window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0))+200>window.innerHeight,this.openToUp?(t.appendChild(this._els.popupItems),t.appendChild(this._els.popupHeader)):(t.appendChild(this._els.popupHeader),t.appendChild(this._els.popupItems));var i=(0,n.geByClass1)("idd_header",this._els.popupHeader);this._opts.keepTitle?i.innerHTML=this._title:i.innerHTML=this._selected?this._selected[1]:"",t.id="idd_"+this._iddEl.id,this._iddEl.appendChild(t);var o=(0,n.getSize)(t),s=(0,n.getSize)(this._els.valueEl),a=0;this.openToUp&&(a=-(0,n.getSize)(this._els.popupItems)[1]);var l={marginTop:(this._opts.headerTop||E.IDD_HEADER_CORRECTION_TOP)+a,width:o[0]+8,opacity:1};this._opts.alignLeft?l[vk.rtl?"marginRight":"marginLeft"]=s[0]-E.IDD_HEADER_CORRECTION_LEFT:l.marginLeft=(this._opts.headerLeft||E.IDD_HEADER_CORRECTION_LEFT)-(this._opts.withIcon?20:0),(0,n.setStyle)(t,l),this._unhoverItem(),this._highlightItem(),this._initOutEvent(),this._initKeypressEvent(),this._opts.onShow&&this._opts.onShow(this.ddEl),this._disableCancelClickEvent||(0,u.cancelEvent)(_)}},E.prototype._hide=function(){(0,n.re)(this._els.popupEl),this._els.popupEl=null,(0,n.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredItem=null,this._deinitEvents(),this._hideSubmenu(),clearTimeout(this._hideSubmenuTimeout),this._opts.onHide&&this._opts.onHide()},E.prototype._highlightItem=function(_){if(this._selectable&&this._els.popupEl){if(void 0===_){if(!this._selected)return;_=this._selected[0]}var e=(0,n.geByClass1)("idd_hl",this._els.popupEl);e&&(0,n.removeClass)(e,"idd_hl");var t=(0,n.ge)("idd_item_"+_);(0,n.addClass)(t,"idd_hl");var i=this;(0,c.each)((0,n.geByClass)("idd_item",this._els.popupItems),(function(_,e){if(e==t)return i._els.popupItems.scrollTop=(_+1)*(0,n.getSize)(e)[1]-(0,n.getSize)(i._els.popupItems)[1]/2,!1}))}},E.prototype._onWheel=function(_){var e=(0,n.getSize)((0,n.geByClass1)("idd_items_content",this._els.popupItems))[1],t=(0,n.getSize)(this._els.popupItems)[1];e!=t&&(0==this._els.popupItems.scrollTop&&_.deltaY<0||this._els.popupItems.scrollTop==e-t&&_.deltaY>0)&&(0,u.cancelEvent)(_)},E.prototype._onKeyDown=function(_){switch(_.keyCode){case 9:case 38:case 40:case 13:case 27:this._onKey(_.keyCode,_)}},E.prototype._onKeyPress=function(_){this._onKey(_.which,_)},E.prototype._hideSubmenu=function(){(0,n.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent"),(0,n.re)(this._els.currCascade),delete this._currSubmenuItem,this._hoveredItem&&this._showSubmenu(this._hoveredItem)},E.prototype._showSubmenu=function(_){if(clearTimeout(this._hideSubmenuTimeout),_){var e=this,t=_.getAttribute("data-id");if(this._opts.sublists&&this._opts.sublists[t]){if((0,n.addClass)(_,"idd_hover_sublist_parent"),this._currSubmenuItem==_)return void clearTimeout(this._submenuHideTimeout);var i=this._opts.sublists[t],o='<div class="idd_popup"><div class="idd_items_wrap"><div class="idd_items_content">',s=i.withIcon?"idd_with_icon":"";function b(_,e){return'<div class="idd_item '+(e=e||"")+" "+s+'" id="idd_item_'+_[0]+'" data-id="'+_[0]+'" role="button" tabindex="0">'+(i.withIcon?'<div class="idd_item_icon" id="'+_[0]+'"></div>':"")+'<div class="idd_item_name">'+(i.html?i.html(_):_[1])+"</div></div>"}(0,c.each)(i.items,(function(_,e){o+=b(e)})),o+="</div></div></div>",this._els.currCascade=(0,n.se)(o),this._iddEl.appendChild(this._els.currCascade);for(var a=(0,n.getSize)(this._els.popupEl),l=(0,n.getSize)(_),r=(0,n.getSize)(this._els.currCascade),h=0,p=_;null!=(p=p.previousSibling);)h++;var P=a[0]+(this._opts.headerLeft||E.IDD_HEADER_CORRECTION_LEFT)-1;(0,n.setStyle)(this._els.currCascade,{marginLeft:P-3,marginTop:l[1]*h+6-(this.openToUp?a[1]:0),"z-index":200,width:r[0]+30}),setTimeout((function(){(0,d.cssAnim)(e._els.currCascade,{marginLeft:P,opacity:1},{duration:140})}),10),(0,c.each)((0,n.geByClass)("idd_item",this._els.currCascade),(function(_,t){(0,u.addEvent)(t,"mouseenter",(function(_){e._isInSubmenu=!0,E._preventMouseHover||e._hoverItem(_.currentTarget,null,!0)})),(0,u.addEvent)(t,"mouseleave",(function(_){e._isInSubmenu=!1,E._preventMouseHover||e._unhoverItem()}))})),(0,u.addEvent)(this._els.currCascade,"click",(function(_){var t=_.target;if("a"!=t.tagName.toLowerCase()){for(;t&&!(0,n.hasClass)(t,"idd_item");)t=t.parentNode;if(t){var o=!0,s=t.getAttribute("data-id"),a=(0,n.geByClass1)("idd_item_name",t).innerHTML;i.onSelect?o=i.onSelect(s,a):e._opts.onSelect&&(o=e._opts.onSelect(s,a)),o&&e._hide()}(0,u.cancelEvent)(_)}else setTimeout((function(){e._hide()}))})),this._currSubmenuItem=_}}},E.prototype._hoverItem=function(_,e,t){var i=this;if(this._unhoverItem(),(0,n.addClass)(_,"idd_hover"),this._hoveredItem=_,e&&_){var o=_.getAttribute("id"),s=this;(0,c.each)((0,n.geByClass)("idd_item"),(function(e,t){if(t.getAttribute("id")==o)return s._els.popupItems.scrollTop=(0,n.getSize)(_)[1]*(e+1)-(0,n.getSize)(s._els.popupItems)[1]/2,clearTimeout(E._preventMouseHover),E._preventMouseHover=setTimeout((function(){E._preventMouseHover=null}),100),!1}))}if(clearTimeout(this._hideSubmenuTimeout),t)(0,n.addClass)(this._currSubmenuItem,"idd_hover_sublist_parent");else{var a=this._currSubmenuItem==_;this._currSubmenuItem&&!a&&(this._hideSubmenuTimeout=setTimeout((function(){i._hideSubmenu()}),200)),this._currSubmenuItem||this._showSubmenu(_),(0,n.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent")}},E.prototype._unhoverItem=function(_,e){this._hoveredItem&&(0,n.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredParentItem&&(0,n.removeClass)(this._hoveredParentItem,"idd_hover"),clearTimeout(E._preventMouseHover)},E.prototype._onKey=function(_,e){if(38==_||40==_){var t=this._hoveredItem||(0,n.geByClass1)("idd_hl",this._els.popupItems)||(0,n.geByClass1)("idd_item",this._els.popupItems);return t=38==_?t.previousSibling:t.nextSibling,this._hoverItem(t,!0),(0,u.cancelEvent)(e),!1}if(9==_){var i=(0,n.geByClass1)("idd_items_content",this._els.popupItems),o=e.target;return o=e.target.getAttribute("class").includes("idd_item")?e.shiftKey?o.previousSibling:o.nextSibling:e.shiftKey?i.lastChild:i.firstChild,this._hoverItem(o,!0),!1}13==_?this._hoveredItem&&this.select(this._hoveredItem.getAttribute("data-id"))&&this._hide():27==_?this._hide():this._quickSearch(_)},E.prototype._quickSearch=function(_){var e=this;if(void 0!==_){var t=String.fromCharCode(_).toLowerCase();if(!t)return;setTimeout((function(){e._currSearchStr=""}),600),this._currSearchStr=this._currSearchStr||"",this._currQuickSearchIndex=this._currQuickSearchIndex||0,1==this._currSearchStr.length&&this._currSearchStr[0]==t||(this._currSearchStr+=t)}for(var i=this._items,o=this._currQuickSearchIndex;o<i.length;o++){var s=i[o][1].toLowerCase();if(1==this._currSearchStr.length&&this._currSearchStr==s[0]||this._currSearchStr.length>1&&s.indexOf(this._currSearchStr)>=0){this._currQuickSearchIndex=o+1,this._hoverItem((0,n.ge)("idd_item_"+i[o][0]),!0),o==i.length-1&&(this._currQuickSearchIndex=0);break}o==i.length-1&&(this._currQuickSearchIndex=0,_&&this._quickSearch())}},E.prototype._deinitEvents=function(){(0,u.removeEvent)(window,"click",E._window_onOuterClick),(0,u.removeEvent)(window,"keypress",E._window_onKeyPress),(0,u.removeEvent)(window,"keydown",E._window_onKeyDown)},E.prototype._initKeypressEvent=function(){(0,u.addEvent)(window,"keypress",E._window_onKeyPress=this._onKeyPress.bind(this)),(0,u.addEvent)(window,"keydown",E._window_onKeyDown=this._onKeyDown.bind(this))},E.prototype._onOuterClick=function(_){for(var e=_.target,t=!0;e&&e!=document;){if((0,n.hasClass)(e,"idd_popup")){t=!1;break}e=e.parentNode}t&&this._hide()},E.prototype._initOutEvent=function(){var _=this;setTimeout((function(){(0,u.addEvent)(window,"click",E._window_onOuterClick=_._onOuterClick.bind(_))})),this._opts.autoHide>0&&((0,u.addEvent)(this._iddEl,"mouseleave",(function(){clearTimeout(_._leaveTimeout),_._leaveTimeout=setTimeout((function(){_._isInSubmenu||_._hide()}),_._opts.autoHide)})),(0,u.addEvent)(this._iddEl,"mouseenter",(function(){clearTimeout(_._leaveTimeout)})))},E.prototype.deinit=function(){this._deinitEvents()},E.prototype.setItems=function(_){this._items=(0,h.clone)(_),this.select(_[0][0],!0),this._rebuildDropdown()},E.prototype.getElement=function(){return this._iddEl},E.prototype.getSelected=function(){return this._selected},E.prototype.select=function(_,e){if(!this._opts.sublists||!this._opts.sublists[_]){var t=!1;if((0,c.each)(this._items,(function(e,i){if(i[0]==_)return t=i,!1})),!1===t)throw new Error("No item found for selection");this._selected=t,this._opts.keepTitle||(this._els.valueEl.innerHTML=t[1]),(0,n.val)(this._els.hiddenInputEl,_);var i=!0;if(!e&&this._opts.onSelect)try{i=!this._opts.onSelect(t[0],t)}catch(_){console.error(_)}return i}},E.prototype.val=function(_,e){return void 0!==_?this.select(_,e):this.getSelected()?this.getSelected()[0]:""};var p,P,b=function(){function _(_,e){this.element=_;var t=this.getConfig();this.dropdown=new E(_,(0,i.__assign)({onSelect:e},t))}return _.prototype.getConfig=function(){var _=this.element.querySelector("."+a.SORTER_ACTION_DATA);if(!_)return null;var e=Array.from(_.querySelectorAll("li"));if(0===e.length)return null;var t={};return t.items=e.map((function(_){var e=_.dataset.id||"";return _.dataset.selected&&(t.selected=e),[e,_.innerText]})),t.withArrow=!0,_.remove(),t},_}(),g=t(87142),O=t(47612),D=t(64054),M=t(85331),m=t(93680),C=function(_){function e(e,t){var i=_.call(this,e,t)||this;return i.setBannersEvents(),i}return(0,i.__extends)(e,_),e.prototype.consumeBanner=function(_,e){m.ajax.post("/al_audio.php?act=consume_banner",{id:_,ref:this.blockId,reason:e},{onFail:function(){return!0}})},e.prototype.addConsumableClick=function(_,e){var t=this;_.classList.contains("BannerItem--consumable")&&_.dataset.id&&_.addEventListener("click",(function(){return t.consumeBanner(e,M.ConsumeReason.Click)}))},e.prototype.addConsumableCloseClick=function(_,e){var t=this,i=_.querySelector(".BannerItem__close");i instanceof HTMLElement&&(i.onclick=function(i){t.consumeBanner(e,M.ConsumeReason.Close),_.remove(),t.checkItems(),i.stopPropagation(),i.preventDefault()})},e.prototype.checkItems=function(){var _=this.getBanners();if(_.length){if(1===_.length){var e=this.blockContent.querySelectorAll(".audio_promo__control");e&&e.forEach((function(_){return _.remove()}))}}else this.blockContent&&this.blockContent.remove()},e}(M.BannersController),w=t(67766);!function(_){_.MusicAudios="music_audios",_.MusicPlaylists="music_playlists",_.MusicOwners="music_owners"}(p||(p={})),function(_){_.LargeSlider="large_slider",_.List="list"}(P||(P={}));var A=function(){function _(_,e,t){this.container=_,this.dataType=e,this.layoutName=t}return _.prototype.replaceItems=function(_){switch(this.dataType){case p.MusicAudios:this.replaceItemsBase(_);break;case p.MusicPlaylists:this.replaceMusicPlaylists(_);break;case p.MusicOwners:this.replaceMusicOwners(_);break;default:this.replaceItemsBase(_)}},_.prototype.replaceMusicPlaylists=function(_){var e=_;this.layoutName===P.LargeSlider&&(e=_.slice(0,5)),this.replaceItemsBase(e)},_.prototype.replaceItemsBase=function(_){var e;this.container.innerHTML="",(e=this.container).append.apply(e,(0,i.__spreadArray)([],(0,i.__read)(_),!1))},_.prototype.replaceMusicOwners=function(_){var e=_[0];if(e){var t=e.querySelector(".MusicOwnerCell__actions");if(t){var i=this.container.querySelector(".MusicOwnerCell__actions");if(i)i.innerHTML=t.innerHTML;else{var o=this.container.querySelector(".MusicOwnerCell__after");o&&o.appendChild(t)}}}},_}();function y(_){var e=_.split(" "),t=(e=e.slice(0,e.length-1)).join(" ");return t&&(t+="..."),t}var v=function(){function _(_){this.blockContent=_,this.truncateName()}return _.prototype.truncateName=function(){var _=this.blockContent.querySelector(".MusicAuthor_block__title");_ instanceof HTMLElement&&(!function(_,e){if(void 0===e&&(e=0),_.scrollHeight/_.clientHeight>1.1)for(var t=_.clientHeight,i=_.innerText;i&&_.scrollHeight/t>1.1&&_.innerText.split(" ").length>e;)i=y(i),_.innerHTML=i}(_),parseInt(getComputedStyle(_).lineHeight)===_.clientHeight&&_.classList.add("MusicAuthor_block__title--singleLine"),_.classList.remove("MusicAuthor_block__title--hidden"))},_.prototype.destroy=function(){},_}(),f=t(134),I=function(_){function e(e,t){var o=_.call(this)||this;return o.section=e,o.block=t,o.listenEvents=[],o.setFromBlockContent(),o.blockItemsContainer=t.querySelector("."+a.BLOCK_ITEMS_CONTAINER),o.blockItemsContainer&&(o.initialItems=(0,i.__spreadArray)([],(0,i.__read)(o.blockItemsContainer.children),!1)),o.initSpecificBlockController(),o.initGallery(),o.loader=t.getElementsByClassName(a.AUTO_LIST_LOADER)[0],o.initSearch(),o.initSortSelector(),o.initHints(),o.initListenEvents(),o}return(0,i.__extends)(e,_),e.prototype.initSpecificBlockController=function(){if(this.blockContent)switch(this.blockContent.dataset.type){case"catalog_banners":this.specificController=new C(this.blockContent,this.getId());break;case"artist":case"curator":this.specificController=new v(this.blockContent)}},e.prototype.enable=function(){this.reorderer&&this.reorderer.enable()},e.prototype.disable=function(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.disable()},e.prototype.emitEvent=function(_){if(this.listenEvents.includes(_))if(_===f.events.PLACEHOLDER_REMOVE)this.removeBlock();else this.reloadData()},e.prototype.initSearch=function(){var _=this.block.getElementsByClassName("ui_search");_.length&&Array.prototype.forEach.call(_,(function(_){return D.default.init(_)}))},e.prototype.initListenEvents=function(){var _,e;if(null===(_=this.blockContent)||void 0===_?void 0:_.dataset.listenEvents)try{this.listenEvents=JSON.parse(null===(e=this.blockContent)||void 0===e?void 0:e.dataset.listenEvents)}catch(_){}},e.prototype.onSectionInit=function(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(a.BLOCK_ITEMS_REORDERABLE)&&this.initListReorder("current"!==this.section.name)},e.prototype.hasBlockName=function(_){return this.blockContent&&this.blockContent.classList.contains(a.BLOCK_ELEMENT+"__"+_)},e.prototype.reloadData=function(){var _=this;this.fetchSection(this.id,"").then((function(t){var i=t.blockItems,o=t.data;if(_.setItems(e.createNodesFromItems(i)),o.playlists&&o.playlists.length){var a=(0,s.getAudioPlayer)();a&&a.addWithReplacePlaylists(o.playlists.map((function(_){return new w.AudioPlaylist(_)})))}})).catch((function(){return!0}))},e.prototype.setFromBlockContent=function(){if(this.blockContent=this.block.classList.contains(a.BLOCK_CONTENT)?this.block:this.block.querySelector("."+a.BLOCK_CONTENT),this.blockContent){this.id=this.blockContent.dataset.id||"",this.nextFrom=this.blockContent.dataset.next||"",this.dataType=this.blockContent.dataset.type||null;var _=this.blockContent.classList.toString().match(/CatalogBlock__layout--(.*)/);this.layoutName=_&&_[1]}},e.prototype.removeBlock=function(){this.destroy();var _=this.block.closest("."+a.BLOCK_ELEMENT),e=this.block;_ instanceof HTMLElement&&1===_.childElementCount&&(e=_),e.remove()},e.prototype.clearList=function(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")},e.prototype.destroy=function(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.destroy(),this.specificController&&this.specificController.destroy()},e.prototype.hideLoader=function(){this.loader&&(this.loader.style.display="none")},e.prototype.showLoader=function(){this.loader&&(this.loader.style.display="")},e.prototype.setNextFrom=function(_){this.nextFrom=_,this.blockContent&&(this.blockContent.dataset.next=this.nextFrom)},e.prototype.setId=function(_){this.id=_,this.blockContent&&(this.blockContent.dataset.id=this.id),this.blockItemsContainer&&this.blockItemsContainer.dataset.playlistId&&(this.blockItemsContainer.dataset.playlistId=this.id)},e.prototype.setItems=function(_){this.blockItemsContainer&&this.dataType&&this.layoutName&&new A(this.blockItemsContainer,this.dataType,this.layoutName).replaceItems(_)},e.prototype.resetItems=function(){var _;this.blockItemsContainer&&(this.clearItems(),(_=this.blockItemsContainer).append.apply(_,(0,i.__spreadArray)([],(0,i.__read)(this.initialItems),!1)))},e.prototype.clearItems=function(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")},e.prototype.initAutoList=function(_){var e=this;void 0===_&&(_=[]);var t=_;this.blockItemsContainer&&(this.blockAutoList&&this.blockAutoList.destroy(),this.blockAutoList=new o.default(this.blockItemsContainer,{scrollNode:!1,onRendered:function(){return(0,s.getAudioPlayer)().updateCurrentPlaying()},onNoMore:function(){return e.hideLoader()},onNeedRows:function(_){if(e.showLoader(),t.length){var i=t;return t=[],void _(i)}e.nextFrom?e.fetchNext().then((function(t){var i=t.blockItems,o=t.data;e.setNextFrom(o.nextFrom),_(i)})).catch((function(){})):_(null)}}))},e.prototype.updateListReorder=function(){this.reorderer&&this.reorderer.update()},e.prototype.initListReorder=function(_){var e,t=this;switch(void 0===_&&(_=!0),this.dataType){case p.MusicAudios:e=function(e,i,o){return t.onAudioBlockReorder(e,i,o,_)};break;case p.MusicPlaylists:e=this.onPlaylistsBlockReorder.bind(this);break;default:e=function(){}}this.reorderer=new g.default(this.blockItemsContainer,"",{onReorder:e.bind(this)})},e.prototype.onAudioBlockReorder=function(_,e,t,i){window.currentAudioPage(this.block).onAudioRowsReorder(!i,_,e,t)},e.prototype.onPlaylistsBlockReorder=function(_,e,t){window.currentAudioPage(this.block).onPlaylistsReorder(_,e,t)},e.prototype.initSortSelector=function(){var _=this,e=this.block.querySelector("."+a.SORTER_ACTION);e&&(this.sortSelector=new b(e,(function(e){m.ajax.post("/al_audio.php?act=replace_blocks",{replacement_ids:e},{onDone:function(e){return _.section.replaceBlocks(e.replacements,e.nextFrom,e.playlists)}})})))},e.prototype.initGallery=function(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(a.GALLERY)&&(this.gallery=new O.UIGallery(this.blockItemsContainer,{scrollY:!1}))},e.search=function(_,t,i,o){var s=e.findBlockById(_,o.target);s&&!s.fetchInProgress&&(i?s.fetchSection(t,"",{search_query:i}).then((function(_){var t=_.blockItems;s.setItems(e.createNodesFromItems(t))})).catch((function(){return!0})):s.resetItems())},e.showMore=function(_,t){var i=e.findBlockById(_,t);i&&!i.fetchInProgress&&i.fetchNext().then((function(_){var t=_.blockItems,o=_.data;i.setItems(e.createNodesFromItems(t)),i.nextFrom=o.nextFrom})).catch((function(){return!0}))},e.findBlockById=function(_,e){var t=window.currentAudioPage(e).catalogController.currentSection;return t?t.getBlockById(_):null},e.findBlockByElement=function(_){var e=(0,n.gpeByClass)("CatalogBlock__content",_);return(null==e?void 0:e.dataset.id)||null},e.createNodesFromItems=function(_){return _.map((function(_){var e=document.createElement("template");return e.innerHTML=_,e.content.firstElementChild})).filter((function(_){return!!_}))},e.prototype.initHints=function(){var _=this;if(this.block.dataset.catalogHintId){var e=this.section.getHintById(this.block.dataset.catalogHintId);if(e){var t=l.BaseController.getHint(this.block,e);if(t){var o=this.section.hintsToShow.findIndex((function(_){return t.id===_.id&&_.initialElement.parentElement===t.initialElement.parentElement}));if(o>-1){var s=this.section.hintsToShow[o],a=s.initialElement.parentElement||s.initialElement,n=l.BaseController.getHint(a,e);n&&(this.section.hintsToShow[o]=n)}else this.section.hintsToShow.push(t)}delete this.block.dataset.catalogHintId}}var r=this.block.querySelectorAll("[data-catalog-hint-id]");if(r.length){var d={};r.forEach((function(_){_.dataset.catalogHintId&&(Array.isArray(d[_.dataset.catalogHintId])?d[_.dataset.catalogHintId].push(_):d[_.dataset.catalogHintId]=[_],delete _.dataset.catalogHintId)})),Object.entries(d).forEach((function(e){var t=(0,i.__read)(e,2),o=t[0],s=t[1],a=_.section.getHintById(o);if(a){var n;n=1===s.length?s[0]:_.block;var r=l.BaseController.getHint(n,a);r&&_.section.hintsToShow.push(r)}}))}},e}(l.BaseController)},75807:(_,e,t)=>{"use strict";t.d(e,{CatalogController:()=>c});var i=t(70655),o=t(67766),s=t(93560),a=t(97213),l=t(87364),n=t(50284),r=t(88813),d=t(22498),u=function(_){function e(e,t,i){var o=_.call(this)||this;o.sectionData=t,o.catalogController=i,o.blocks=[],o.hintsToShow=[];var s=e.classList.contains(n.SECTION)?e:e.querySelector("."+n.SECTION);return s?(o.sectionEl=s,o.name=t.name,o.initTabsHints(),o.initBlocks(),o.nextFrom=void 0===o.sectionEl.dataset.next?t.nextFrom:o.sectionEl.dataset.next,o.id=t.sectionId,t.playlists&&t.playlists.length&&o.addPlaylists(t.playlists),t.playlist&&o.setPagePlaylist(t.playlist),o.isBlockPagination=o.sectionData.isBlockPagination,o.initSectionAutoList(),o.hideShowMoreLoaders(),o.sectionInited(),o.showHints(),o):(o.sectionEl=e,o)}return(0,i.__extends)(e,_),e.prototype.showHints=function(){var _=this;if(this.hintsToShow.length){var e=void 0,t=this.hintsToShow.filter((function(_){return _ instanceof d.HighlightHint}));t.length?(e=t[0],this.hintsToShow.splice(this.hintsToShow.indexOf(e),1),e.onHide=function(){return _.showHints()},e.show()):this.hintsToShow.forEach((function(_){return _.show()}))}},e.prototype.initBlocksManually=function(){this.initBlocks()},e.prototype.getSectionElement=function(){return this.sectionEl},e.prototype.enable=function(){this.initSectionAutoList(),this.blocks.forEach((function(_){return _.enable()}))},e.prototype.disable=function(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks.forEach((function(_){return _.disable()}))},e.prototype.emitEvent=function(_,e){this.blocks.forEach((function(t){e&&e!==t.getId()||t.emitEvent(_)}))},e.prototype.switchSection=function(_){var e,t=null===(e=this.catalogController)||void 0===e?void 0:e.tabs;t&&t.forEach((function(e){e.dataset.sectionId===_&&e.click()}))},e.prototype.replaceBlocks=function(_,e,t){var o=this,s=!1;t&&this.addPlaylists(t),_.forEach((function(_){var e,t,a=_.fromIds.map((function(_){return o.getBlockById(_)})).filter((function(_){return null!==_})),n=null;if(a.length&&(null===(t=a[a.length-1])||void 0===t?void 0:t.block)&&(n=a[a.length-1].block),n){var r=l.BlockController.createNodesFromItems(_.toBlocks);r.forEach((function(_){return null==n?void 0:n.insertAdjacentElement("beforebegin",_)})),s=s||a.some((function(_){return _===o.paginatedBlockController})),a.forEach((function(_){_.block.remove(),_.destroy(),o.blocks=o.blocks.filter((function(e){return e!==_}))}));var d=r.map((function(_){return new l.BlockController(o,_)}));(e=o.blocks).push.apply(e,(0,i.__spreadArray)([],(0,i.__read)(d),!1)),o.hideShowMoreLoaders()}})),"string"==typeof e&&this.setNextFrom(e),s&&(this.initPaginatedBlock(),e&&(this.isBlockPagination?this.initBlockAutoList([],this.nextFrom):this.sectionAutoList.isDone()&&this.initSectionAutoList()))},e.prototype.sectionInited=function(){this.blocks.forEach((function(_){return _.onSectionInit()}))},e.prototype.initTabsHints=function(){var _,e=this,t=null===(_=this.catalogController)||void 0===_?void 0:_.tabs;t&&t.forEach((function(_){if(_.dataset.catalogHintId){var t=e.getHintById(_.dataset.catalogHintId);if(t){var i=r.BaseController.getHint(_,t);i&&e.hintsToShow.push(i),delete _.dataset.catalogHintId}}}))},e.prototype.getHintById=function(_){return this.sectionData.hints&&this.sectionData.hints[_]||null},e.prototype.destroy=function(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks&&this.blocks.forEach((function(_){return _.destroy()}))},e.prototype.getBlockById=function(_){return this.blocks&&this.blocks.find((function(e){return e.getId()===_}))||null},e.prototype.reloadBlock=function(_){var e=this.findBlockByBlockName(_);e&&e.reloadData()},e.prototype.updateReorder=function(){this.blocks&&this.blocks.forEach((function(_){_.updateListReorder()}))},e.prototype.hideShowMoreLoaders=function(){this.blocks.forEach((function(_){return _.hideLoader()}))},e.prototype.addPlaylists=function(_){var e=(0,s.getAudioPlayer)();_.forEach((function(_){if(_){var t=new o.AudioPlaylist(_);t.getAudiosList().length||t.mergeWith(_),e.addPlaylist(t)}}))},e.prototype.setPagePlaylist=function(_){var e=window.currentAudioPage(this.sectionEl),t=(0,s.getAudioPlayer)().getPlaylist(_.type,_.ownerId,_.id,"",_.blockId);t.getAudiosCount()||(t.mergeWith(_),t.load()),e.setPagePlaylist(t)},e.prototype.setNextFrom=function(_){this.nextFrom=_,this.sectionEl&&(this.sectionEl.dataset.next=_)},e.prototype.initSectionAutoList=function(){var _=this;this.sectionAutoList&&this.sectionAutoList.destroy(),this.sectionAutoList=new a.default(this.sectionEl,{fetchImmediate:!1,onNeedRows:function(e){var t;if(_.isBlockPagination)return _.initBlockAutoList(),void e(null);_.nextFrom?(null===(t=_.paginatedBlockController)||void 0===t||t.showLoader(),_.fetchNext().then((function(t){var i=t.blocks,o=t.data,a=t.blockItems;(_.setNextFrom(o.nextFrom),o.isBlockPagination||o.blockIds&&1===o.blockIds.length&&_.getBlockById(o.blockIds[0]))?(e(null),_.isBlockPagination=_.isBlockPagination||o.isBlockPagination,_.initBlockAutoList(a,_.nextFrom),o.playlist&&"search"===o.playlist.type&&(0,s.getAudioPlayer)().getPlaylist().sendSearchStats("search_view")):(o.playlists&&_.addPlaylists(o.playlists),e(i||null),_.initBlocks())})).catch((function(){}))):e(null)}})},e.prototype.initBlocks=function(){var _=this;this.blocks=[];var e=[];(0,i.__spreadArray)([],(0,i.__read)(this.sectionEl.getElementsByClassName(n.BLOCK_ELEMENT)),!1).forEach((function(_){_.classList.contains(n.BLOCK_DIVIDED)?_.querySelectorAll("."+n.BLOCK_CONTENT).forEach((function(_){return e.push(_)})):e.push(_)})),this.blocks=e.map((function(e){return new l.BlockController(_,e)})),this.initPaginatedBlock()},e.prototype.initPaginatedBlock=function(){var _=this.sectionEl.querySelector("."+n.PAGINATED_BLOCKS_CONTAINER);if(_){var e=(0,i.__spreadArray)([],(0,i.__read)(_.getElementsByClassName(n.BLOCK_CONTENT)),!1),t=e[e.length-1].dataset.id;t&&(this.paginatedBlockController=this.getBlockById(t))}else this.paginatedBlockController=this.blocks[this.blocks.length-1]},e.prototype.initBlockAutoList=function(_,e){void 0===_&&(_=[]),this.paginatedBlockController&&(void 0!==e&&this.paginatedBlockController.setNextFrom(e),this.paginatedBlockController.initAutoList(_))},e.prototype.findBlockByBlockName=function(_){return this.blocks.find((function(e){return e.hasBlockName(_)}))},e}(r.BaseController),c=function(){function _(_){this.sections={},this.root=_;var e=this.root.querySelector(".CatalogSection--header_section");e instanceof HTMLElement&&(this.headerSection=new u(e,{})),this.tabs=Array.from(this.root.querySelectorAll("._audio_section_tab .ui_tab"))}return _.prototype.setSection=function(_,e,t){this.sections[_]&&this.sections[_].getId()===t.sectionId?(this.currentSection=this.sections[_],this.enableSection(_)):(this.currentSection=new u(e,t,this),this.sections[_]=this.currentSection)},_.prototype.disableSection=function(_){this.sections[_]&&this.sections[_].disable()},_.prototype.enableSection=function(_){this.sections[_]&&this.sections[_].enable()},_.prototype.emitEvent=function(_,e){Object.values(this.sections).forEach((function(t){return t.emitEvent(_,e)}))},_.prototype.deleteSection=function(_){var e=this.sections[_];e&&(e.destroy(),delete this.sections[_])},_.prototype.destroy=function(){Object.entries(this.sections).forEach((function(_){(0,i.__read)(_,2)[1].destroy()})),this.headerSection&&this.headerSection.destroy()},_.prototype.updateSectionReorder=function(){this.currentSection&&this.currentSection.updateReorder()},_.prototype.initBlocksManually=function(){this.currentSection=new u(this.root,{nextFrom:"",isBlockPagination:!1,sectionId:"",name:""},this),this.currentSection.initBlocksManually()},_}()},22498:(_,e,t)=>{"use strict";t.d(e,{HighlightHint:()=>E});var i=t(70655),o=t(32603),s=t(24676),a=t(15544),l=t(49535),n=t(3834);function r(_){var e=_.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}var d=t(99392),u="page_header_cont",c="onboarding";class h{constructor(_,e,t){var i;void 0===t&&(t={}),this.el=_,this.text=e,this.hideDarkness=!0,this.oldColor=!1;var o,s,a={autoShow:!1,noAutoHideOnWindowClick:null==(i=t.noAutoHideOnWindowClick)||i,content:e instanceof HTMLElement?e:`${e}`,cls:`feature_intro_tt tutorial_tip_tt ${s=null!=(o=t.class)?o:"",t.tooltipWhite?s:s+" feature_intro_blue_tt"}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:t.scrollOffset||0,align:t.align||d.ElementTooltip.ALIGN_CENTER};t.side&&(a.forceSide=t.side),t.offset&&(a.offset=t.offset),t.width&&(a.width=t.width),t.shift&&(a.centerShift=t.shift),t.border?this.border=t.border:this.border=[10,10,10,10],t.ttOnHide&&(a.onHide=t.ttOnHide),t.withCloseButton&&(a.withCloseButton=t.withCloseButton,a.onCloseButtonClick=t.onCloseButtonClick),t.align&&(a.align=t.align),this.ttParams=a,this.opts=t,this.initOnboardingBG()}initOnboardingBG(){if(!window.onboardingBG){var _=(0,a.se)('\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ');(0,a.domInsertBefore)(_,window.layerBG),window.onboardingBGHeader=(0,a.ge)("onboarding_bg_header"),window.onboardingBG=(0,a.ge)("onboarding_bg"),window.onboardingBGRect=(0,a.ge)("onboarding_bg_rect"),window.onboardingBGClip=(0,a.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,a.hide)(window.onboardingBG),(0,a.hide)(window.onboardingBGHeader),(0,a.removeClass)((0,a.ge)(u),c),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,l.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,l.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){var _=(0,a.getXY)(this.el)[1];this.tt=new d.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();var e=this.tt.getContent();r(this.el)&&r(e)||(0,n.scrollToY)(_-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,l.removeEvent)(window,"scroll"),(0,l.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,l.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,l.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,l.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){var _=this.el.offsetWidth,e=this.el.offsetHeight,t=(0,a.getXY)(this.el);(0,a.attr)(window.onboardingBGClip,"width",_+this.border[1]+this.border[3]),(0,a.attr)(window.onboardingBGClip,"height",e+this.border[0]+this.border[2]),(0,a.attr)(window.onboardingBGClip,"x",t[0]-this.border[1]),(0,a.attr)(window.onboardingBGClip,"y",t[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){var _=this.getPageHeight();window.onboardingBG.height!=_&&this.setDartToFullHeight()}setDartToFullHeight(){(0,a.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,a.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,a.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,a.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,a.show)(window.onboardingBG),(0,a.isVisible)(window.onboardingBGHeader)||((0,a.show)(window.onboardingBGHeader),(0,a.addClass)((0,a.ge)(u),c)))}removeDarkens(){this.hideDarkness&&((0,a.hide)(window.onboardingBG),(0,a.hide)(window.onboardingBGHeader),(0,a.removeClass)((0,a.ge)(u),c))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){var _=document.documentElement,e=document.body;return Math.max(e.scrollWidth,_.scrollWidth,e.offsetWidth,_.offsetWidth,e.clientWidth,_.clientWidth)}getPageHeight(){var _=document.documentElement,e=document.body;return Math.max(e.scrollHeight,_.scrollHeight,e.offsetHeight,_.offsetHeight,e.clientHeight,_.clientHeight)}}var E=function(_){function e(e,t){var i=_.call(this,o.HintType.Highlight,e)||this;return i.initialElement=t,i.options={highlight:!0,width:280,offset:[0,-17],scrollOffset:40,side:"bottom"},e.unskipable?i.options.ttOnHide=function(){}:i.options.onBGClick=function(){return i.hide()},i}return(0,i.__extends)(e,_),e.prototype.show=function(){this.highlight=new h(this.initialElement,this.generateContent(),this.options),(0,n.disableBodyScroll)(),this.highlight.showTT()},e.prototype.hide=function(){this.highlight.hideTT(),(0,n.enableBodyScroll)(),_.prototype.hide.call(this)},e}(s.Hint)},24676:(_,e,t)=>{"use strict";t.d(e,{Hint:()=>l});var i=t(70655),o=t(86067),s=t(49535),a=t(93680),l=function(){function _(_,e){this.type=_,this.id=e.id,this.title=e.title,this.text=e.text,this.hintId=e.hintId,this.hideHash=e.hideHash,this.actions=e.actions,e.currentStep&&e.totalSteps&&(this.tutorialSteps={current:e.currentStep,total:e.totalSteps})}return _.prototype.hide=function(){this.onHide&&this.onHide(),a.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:this.hintId,hash:this.hideHash})},_.prototype.generateContent=function(){var _=this,e=document.createElement("div");if(this.title&&(e.innerHTML+='<div class="CatalogHint__title">'+this.title+"</div>"),this.text&&(e.innerHTML+='<div class="CatalogHint__text">'+this.text+"</div>"),this.actions){var t=document.createElement("div");t.classList.add("CatalogHint__actions");var a=this.actions.map((function(e){var t=document.createElement("a");switch(t.classList.add("flat_button"),e.type){case"open_url":t.href=e.url,t.onclick=function(t){window.nav.go(e.url),_.hide(),(0,s.cancelEvent)(t)};break;case"switch_section":t.onclick=function(i){(0,s.cancelEvent)(i),window.currentAudioPage(t).catalogController.currentSection.switchSection(e.targetSectionId),_.hide()}}return t.innerHTML=e.label,t}));if(t.append.apply(t,(0,i.__spreadArray)([],(0,i.__read)(a),!1)),this.tutorialSteps){var l=document.createElement("div");l.classList.add("CatalogHint__tutorialSteps"),l.innerHTML=(0,o.langStr)((0,o.getLang)("audio_onboarding_tutorial_progress"),"step",this.tutorialSteps.current,"total_steps",this.tutorialSteps.total),t.append(l)}e.append(t)}return e},_}()},32603:(_,e,t)=>{"use strict";var i;t.d(e,{HintType:()=>i}),function(_){_.Tooltip="tooltip",_.Highlight="highlight"}(i||(i={}))},50284:(_,e,t)=>{"use strict";t.d(e,{SECTION:()=>i,PAGINATED_BLOCKS_CONTAINER:()=>o,BLOCK_ITEMS_CONTAINER:()=>s,BLOCK_ITEMS_REORDERABLE:()=>a,BLOCK_ELEMENT:()=>l,BLOCK_DIVIDED:()=>n,AUTO_LIST_LOADER:()=>r,BLOCK_CONTENT:()=>d,SORTER_ACTION:()=>u,SORTER_ACTION_DATA:()=>c,GALLERY:()=>h});var i="CatalogSection",o="CatalogSection__paginatedBlocks",s="CatalogBlock__itemsContainer",a="CatalogBlock__itemsContainer--reorderable",l="CatalogBlock",n="CatalogBlock--divided",r="CatalogBlock__autoListLoader",d="CatalogBlock__content",u="CatalogBlock__sorter",c="CatalogBlock__sortingData",h="ui_gallery"},51207:(_,e,t)=>{"use strict";t.d(e,{FullscreenBanner:()=>n});var i=t(93680),o=t(54612),s=t(85331),a=t(49171),l=t(40517),n=function(){function _(_,e,t){var i=this;this.sectionId=_,this.bannerId=e,this.productCollector=new a.ProductionStatCollector,this.viewCollector=new a.ViewStatCollector(this.productCollector),this.box=new o.MessageBox({bodyStyle:"padding: 0",width:655,containerClass:"FullscreenBanner",noControls:!0,onHide:function(){return i.consume(s.ConsumeReason.Close)}}),this.box.content(t),this.addEventListeners(),this.show()}return _.initiate=function(e){_.fetch(e).then((function(t){var i=t.banner,o=t.bannerId;return i?new _(e,o,i):null})).catch((function(){return null}))},_.prototype.show=function(){this.box.show(),this.startView=this.productCollector.getCurrentTime()},_.prototype.hide=function(){this.box.hide(),this.sendViewStat()},_.prototype.sendViewStat=function(){var _={end_view:this.productCollector.getCurrentTime(),start_view:this.startView},e={type:l.EventItemType.AUDIO_FULLSCREEN_BANNER,id:this.bannerId,track_code:this.sectionId};this.viewCollector.logEvent(_,e)},_.fetch=function(_){return new Promise((function(e,t){i.ajax.post("/audio?act=get_fullscreen_banner",{section_id:_},{onDone:function(_){(null==_?void 0:_.bannerId)?e(_):t()},onFail:function(){return t(),!0}})}))},_.prototype.addEventListeners=function(){var _=this,e=this.box.bodyNode.querySelector(".FullscreenBanner__closeButton");e&&e.addEventListener("click",this.close.bind(this)),this.box.bodyNode.querySelectorAll(".FullscreenBanner__button").forEach((function(e){e.addEventListener("click",(function(){_.consume(e.dataset.reason||s.ConsumeReason.Click),setTimeout((function(){return _.hide()}))}))}))},_.prototype.close=function(){this.consume(s.ConsumeReason.Close),this.hide()},_.prototype.consume=function(_){i.ajax.post("/al_audio.php?act=consume_banner",{id:this.bannerId,type:"fullscreen",track_code:this.sectionId,reason:_})},_}()}}]);try{stManager.done("dist/db518e9c64536d311f4629724f55e979.e5ea6f55626c4790b1db.js")}catch(_){}